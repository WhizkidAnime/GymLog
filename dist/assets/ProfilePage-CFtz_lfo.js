import{s as re,j as e,u as ue}from"./index-CD3TDb9H.js";import{r as s,c as me,e as pe}from"./vendor-BVca5W6X.js";import{C as ie}from"./confirm-dialog-g0pjlVm9.js";import{T as he}from"./template-saved-dialog-Sk1ccj2l.js";import{R as ge,L as fe,C as xe,X as we,Y as be,T as ye,a as ke}from"./charts-33RH-A39.js";import"./supabase-CWpvgLJU.js";import"./use-modal-scroll-lock-DlG-D3y9.js";async function je(){const t=re,{error:a}=await t.rpc("delete_user_account");if(a)throw a}function Ne({userId:t}){const a=re,[n,l]=s.useState(!1),[r,d]=s.useState([]),[m,C]=s.useState(!1),[v,h]=s.useState(""),[y,k]=s.useState(()=>{const i=new Date,w=String(i.getDate()).padStart(2,"0"),R=String(i.getMonth()+1).padStart(2,"0"),P=i.getFullYear();return`${w}.${R}.${P}`}),[W,o]=s.useState(!1),[g,p]=s.useState(null),[N,$]=s.useState(!1),[j,_]=s.useState(null),T=s.useCallback(async()=>{if(t){C(!0);try{const{data:i,error:w}=await a.from("user_body_weights").select("*").eq("user_id",t).order("recorded_at",{ascending:!1}).limit(100);if(w)throw w;d(i||[])}catch(i){console.error("Error loading body weights:",i)}finally{C(!1)}}},[t,a]),J=s.useCallback(i=>{const w=i.match(/^(\d{2})\.(\d{2})\.(\d{4})$/);if(!w)return null;const[,R,P,H]=w,z=parseInt(R,10),Y=parseInt(P,10),u=parseInt(H,10);if(Y<1||Y>12||z<1||z>31||u<1900||u>2100)return null;const E=new Date(u,Y,0).getDate();if(z>E)return null;const O=new Date(u,Y-1,z),S=new Date;return S.setHours(23,59,59,999),O>S?null:`${H}-${P}-${R}`},[]),M=s.useCallback(()=>{const i=new Date,w=String(i.getDate()).padStart(2,"0"),R=String(i.getMonth()+1).padStart(2,"0"),P=i.getFullYear();return`${w}.${R}.${P}`},[]),G=s.useCallback(async()=>{if(!t||!v||W)return;const i=parseFloat(v.replace(",","."));if(isNaN(i)||i<=0||i>500){alert("Введите корректный вес (от 0.1 до 500 кг)");return}const w=J(y);if(!w){alert("Введите корректную дату в формате дд.мм.гггг (не в будущем)");return}o(!0);try{const{data:R,error:P}=await a.from("user_body_weights").upsert({user_id:t,weight:i,recorded_at:w},{onConflict:"user_id,recorded_at"}).select().single();if(P)throw P;d(H=>{const z=H.filter(Y=>Y.recorded_at!==w);return[R,...z].sort((Y,u)=>new Date(u.recorded_at).getTime()-new Date(Y.recorded_at).getTime())}),h(""),k(M())}catch(R){console.error("Error saving weight:",R),alert("Не удалось сохранить вес")}finally{o(!1)}},[t,v,y,W,a,J,M]),f=s.useCallback(async i=>{if(!(!t||g)){p(i);try{const{error:w}=await a.from("user_body_weights").delete().eq("id",i);if(w)throw w;d(R=>R.filter(P=>P.id!==i)),$(!1),_(null)}catch(w){console.error("Error deleting weight:",w),alert("Не удалось удалить запись")}finally{p(null)}}},[t,g,a]),U=s.useCallback(i=>{_(i),$(!0)},[]),x=s.useMemo(()=>[...r].sort((i,w)=>new Date(i.recorded_at).getTime()-new Date(w.recorded_at).getTime()).slice(-30).map(i=>({date:new Date(i.recorded_at).toLocaleDateString("ru",{day:"numeric",month:"short"}),weight:Number(i.weight),fullDate:i.recorded_at})),[r]),q=s.useMemo(()=>{if(r.length===0)return null;const i=r.map(z=>Number(z.weight)),w=i[0],R=Math.min(...i),P=Math.max(...i),H=r.length>1?w-i[i.length-1]:0;return{current:w,min:R,max:P,change:H}},[r]);return{isWeightTrackerOpen:n,bodyWeights:r,loadingWeights:m,newWeight:v,newWeightDate:y,savingWeight:W,deletingWeightId:g,isDeleteWeightConfirmOpen:N,weightToDelete:j,weightChartData:x,weightStats:q,setIsWeightTrackerOpen:l,setNewWeight:h,setNewWeightDate:k,setIsDeleteWeightConfirmOpen:$,loadBodyWeights:T,handleAddWeight:G,handleDeleteWeight:f,handleOpenDeleteWeightConfirm:U}}function ve(){const[t,a]=s.useState(()=>{try{const o=localStorage.getItem("settings:timerStep");return o?Number(o):30}catch{return 30}}),[n,l]=s.useState(()=>String(t)),[r,d]=s.useState("idle"),m=s.useRef(null),[C,v]=s.useState(()=>{try{const o=localStorage.getItem("settings:theme");if(o==="light"||o==="dark"||o==="auto")return o}catch{}return"auto"}),[h,y]=s.useState(!1);s.useEffect(()=>()=>{m.current&&clearTimeout(m.current)},[]),s.useEffect(()=>{const o=document.documentElement,g=document.querySelector('meta[name="theme-color"]'),p=(T,J)=>{(T==="auto"?J?"light":"dark":T)==="light"?(o.classList.add("light-theme"),g&&g.setAttribute("content","#f5f5f7")):(o.classList.remove("light-theme"),g&&g.setAttribute("content","#0a0a0b"))},$=(()=>{if(typeof window>"u"||!window.matchMedia)return!1;try{return window.matchMedia("(prefers-color-scheme: light)").matches}catch{return!1}})();if(p(C,$),typeof window>"u"||!window.matchMedia)return;const j=window.matchMedia("(prefers-color-scheme: light)"),_=T=>{p(C,T.matches)};if(typeof j.addEventListener=="function")return j.addEventListener("change",_),()=>{j.removeEventListener("change",_)};if(typeof j.addListener=="function")return j.addListener(_),()=>{j.removeListener(_)}},[C]);const k=s.useCallback(o=>{v(o);try{localStorage.setItem("settings:theme",o)}catch{}},[]),W=s.useCallback(()=>{m.current&&clearTimeout(m.current);const o=parseInt(n,10);if(!isNaN(o)&&o>=1&&o<=300){d("saving"),a(o);try{localStorage.setItem("settings:timerStep",String(o))}catch{}m.current=setTimeout(()=>{d("success"),m.current=setTimeout(()=>{d("idle")},500)},350)}else l(String(t)),d("idle")},[n,t]);return{timerStep:t,timerStepInput:n,setTimerStepInput:l,saveStatus:r,saveTimerStep:W,theme:C,handleThemeChange:k,isSettingsOpen:h,setIsSettingsOpen:y}}const De=["upper","lower","push","pull","legs","arms","shoulders","chest","back","core","cardio","full"];function oe(t){if(typeof t!="string")return null;const a=t.trim();return De.includes(a)?a:null}function Ce({userId:t,userEmail:a}){const n=re,[l,r]=s.useState(!1),[d,m]=s.useState(!1),[C,v]=s.useState(!1),[h,y]=s.useState(null),[k,W]=s.useState(null),[o,g]=s.useState([]),[p,N]=s.useState([]),[$,j]=s.useState("none"),[_,T]=s.useState(!1),[J,M]=s.useState(null),[G,f]=s.useState("success"),U=s.useRef(null),x=s.useCallback(async u=>{if(!t)return;const E=Array.isArray(u.workouts)?u.workouts:[];if(E.length===0){f("error"),M("В файле нет тренировок для импорта."),T(!0);return}const{data:O,error:S}=await n.from("workouts").select("id, workout_date").eq("user_id",t);if(S)throw S;const K=new Set;E.forEach(c=>{const L=typeof c.date=="string"&&c.date?c.date:typeof c.workout_date=="string"&&c.workout_date?c.workout_date:"";L&&K.add(L)});const b=(O||[]).filter(c=>K.has(c.workout_date)).map(c=>c.id);if(b.length>0){const{data:c,error:L}=await n.from("workout_exercises").select("id, workout_id").in("workout_id",b);if(L)throw L;const B=(c||[]).map(D=>D.id);if(B.length>0){const{error:D}=await n.from("workout_sets").delete().in("workout_exercise_id",B);if(D)throw D}if(b.length>0){const{error:D}=await n.from("workout_exercises").delete().in("workout_id",b);if(D)throw D;const{error:I}=await n.from("workouts").delete().in("id",b);if(I)throw I}}for(const c of E){const L=typeof c.name=="string"&&c.name.trim().length>0?c.name.trim():"Импортированная тренировка",B=typeof c.date=="string"&&c.date?c.date:new Date().toISOString().slice(0,10),{data:D,error:I}=await n.from("workouts").insert({user_id:t,name:L,icon:oe(c.icon),workout_date:B,is_cardio:!!c.isCardio,template_id:null}).select().single();if(I||!D)throw I||new Error("Не удалось создать тренировку при импорте.");const Q=Array.isArray(c.exercises)?c.exercises:[];if(Q.length===0)continue;const ae=Q.map((F,V)=>({workout_id:D.id,name:typeof F.name=="string"?F.name:"",position:typeof F.position=="number"?F.position:V+1,reps:typeof F.reps=="string"?F.reps:"",rest_seconds:typeof F.restSeconds=="number"?F.restSeconds:typeof F.rest_seconds=="number"?F.rest_seconds:150,sets:typeof F.setsPlanned=="number"?F.setsPlanned:Array.isArray(F.sets)?F.sets.length:1})),{data:A,error:X}=await n.from("workout_exercises").insert(ae).select();if(X||!A)throw X||new Error("Не удалось создать упражнения при импорте.");const se=[],ce=[...Q].sort((F,V)=>{const te=typeof F.position=="number"?F.position:0,ne=typeof V.position=="number"?V.position:0;return te-ne}),de=[...A].sort((F,V)=>{const te=typeof F.position=="number"?F.position:0,ne=typeof V.position=="number"?V.position:0;return te-ne});if(ce.forEach((F,V)=>{const te=de[V];if(!te)return;(Array.isArray(F.sets)?F.sets:[]).forEach(Z=>{se.push({workout_exercise_id:te.id,set_index:typeof Z.index=="number"?Z.index:1,weight:typeof Z.weight=="number"?Z.weight:null,reps:Z.reps==null?null:String(Z.reps),is_done:!!Z.isDone,updated_at:typeof Z.updatedAt=="string"&&Z.updatedAt?Z.updatedAt:new Date().toISOString()})})}),se.length>0){const{error:F}=await n.from("workout_sets").insert(se);if(F)throw F}}},[t,n]),q=s.useCallback(async()=>{if(t){r(!0);try{const{data:u,error:E}=await n.from("workouts").select(`
          id,
          name,
          icon,
          workout_date,
          is_cardio,
          template_id,
          workout_exercises (
            id,
            name,
            position,
            reps,
            rest_seconds,
            sets,
            workout_sets (
              id,
              set_index,
              weight,
              reps,
              is_done,
              updated_at
            )
          )
        `).eq("user_id",t).order("workout_date",{ascending:!1});if(E){console.error("Error exporting workouts:",E),alert("Не удалось загрузить данные тренировок для экспорта.");return}const O=(u||[]).map(B=>({id:B.id,name:B.name,icon:oe(B.icon),date:B.workout_date,isCardio:!!B.is_cardio,templateId:B.template_id,exercises:(B.workout_exercises||[]).map(D=>({id:D.id,name:D.name,position:D.position,reps:D.reps,restSeconds:D.rest_seconds,setsPlanned:D.sets,sets:(D.workout_sets||[]).map(I=>({id:I.id,index:I.set_index,weight:I.weight,reps:I.reps,isDone:I.is_done,updatedAt:I.updated_at}))}))})),S={exportedAt:new Date().toISOString(),user:{id:t,email:a},workouts:O},K=JSON.stringify(S,null,2),ee=new Blob([K],{type:"application/json;charset=utf-8;"}),b=URL.createObjectURL(ee),c=document.createElement("a"),L=new Date().toISOString().slice(0,10);c.href=b,c.download=`gymlog-workouts-${L}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(b)}catch(u){console.error("Unexpected error while exporting workouts:",u),alert("Произошла непредвиденная ошибка при экспорте данных.")}finally{r(!1)}}},[t,a,n]),i=s.useCallback(()=>{!t||d||U.current&&(U.current.value="",U.current.click())},[t,d]),w=s.useCallback(async u=>{const E=u.target.files&&u.target.files[0];if(E)try{g([]),N([]);const O=await E.text();let S;try{S=JSON.parse(O)}catch{f("error"),M("Файл не является корректным JSON."),T(!0);return}if(!S||!Array.isArray(S.workouts)){f("error"),M("Файл не похож на экспорт тренировок из GymLog."),T(!0);return}if(!t)return;const K=Array.isArray(S.workouts)?S.workouts:[],ee=new Set;K.forEach(A=>{const X=typeof A.date=="string"&&A.date?A.date:typeof A.workout_date=="string"&&A.workout_date?A.workout_date:"";X&&ee.add(X)});const{data:b,error:c}=await n.from("workouts").select("workout_date").eq("user_id",t);if(c){console.error("Error checking existing workouts before import:",c),f("error"),M("Не удалось проверить существующие тренировки перед импортом."),T(!0);return}const L=new Set((b||[]).map(A=>A.workout_date)),B=L.size>0,D=new Map;K.forEach(A=>{const X=typeof A.date=="string"&&A.date?A.date:typeof A.workout_date=="string"&&A.workout_date?A.workout_date:"";X&&D.set(X,(D.get(X)||0)+1)});const I=[],Q=[];ee.forEach(A=>{L.has(A)?I.push(A):Q.push(A)});const ae=I.length>0;if(!B||!ae){f("success"),m(!0);try{await x(S),M("Импорт тренировок завершён. Откройте календарь, чтобы посмотреть тренировки."),T(!0)}catch(A){console.error("Error importing workouts:",A),alert("Не удалось импортировать тренировки: "+((A==null?void 0:A.message)||String(A)))}finally{m(!1)}return}if(Q.length===0){f("error"),M("Все тренировки из файла уже есть в вашем календаре. Новых тренировок нет."),T(!0);return}if(y(S),W(E.name),Q.length>0){const A=Q.map(X=>({date:X,count:D.get(X)||0})).sort((X,se)=>se.date.localeCompare(X.date));g(Q),N(A)}else g([]),N([]);v(!0)}catch(O){console.error("Error reading workouts import file:",O),alert("Не удалось прочитать файл тренировок.")}finally{u.target.value=""}},[t,n,x]),R=s.useCallback(async()=>{if(h){j("import"),m(!0);try{await x(h),y(null),W(null),g([]),N([]),v(!1),f("success"),M("Импорт тренировок завершён. Откройте календарь, чтобы посмотреть тренировки."),T(!0)}catch(u){console.error("Error importing workouts:",u),alert("Не удалось импортировать тренировки: "+((u==null?void 0:u.message)||String(u)))}finally{m(!1),j("none")}}},[h,x]),P=s.useCallback(async()=>{if(!h)return;const u=Array.isArray(h.workouts)?h.workouts:[];if(u.length===0){f("error"),M("В файле нет тренировок для импорта."),T(!0);return}const E=new Set(o);if(E.size===0){f("error"),M("В файле нет новых тренировок с датами, которых ещё нет в вашем календаре."),T(!0);return}const O=u.filter(S=>{const K=typeof S.date=="string"&&S.date?S.date:typeof S.workout_date=="string"&&S.workout_date?S.workout_date:"";return!!K&&E.has(K)});if(O.length===0){f("error"),M("Не удалось определить новые тренировки для импорта. Проверьте файл."),T(!0);return}j("onlyNew"),m(!0);try{await x({workouts:O}),y(null),W(null),g([]),N([]),v(!1),f("success"),M("Импорт новых тренировок завершён. Откройте календарь, чтобы посмотреть тренировки."),T(!0)}catch(S){console.error("Error importing only new workouts:",S),f("error"),M("Не удалось импортировать новые тренировки. Попробуйте ещё раз."),T(!0)}finally{m(!1),j("none")}},[h,o,x]),H=s.useCallback(async()=>{if(h){j("exportThenImport"),m(!0);try{await q(),await x(h),y(null),W(null),v(!1),f("success"),M("Текущие тренировки сохранены, импорт завершён. Откройте календарь, чтобы посмотреть тренировки."),T(!0)}catch(u){console.error("Error exporting and importing workouts:",u),f("error"),M("Не удалось выполнить экспорт и импорт тренировок. Попробуйте ещё раз."),T(!0)}finally{m(!1),j("none")}}},[h,q,x]),z=s.useCallback(()=>{v(!1),y(null),W(null),g([]),N([])},[]),Y=s.useCallback(()=>{T(!1),M(null)},[]);return{isExporting:l,isImportingWorkouts:d,isWorkoutsImportDialogOpen:C,pendingWorkoutsImport:h,pendingWorkoutsFileName:k,pendingWorkoutsNewDates:o,pendingWorkoutsNewDatesSummary:p,importAction:$,isImportSuccessOpen:_,importSuccessMessage:J,toastVariant:G,workoutsFileInputRef:U,handleExportWorkouts:q,handleStartImportWorkouts:i,handleWorkoutsFileChange:w,handleConfirmImportWorkoutsOnly:R,handleImportOnlyNewWorkouts:P,handleExportThenImportWorkouts:H,closeWorkoutsImportDialog:z,closeImportSuccessToast:Y,setIsImportSuccessOpen:T,setImportSuccessMessage:M,setToastVariant:f}}const We=["upper","lower","push","pull","legs","arms","shoulders","chest","back","core","cardio","full"];function le(t){if(typeof t!="string")return null;const a=t.trim();return We.includes(a)?a:null}function Se({userId:t,userEmail:a,setToastVariant:n,setImportSuccessMessage:l,setIsImportSuccessOpen:r}){const d=re,[m,C]=s.useState(!1),[v,h]=s.useState(!1),[y,k]=s.useState(!1),[W,o]=s.useState([]),[g,p]=s.useState([]),[N,$]=s.useState("none"),j=s.useRef(null),_=s.useCallback(async x=>{if(!t)return;const q=Array.isArray(x.templates)?x.templates:[];if(q.length===0){n("error"),l("В файле нет шаблонов для импорта."),r(!0);return}for(const i of q){const w=typeof i.name=="string"&&i.name.trim().length>0?i.name.trim():"Импортированный шаблон",{data:R,error:P}=await d.from("workout_templates").insert({user_id:t,name:w,icon:le(i.icon)}).select().single();if(P||!R)throw P||new Error("Не удалось создать шаблон при импорте.");const H=Array.isArray(i.exercises)?i.exercises:[];if(H.length===0)continue;const z=H.map((u,E)=>({template_id:R.id,name:typeof u.name=="string"?u.name:"",sets:typeof u.sets=="number"?u.sets:1,reps:typeof u.reps=="string"?u.reps:"",rest_seconds:typeof u.restSeconds=="number"?u.restSeconds:typeof u.rest_seconds=="number"?u.rest_seconds:150,position:typeof u.position=="number"?u.position:E+1})),{error:Y}=await d.from("template_exercises").insert(z);if(Y)throw Y}},[t,d,n,l,r]),T=s.useCallback(async()=>{if(t){C(!0);try{const{data:x,error:q}=await d.from("workout_templates").select(`
          id,
          name,
          icon,
          created_at,
          template_exercises (
            id,
            name,
            sets,
            reps,
            rest_seconds,
            position
          )
        `).eq("user_id",t).order("created_at",{ascending:!1});if(q){console.error("Error exporting templates:",q),alert("Не удалось загрузить шаблоны для экспорта.");return}const i=(x||[]).map(u=>({id:u.id,name:u.name,icon:le(u.icon),createdAt:u.created_at,exercises:(u.template_exercises||[]).map(E=>({id:E.id,name:E.name,sets:E.sets,reps:E.reps,restSeconds:E.rest_seconds,position:E.position}))})),w={exportedAt:new Date().toISOString(),user:{id:t,email:a},templates:i},R=JSON.stringify(w,null,2),P=new Blob([R],{type:"application/json;charset=utf-8;"}),H=URL.createObjectURL(P),z=document.createElement("a"),Y=new Date().toISOString().slice(0,10);z.href=H,z.download=`gymlog-templates-${Y}.json`,document.body.appendChild(z),z.click(),document.body.removeChild(z),URL.revokeObjectURL(H)}catch(x){console.error("Unexpected error while exporting templates:",x),alert("Произошла непредвиденная ошибка при экспорте шаблонов.")}finally{C(!1)}}},[t,a,d]),J=s.useCallback(()=>{!t||v||j.current&&(j.current.value="",j.current.click())},[t,v]),M=s.useCallback(async x=>{const q=x.target.files&&x.target.files[0];if(q)try{const i=await q.text();let w;try{w=JSON.parse(i)}catch{n("error"),l("Файл не является корректным JSON."),r(!0);return}if(!w||!Array.isArray(w.templates)){n("error"),l("Файл не похож на экспорт шаблонов из GymLog."),r(!0);return}if(!t)return;const R=Array.isArray(w.templates)?w.templates:[];if(R.length===0){n("error"),l("В файле нет шаблонов для импорта."),r(!0);return}const{data:P,error:H}=await d.from("workout_templates").select("id, name").eq("user_id",t);if(H){console.error("Error checking existing templates before import:",H),n("error"),l("Не удалось проверить существующие шаблоны перед импортом."),r(!0);return}const z=O=>typeof O=="string"?O.trim().toLowerCase():"",Y=new Map;(P||[]).forEach(O=>{const S=z(O.name);S&&(Y.has(S)||Y.set(S,{id:O.id,name:O.name||""}))});const u=[],E=[];if(R.forEach(O=>{const S=z(O==null?void 0:O.name);if(!S||!Y.has(S))u.push(O);else{const K=Y.get(S);E.push({existingId:K.id,existingName:K.name||"",template:O})}}),u.length===0&&E.length>0){n("error"),l("Все шаблоны из файла уже есть в вашем аккаунте. Новых шаблонов нет."),r(!0);return}if(E.length===0){h(!0);try{await _({templates:R}),n("success"),l("Импорт шаблонов завершён. Откройте страницу «Шаблоны», чтобы посмотреть их."),r(!0)}catch(O){console.error("Error importing templates:",O),n("error"),l("Не удалось импортировать шаблоны. Попробуйте ещё раз."),r(!0)}finally{h(!1)}return}o(u),p(E),k(!0)}catch(i){console.error("Error importing templates:",i),n("error"),l("Не удалось импортировать шаблоны. Попробуйте ещё раз."),r(!0)}finally{h(!1),x.target.value=""}},[t,d,_,n,l,r]),G=s.useCallback(async()=>{if(W.length===0){k(!1),p([]),o([]),n("error"),l("Все шаблоны из файла уже есть в вашем аккаунте. Новых шаблонов нет."),r(!0);return}$("onlyNew"),h(!0);try{await _({templates:W}),o([]),p([]),k(!1),n("success"),l("Импорт новых шаблонов завершён. Откройте страницу «Шаблоны», чтобы посмотреть их."),r(!0)}catch(x){console.error("Error importing only new templates:",x),n("error"),l("Не удалось импортировать новые шаблоны. Попробуйте ещё раз."),r(!0)}finally{h(!1),$("none")}},[W,_,n,l,r]),f=s.useCallback(async()=>{if(g.length===0&&W.length===0){k(!1);return}$("overwrite"),h(!0);try{const x=Array.from(new Set(g.map(i=>i.existingId)));if(x.length>0){const{error:i}=await d.from("template_exercises").delete().in("template_id",x);if(i)throw i;const{error:w}=await d.from("workout_templates").delete().in("id",x);if(w)throw w}const q=[...W,...g.map(i=>i.template)];await _({templates:q}),o([]),p([]),k(!1),n("success"),l("Шаблоны успешно импортированы. Совпадающие шаблоны были перезаписаны."),r(!0)}catch(x){console.error("Error overwriting templates:",x),alert("Не удалось импортировать шаблоны с перезаписью: "+((x==null?void 0:x.message)||String(x)))}finally{h(!1),$("none")}},[g,W,d,_,n,l,r]),U=s.useCallback(()=>{k(!1),o([]),p([])},[]);return{isExportingTemplates:m,handleExportTemplates:T,isImportingTemplates:v,isTemplatesImportDialogOpen:y,pendingTemplatesNew:W,pendingTemplatesDuplicates:g,templatesImportAction:N,templatesFileInputRef:j,handleStartImportTemplates:J,handleTemplatesFileChange:M,handleImportTemplatesOnlyNew:G,handleImportTemplatesOverwrite:f,closeTemplatesImportDialog:U}}function _e({userId:t,setToastVariant:a,setImportSuccessMessage:n,setIsImportSuccessOpen:l}){const r=re,[d,m]=s.useState(!1),[C,v]=s.useState(!1),[h,y]=s.useState(!1),[k,W]=s.useState([]),[o,g]=s.useState([]),[p,N]=s.useState(!1),[$,j]=s.useState(!1),[_,T]=s.useState(!1),[J,M]=s.useState([]),[G,f]=s.useState([]),[U,x]=s.useState(!1),q=k.length>0&&o.length===k.length,i=J.length>0&&G.length===J.length,w=s.useCallback(async()=>{if(!(!t||h)){y(!0),g([]);try{const{data:b,error:c}=await r.from("workouts").select("id, workout_date").eq("user_id",t).order("workout_date",{ascending:!1});if(c){console.error("Error loading workouts for deletion:",c),alert("Не удалось загрузить список тренировок для удаления.");return}const L=new Map;(b||[]).forEach(D=>{const I=D.workout_date,Q=D.id;!I||!Q||(L.has(I)||L.set(I,[]),L.get(I).push(Q))});const B=Array.from(L.entries()).map(([D,I])=>({date:D,workoutIds:I,count:I.length})).sort((D,I)=>I.date.localeCompare(D.date));if(B.length===0){a("error"),n("У вас нет тренировок для удаления."),l(!0);return}W(B),m(!1),v(!0)}catch(b){console.error("Unexpected error while loading workouts for deletion:",b),alert("Произошла ошибка при загрузке тренировок для удаления.")}finally{y(!1)}}},[t,h,r,a,n,l]),R=s.useCallback(async()=>{if(!(!t||_)){T(!0),f([]);try{const{data:b,error:c}=await r.from("workout_templates").select("id, name").eq("user_id",t).order("created_at",{ascending:!1});if(c){console.error("Error loading templates for deletion:",c),alert("Не удалось загрузить список шаблонов для удаления.");return}const L=(b||[]).map(B=>({id:B.id,name:B.name||"Без названия"}));if(L.length===0){a("error"),n("У вас нет шаблонов для удаления."),l(!0);return}M(L),m(!1),j(!0)}catch(b){console.error("Unexpected error while loading templates for deletion:",b),alert("Произошла ошибка при загрузке шаблонов для удаления.")}finally{T(!1)}}},[t,_,r,a,n,l]),P=s.useCallback(b=>{g(c=>c.includes(b)?c.filter(L=>L!==b):[...c,b])},[]),H=s.useCallback(()=>{if(k.length===0)return;const b=o.length===k.length;g(b?[]:k.map(c=>c.date))},[k,o.length]),z=s.useCallback(()=>{g([])},[]),Y=s.useCallback(b=>{f(c=>c.includes(b)?c.filter(L=>L!==b):[...c,b])},[]),u=s.useCallback(()=>{if(J.length===0)return;const b=G.length===J.length;f(b?[]:J.map(c=>c.id))},[J,G.length]),E=s.useCallback(()=>{f([])},[]),O=s.useCallback(async()=>{if(!t||o.length===0)return;const b=k.filter(c=>o.includes(c.date)).flatMap(c=>c.workoutIds);if(b.length!==0){N(!0);try{const{data:c,error:L}=await r.from("workout_exercises").select("id, workout_id").in("workout_id",b);if(L)throw L;const B=(c||[]).map(D=>D.id);if(B.length>0){const{error:D}=await r.from("workout_sets").delete().in("workout_exercise_id",B);if(D)throw D}if(b.length>0){const{error:D}=await r.from("workout_exercises").delete().in("workout_id",b);if(D)throw D;const{error:I}=await r.from("workouts").delete().in("id",b);if(I)throw I}v(!1),W([]),g([]),a("success"),n("Выбранные тренировки успешно удалены."),l(!0)}catch(c){console.error("Error deleting workouts:",c),a("error"),n("Не удалось удалить выбранные тренировки."),l(!0)}finally{N(!1)}}},[t,o,k,r,a,n,l]),S=s.useCallback(async()=>{if(t&&G.length!==0){x(!0);try{const b=G;if(b.length>0){const{error:c}=await r.from("template_exercises").delete().in("template_id",b);if(c)throw c;const{error:L}=await r.from("workout_templates").delete().in("id",b);if(L)throw L}j(!1),M([]),f([]),a("success"),n("Выбранные шаблоны тренировок успешно удалены."),l(!0)}catch(b){console.error("Error deleting templates:",b),a("error"),n("Не удалось удалить выбранные шаблоны тренировок."),l(!0)}finally{x(!1)}}},[t,G,r,a,n,l]),K=s.useCallback(()=>{p||v(!1)},[p]),ee=s.useCallback(()=>{U||j(!1)},[U]);return{isCleanDataDialogOpen:d,setIsCleanDataDialogOpen:m,isDeleteWorkoutsDialogOpen:C,isLoadingWorkoutsForDeletion:h,workoutDateGroups:k,selectedWorkoutDates:o,isDeletingWorkouts:p,areAllWorkoutDatesSelected:q,isDeleteTemplatesDialogOpen:$,isLoadingTemplatesForDeletion:_,templatesForDeletion:J,selectedTemplateIds:G,isDeletingTemplates:U,areAllTemplatesSelected:i,openDeleteWorkoutsDialog:w,toggleWorkoutDateSelection:P,selectAllWorkoutDates:H,clearWorkoutSelection:z,handleDeleteSelectedWorkouts:O,closeDeleteWorkoutsDialog:K,openDeleteTemplatesDialog:R,toggleTemplateSelection:Y,selectAllTemplates:u,clearTemplateSelection:E,handleDeleteSelectedTemplates:S,closeDeleteTemplatesDialog:ee}}function Ee(t){if(!t||typeof t!="string")return t;const a=t.split("-");if(a.length===3){const[n,l,r]=a;if(n&&l&&r)return`${r}.${l}.${n}`}return t}function Te(t){const a=t.replace(/\D/g,"");return a.length<=2?a:a.length<=4?`${a.slice(0,2)}.${a.slice(2)}`:`${a.slice(0,2)}.${a.slice(2,4)}.${a.slice(4,8)}`}function Le({isOpen:t,onClose:a,bodyWeights:n,loadingWeights:l,weightChartData:r,weightStats:d,newWeight:m,newWeightDate:C,savingWeight:v,deletingWeightId:h,isDeleteWeightConfirmOpen:y,weightToDelete:k,setNewWeight:W,setNewWeightDate:o,setIsDeleteWeightConfirmOpen:g,handleAddWeight:p,handleDeleteWeight:N,handleOpenDeleteWeightConfirm:$}){return t?me.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:a}),e.jsxs("div",{className:"relative w-full max-w-lg mx-4 glass card-dark rounded-xl shadow-xl p-5 space-y-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Трекер веса тела"}),e.jsx("button",{type:"button",onClick:a,className:"p-1 text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-3 p-3 rounded-lg bg-white/5 border border-white/10",children:[e.jsx("p",{className:"text-sm text-gray-300 font-medium",children:"Добавить запись"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Вес (кг)"}),e.jsx("input",{type:"text",inputMode:"decimal",value:m,onChange:j=>{const _=j.target.value.replace(".",",");/^[0-9]*[,]?[0-9]*$/.test(_)&&W(_)},placeholder:"70,5",className:"w-full h-10 px-3 rounded-lg bg-white/10 border border-white/20 text-white text-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Дата"}),e.jsx("input",{type:"text",inputMode:"numeric",value:C,onChange:j=>{const _=Te(j.target.value);o(_)},placeholder:"08.12.2025",maxLength:10,className:"w-full h-10 px-3 rounded-lg bg-white/10 border border-white/20 text-white text-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"button",onClick:p,disabled:!m||!C||v,className:"btn-glass btn-glass-sm btn-glass-primary disabled:opacity-50",children:v?"...":"Добавить"})})]}),d&&e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-white/5 text-center",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Текущий"}),e.jsxs("p",{className:"text-lg font-bold text-white",children:[d.current.toFixed(1).replace(".",",")," кг"]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-white/5 text-center",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Мин"}),e.jsxs("p",{className:"text-lg font-bold text-green-400",children:[d.min.toFixed(1).replace(".",",")," кг"]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-white/5 text-center",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Макс"}),e.jsxs("p",{className:"text-lg font-bold text-orange-400",children:[d.max.toFixed(1).replace(".",",")," кг"]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-white/5 text-center",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Изменение"}),e.jsxs("p",{className:`text-lg font-bold ${d.change>0?"text-red-400":d.change<0?"text-green-400":"text-gray-400"}`,children:[d.change>0?"+":"",d.change.toFixed(1).replace(".",",")," кг"]})]})]}),r.length>1&&e.jsx("div",{className:"h-48 w-full",children:e.jsx(ge,{width:"100%",height:"100%",children:e.jsxs(fe,{data:r,margin:{top:5,right:5,left:-20,bottom:5},children:[e.jsx(xe,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),e.jsx(we,{dataKey:"date",tick:{fill:"#9ca3af",fontSize:10},axisLine:{stroke:"rgba(255,255,255,0.2)"},tickLine:!1}),e.jsx(be,{domain:["dataMin - 2","dataMax + 2"],tick:{fill:"#9ca3af",fontSize:10},axisLine:{stroke:"rgba(255,255,255,0.2)"},tickLine:!1,tickFormatter:j=>`${j}`}),e.jsx(ye,{contentStyle:{background:"rgba(24,24,27,0.95)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",color:"#fff"},formatter:j=>[`${j.toFixed(1).replace(".",",")} кг`,"Вес"]}),e.jsx(ke,{type:"monotone",dataKey:"weight",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",strokeWidth:0,r:3},activeDot:{r:5,fill:"#60a5fa"}})]})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-gray-300 font-medium",children:["История (",n.length,")"]}),l?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"})}):n.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Пока нет записей. Добавьте свой первый вес выше."}):e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1",children:n.slice(0,20).map(j=>e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 rounded-lg bg-white/5 hover:bg-white/10 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-white font-medium",children:[Number(j.weight).toFixed(1).replace(".",",")," кг"]}),e.jsx("span",{className:"text-sm text-gray-400",children:Ee(new Date(j.recorded_at).toISOString().slice(0,10))})]}),e.jsx("button",{type:"button",onClick:()=>$(j.id),disabled:h===j.id,className:"p-1 text-gray-500 hover:text-red-400 transition-colors disabled:opacity-50",children:h===j.id?e.jsx("span",{className:"w-4 h-4 border border-white/30 border-t-white rounded-full animate-spin inline-block"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},j.id))})]})]}),e.jsx(ie,{open:y,onOpenChange:g,title:"Удалить запись о весе?",description:"Это действие необратимо.",confirmText:"Удалить",cancelText:"Отмена",variant:"danger",onConfirm:()=>{k&&N(k)}})]}),document.body):null}function Ae({isOpen:t,onClose:a,isLoadingWorkoutsForDeletion:n,isLoadingTemplatesForDeletion:l,openDeleteWorkoutsDialog:r,openDeleteTemplatesDialog:d}){if(!t)return null;const m=n||l;return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>{m||a()}}),e.jsxs("div",{className:"relative w-full max-w-md glass card-dark rounded-xl shadow-xl p-5 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Очистить данные"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Выберите, какие данные вы хотите удалить."}),m&&e.jsx("p",{className:"text-xs text-gray-400",children:"Загружаем данные..."}),e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[e.jsx("button",{type:"button",onClick:r,disabled:m,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary disabled:opacity-50",children:"Удалить тренировки"}),e.jsx("button",{type:"button",onClick:d,disabled:m,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary disabled:opacity-50",children:"Удалить шаблоны тренировок"}),e.jsx("button",{type:"button",onClick:()=>{m||a()},className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary bg-white/10 hover:bg-white/5",children:"Отмена"})]})]})]})}function Oe({isOpen:t,onClose:a,workoutDateGroups:n,selectedWorkoutDates:l,isDeletingWorkouts:r,areAllWorkoutDatesSelected:d,toggleWorkoutDateSelection:m,selectAllWorkoutDates:C,clearWorkoutSelection:v,handleDeleteSelectedWorkouts:h}){return t?e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>{r||a()}}),e.jsxs("div",{className:"relative w-full max-w-md glass card-dark rounded-xl shadow-xl p-5 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Удалить тренировки"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Выберите даты тренировок, которые хотите удалить. Это действие необратимо."}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-300",children:[e.jsxs("button",{type:"button",onClick:C,disabled:n.length===0||r,className:"inline-flex items-center gap-2 disabled:opacity-40",children:[e.jsx("div",{className:`w-4 h-4 rounded-md border flex items-center justify-center ${d?"bg-green-500 border-green-400":"border-white/40"}`,children:d&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-7.25 7.25a1 1 0 01-1.414 0l-3.25-3.25a1 1 0 111.414-1.414L8.5 11.836l6.543-6.543a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("span",{children:"Выбрать все"})]}),e.jsx("button",{type:"button",onClick:v,disabled:l.length===0||r,className:"text-xs text-gray-400 hover:text-gray-200 disabled:opacity-40",children:"Отменить выбранное"})]}),e.jsxs("div",{className:"max-h-64 overflow-y-auto rounded-md bg-black/20 p-3 space-y-2",children:[n.map(y=>{const k=l.includes(y.date);return e.jsxs("button",{type:"button",onClick:()=>m(y.date),className:`w-full flex items-center justify-between px-3 py-2 rounded-md border text-left transition-colors ${k?"bg-white/10 border-green-400":"bg-transparent border-white/10 hover:bg-white/5"}`,children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:y.date}),e.jsx("div",{className:"text-xs text-gray-400",children:y.count===1?"1 тренировка":`${y.count} тренировок`})]}),e.jsx("div",{className:`w-5 h-5 rounded-md border flex items-center justify-center ${k?"bg-green-500 border-green-400":"border-white/40"}`,children:k&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-7.25 7.25a1 1 0 01-1.414 0l-3.25-3.25a1 1 0 111.414-1.414L8.5 11.836l6.543-6.543a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},y.date)}),n.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:"Тренировки для удаления не найдены."})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[e.jsx("button",{type:"button",onClick:h,disabled:l.length===0||r,className:"btn-glass btn-glass-full btn-glass-md btn-glass-primary disabled:opacity-50",children:r?"Удаляем выбранные...":"Удалить выбранные"}),e.jsx("button",{type:"button",onClick:()=>{r||a()},className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:"Отмена"})]})]})]}):null}function Ie({isOpen:t,onClose:a,templatesForDeletion:n,selectedTemplateIds:l,isDeletingTemplates:r,areAllTemplatesSelected:d,toggleTemplateSelection:m,selectAllTemplates:C,clearTemplateSelection:v,handleDeleteSelectedTemplates:h}){return t?e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>{r||a()}}),e.jsxs("div",{className:"relative w-full max-w-md glass card-dark rounded-xl shadow-xl p-5 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Удалить шаблоны тренировок"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Выберите шаблоны тренировок, которые хотите удалить. Это действие необратимо."}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-300",children:[e.jsxs("button",{type:"button",onClick:C,disabled:n.length===0||r,className:"inline-flex items-center gap-2 disabled:opacity-40",children:[e.jsx("div",{className:`w-4 h-4 rounded-md border flex items-center justify-center ${d?"bg-green-500 border-green-400":"border-white/40"}`,children:d&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-7.25 7.25a1 1 0 01-1.414 0l-3.25-3.25a1 1 0 111.414-1.414L8.5 11.836l6.543-6.543a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("span",{children:"Выбрать все"})]}),e.jsx("button",{type:"button",onClick:v,disabled:l.length===0||r,className:"text-xs text-gray-400 hover:text-gray-200 disabled:opacity-40",children:"Отменить выбранное"})]}),e.jsxs("div",{className:"max-h-64 overflow-y-auto rounded-md bg-black/20 p-3 space-y-2",children:[n.map(y=>{const k=l.includes(y.id);return e.jsxs("button",{type:"button",onClick:()=>m(y.id),className:`w-full flex items-center justify-between px-3 py-2 rounded-md border text-left transition-colors ${k?"bg-white/10 border-green-400":"bg-transparent border-white/10 hover:bg-white/5"}`,children:[e.jsx("div",{className:"text-sm font-medium text-white",children:y.name}),e.jsx("div",{className:`w-5 h-5 rounded-md border flex items-center justify-center ${k?"bg-green-500 border-green-400":"border-white/40"}`,children:k&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-7.25 7.25a1 1 0 01-1.414 0l-3.25-3.25a1 1 0 111.414-1.414L8.5 11.836l6.543-6.543a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},y.id)}),n.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:"Шаблоны для удаления не найдены."})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[e.jsx("button",{type:"button",onClick:h,disabled:l.length===0||r,className:"btn-glass btn-glass-full btn-glass-md btn-glass-primary disabled:opacity-50",children:r?"Удаляем выбранные...":"Удалить выбранные"}),e.jsx("button",{type:"button",onClick:()=>{r||a()},className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:"Отмена"})]})]})]}):null}function $e({isImportingWorkouts:t,isImportingTemplates:a,handleStartImportWorkouts:n,handleStartImportTemplates:l,isExporting:r,isExportingTemplates:d,handleExportWorkouts:m,handleExportTemplates:C,isDeleting:v,startCleanDataFlow:h,startDeleteAccountFlow:y}){const[k,W]=s.useState(!1),o=s.useRef(null);return s.useEffect(()=>{const g=p=>{o.current&&!o.current.contains(p.target)&&W(!1)};if(k)return document.addEventListener("click",g),()=>document.removeEventListener("click",g)},[k]),e.jsxs("div",{className:"relative",ref:o,children:[e.jsx("button",{onClick:()=>W(!k),className:"p-2 text-white hover:text-gray-300 transition-colors","aria-label":"Меню",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 8c1.1 0 2-1 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 1-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 1-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})})}),k&&e.jsxs("div",{className:"absolute right-0 mt-2 menu-popover space-y-0.5",children:[e.jsx("div",{className:"px-4 pt-2 pb-0 text-[11px] font-semibold uppercase tracking-wide text-gray-400 text-center whitespace-nowrap",children:"Импорт"}),e.jsx("button",{onClick:()=>{W(!1),n()},disabled:t,className:"w-full text-left px-4 py-1.5 text-sm text-white hover:bg-white/5 disabled:opacity-50 transition-colors rounded-lg",children:t?"Импорт тренировок...":"Тренировки"}),e.jsx("button",{onClick:()=>{W(!1),l()},disabled:a,className:"w-full text-left px-4 py-1.5 text-sm text-white hover:bg-white/5 disabled:opacity-50 transition-colors rounded-lg",children:a?"Импорт шаблонов...":"Шаблоны"}),e.jsx("div",{className:"px-4 pt-1 pb-0 text-[11px] font-semibold uppercase tracking-wide text-gray-400 text-center whitespace-nowrap",children:"Экспорт"}),e.jsx("button",{onClick:async()=>{W(!1),await m()},disabled:r,className:"w-full text-left px-4 py-1.5 text-sm text-white hover:bg-white/5 disabled:opacity-50 transition-colors rounded-lg",children:r?"Экспорт тренировок...":"Тренировки"}),e.jsx("button",{onClick:async()=>{W(!1),await C()},disabled:d,className:"w-full text-left px-4 py-1.5 text-sm text-white hover:bg-white/5 disabled:opacity-50 transition-colors rounded-lg",children:d?"Экспорт шаблонов...":"Шаблоны"}),e.jsx("div",{className:"px-4 pt-1 pb-0 text-[11px] font-semibold uppercase tracking-wide text-gray-400 text-center whitespace-nowrap",children:"Данные и аккаунт"}),e.jsx("button",{onClick:()=>{W(!1),h()},className:"w-full text-left px-4 py-1.5 text-sm text-white hover:bg-white/5 transition-colors rounded-lg",children:"Очистить данные"}),e.jsx("button",{onClick:()=>{W(!1),y()},disabled:v,className:"w-full text-left px-4 py-1.5 text-sm text-red-400 hover:bg-red-500/10 disabled:opacity-50 transition-colors rounded-lg",children:v?"Удаление...":"Удалить аккаунт"})]})]})}function Me({isOpen:t,timerStepInput:a,setTimerStepInput:n,saveStatus:l,saveTimerStep:r,theme:d,handleThemeChange:m}){return t?e.jsxs("div",{className:"glass card-dark rounded-lg p-4 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Настройки"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm text-gray-300",children:"Шаг таймера отдыха (секунды)"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Значение, на которое изменяется таймер при нажатии +/-"}),e.jsxs("div",{className:"flex items-center justify-center gap-3 flex-wrap",children:[e.jsx("input",{type:"number",min:"1",max:"300",value:a,onChange:C=>n(C.target.value),className:"w-24 px-3 py-2 rounded-lg bg-white/10 border border-white/20 text-white text-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsxs("button",{type:"button",onClick:r,disabled:l==="saving",className:"btn-glass btn-glass-sm btn-glass-primary flex items-center justify-center gap-2 min-w-[120px]",children:[l==="saving"&&e.jsx("span",{"aria-label":"Сохранение...",className:"h-5 w-5 inline-block border-2 border-white/70 border-t-transparent rounded-full animate-spin"}),l==="success"&&e.jsx("svg",{"aria-label":"Сохранено",xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),l==="idle"&&"Сохранить"]})]})]}),e.jsxs("div",{className:"border-t border-white/10 pt-4 space-y-2",children:[e.jsx("label",{className:"block text-sm text-gray-300",children:"Тема оформления"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>m("dark"),className:`btn-glass ${d==="dark"?"btn-glass-primary":"btn-glass-secondary"} w-full !py-2 !px-3 font-medium transition-all duration-200 ease-out`,children:e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),"Тёмная"]})}),e.jsx("button",{type:"button",onClick:()=>m("light"),className:`btn-glass ${d==="light"?"btn-glass-primary":"btn-glass-secondary"} w-full !py-2 !px-3 font-medium transition-all duration-200 ease-out`,children:e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),"Светлая"]})}),e.jsx("button",{type:"button",onClick:()=>m("auto"),className:`btn-glass ${d==="auto"?"btn-glass-primary":"btn-glass-secondary"} w-full !py-2 !px-3 font-medium transition-all duration-200 ease-out`,children:e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Авто"]})})]})]})]}):null}function Re({isOpen:t,pendingTemplatesDuplicates:a,isImportingTemplates:n,templatesImportAction:l,onClose:r,handleImportTemplatesOnlyNew:d,handleImportTemplatesOverwrite:m}){return t?e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>{n||r()}}),e.jsxs("div",{className:"relative w-full max-w-md glass card-dark rounded-xl shadow-xl p-5 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Импорт шаблонов"}),e.jsxs("div",{className:"text-sm text-gray-300 space-y-1",children:[e.jsx("p",{children:"В файле найдены шаблоны с именами, которые уже есть в вашем аккаунте."}),e.jsxs("ul",{className:"list-disc list-inside text-xs text-gray-400 space-y-0.5",children:[e.jsx("li",{children:"«Импортировать только новые шаблоны» — добавит только те, которых ещё нет."}),e.jsx("li",{children:"«Перезаписать существующие шаблоны» — удалит совпадающие и создаст их заново из файла."})]})]}),e.jsxs("div",{className:"max-h-48 overflow-y-auto rounded-md bg-black/20 p-3 space-y-2",children:[a.map((C,v)=>{var h;return e.jsxs("div",{className:"text-sm text-gray-200 border-b border-white/5 pb-1 last:border-0",children:[e.jsx("div",{className:"font-semibold",children:((h=C.template)==null?void 0:h.name)||"Без названия"}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Уже есть как: «",C.existingName||"Без названия","»"]})]},C.existingId+"-"+v)}),a.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:"Совпадающих шаблонов не найдено."})]}),n?e.jsxs("div",{className:"mt-4 flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("p",{className:"text-sm text-gray-300",children:l==="overwrite"?"Перезаписываем существующие шаблоны и импортируем данные...":"Импортируем только новые шаблоны..."})]}):e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[e.jsx("button",{type:"button",onClick:d,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:"Импортировать только новые шаблоны (без изменения существующих)"}),e.jsx("button",{type:"button",onClick:m,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:"Перезаписать существующие шаблоны и добавить новые"}),e.jsx("button",{type:"button",onClick:r,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:"Отмена"})]})]})]}):null}function Fe(t){if(!t||typeof t!="string")return t;const a=t.split("-");if(a.length===3){const[n,l,r]=a;if(n&&l&&r)return`${r}.${l}.${n}`}return t}function Pe({isOpen:t,pendingWorkoutsImport:a,pendingWorkoutsFileName:n,pendingWorkoutsNewDatesSummary:l,isImportingWorkouts:r,importAction:d,onClose:m,handleConfirmImportWorkoutsOnly:C,handleImportOnlyNewWorkouts:v,handleExportThenImportWorkouts:h}){return!t||!a?null:e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>{r||m()}}),e.jsxs("div",{className:"relative w-full max-w-md glass card-dark rounded-xl shadow-xl p-5 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Импорт тренировок"}),e.jsx("p",{className:"text-sm text-gray-300",children:`Будут импортированы тренировки из файла "${n||"выбранный файл"}".`}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-1",children:[e.jsx("p",{children:"Тренировки на даты, которые уже есть в календаре и присутствуют в файле, будут удалены и перезаписаны данными из файла. На другие даты тренировки останутся без изменений."}),e.jsxs("ul",{className:"list-disc list-inside text-xs text-gray-500 space-y-0.5",children:[e.jsx("li",{children:"«Импортировать только новые тренировки» — добавит тренировки только на новые даты, без изменения существующих."}),e.jsx("li",{children:"«Импортировать с перезаписью дат» — заменит тренировки на совпадающие даты и добавит новые."}),e.jsx("li",{children:"«Экспортировать текущие тренировки и импортировать с перезаписью» — сначала сохранит текущие тренировки в файл, затем выполнит импорт с перезаписью дат."})]})]}),l.length>0&&e.jsxs("div",{className:"mt-2 rounded-md bg-black/20 p-3",children:[e.jsx("p",{className:"text-xs text-gray-300",children:"Новые тренировки из файла (даты, которых ещё нет в календаре):"}),e.jsx("div",{className:"mt-1 space-y-1 max-h-32 overflow-y-auto text-center",children:l.map(y=>e.jsx("div",{className:"text-xs text-gray-200",children:e.jsx("span",{children:Fe(y.date)})},y.date))})]}),r?e.jsxs("div",{className:"mt-4 flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("p",{className:"text-sm text-gray-300",children:d==="exportThenImport"?"Экспортируем текущие тренировки и импортируем новые...":d==="onlyNew"?"Импортируем только новые тренировки...":"Импортируем тренировки..."})]}):e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[l.length>0&&e.jsx("button",{type:"button",onClick:v,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:"Импортировать только новые тренировки (без изменения существующих)"}),e.jsx("button",{type:"button",onClick:C,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:"Импортировать с перезаписью дат из файла"}),e.jsx("button",{type:"button",onClick:h,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:"Экспортировать текущие тренировки и импортировать с перезаписью дат"}),e.jsx("button",{type:"button",onClick:m,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary bg-white/10 hover:bg-white/5",children:"Отмена"})]})]})]})}const Ge=()=>{const{user:t,signOut:a}=ue(),n=pe(),[l,r]=s.useState(!1),[d,m]=s.useState(!1),[C,v]=s.useState(""),[h,y]=s.useState(null),[k,W]=s.useState(!1),o=Ce({userId:t==null?void 0:t.id,userEmail:t==null?void 0:t.email}),g=Se({userId:t==null?void 0:t.id,userEmail:t==null?void 0:t.email,setToastVariant:o.setToastVariant,setImportSuccessMessage:o.setImportSuccessMessage,setIsImportSuccessOpen:o.setIsImportSuccessOpen}),p=_e({userId:t==null?void 0:t.id,setToastVariant:o.setToastVariant,setImportSuccessMessage:o.setImportSuccessMessage,setIsImportSuccessOpen:o.setIsImportSuccessOpen}),N=Ne({userId:t==null?void 0:t.id}),$=ve();s.useEffect(()=>{N.isWeightTrackerOpen&&t&&N.loadBodyWeights()},[N.isWeightTrackerOpen,t]);const j=s.useMemo(()=>{var x;if(!t)return"";const f=(x=t.user_metadata)==null?void 0:x.nickname;if(typeof f=="string"&&f.trim().length>0)return f.trim();const U=t.email||"";return U.endsWith("@gymlog.app")?U.replace(/@gymlog\.app$/,""):U},[t]),_=s.useMemo(()=>{const f=(t==null?void 0:t.email)||"";if(!f||typeof f!="string")return null;const[U,x]=f.split("@");if(!U||!x)return null;const q=Math.max(1,Math.ceil(U.length/2)),i=U.slice(0,q),w=U.slice(q);return{email:f,localPart:U,domain:x,visiblePart:i,hiddenPart:w}},[t==null?void 0:t.email]),T=async()=>{try{await a(),n("/login",{replace:!0})}catch(f){console.error("Error logging out:",f)}},J=()=>{!t||!t.email||(v(""),y(null),m(!0))},M=()=>{t&&p.setIsCleanDataDialogOpen(!0)},G=async()=>{if(!(!t||!t.email)){if(C.trim()!==t.email)throw y("Введённый e-mail не совпадает с вашим."),new Error("EMAIL_MISMATCH");y(null),r(!0);try{await je(),alert("Ваш аккаунт и все данные были успешно удалены."),await a(),n("/login",{replace:!0})}catch(f){console.error("Error deleting account:",f),alert(`Не удалось удалить аккаунт: ${f.message}`)}finally{r(!1)}}};return e.jsxs("div",{className:"p-4 space-y-4 max-w-lg mx-auto pt-safe relative profile-page",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Профиль"}),e.jsx($e,{isImportingWorkouts:o.isImportingWorkouts,isImportingTemplates:g.isImportingTemplates,handleStartImportWorkouts:o.handleStartImportWorkouts,handleStartImportTemplates:g.handleStartImportTemplates,isExporting:o.isExporting,isExportingTemplates:g.isExportingTemplates,handleExportWorkouts:o.handleExportWorkouts,handleExportTemplates:g.handleExportTemplates,isDeleting:l,startCleanDataFlow:M,startDeleteAccountFlow:J})]}),e.jsx("div",{className:"p-4 glass card-dark rounded-lg shadow",children:t&&e.jsxs("p",{className:"flex flex-wrap items-center gap-1",children:[e.jsx("span",{children:"Вы вошли как:"}),_?e.jsxs("span",{className:"font-semibold",children:[_.visiblePart,_.hiddenPart&&e.jsx("button",{type:"button",onClick:()=>W(!0),className:"inline px-0 py-0 border-b border-dashed border-white/40 hover:border-white/80 transition-colors cursor-pointer select-none bg-transparent rounded-none align-baseline",children:k?e.jsx("span",{children:_.hiddenPart}):e.jsx("span",{children:"•".repeat(Math.max(3,_.hiddenPart.length))})}),"@",_.domain]}):e.jsx("span",{className:"font-semibold",children:j})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>n("/progress"),className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),"Узнать прогресс"]}),e.jsxs("button",{onClick:()=>N.setIsWeightTrackerOpen(!0),className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"})}),"Трекер веса тела"]}),e.jsxs("button",{onClick:()=>$.setIsSettingsOpen(!$.isSettingsOpen),className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary flex items-center justify-center gap-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Настройки",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 transition-transform ${$.isSettingsOpen?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),e.jsx("button",{onClick:T,className:"btn-glass btn-glass-logout btn-glass-full btn-glass-md",children:"Выйти"})]}),e.jsx(Me,{isOpen:$.isSettingsOpen,timerStepInput:$.timerStepInput,setTimerStepInput:$.setTimerStepInput,saveStatus:$.saveStatus,saveTimerStep:$.saveTimerStep,theme:$.theme,handleThemeChange:$.handleThemeChange}),e.jsx("input",{ref:o.workoutsFileInputRef,type:"file",accept:"application/json",className:"hidden",onChange:o.handleWorkoutsFileChange}),e.jsx("input",{ref:g.templatesFileInputRef,type:"file",accept:"application/json",className:"hidden",onChange:g.handleTemplatesFileChange}),e.jsx(ie,{open:d,onOpenChange:f=>{m(f),f||(v(""),y(null))},title:"Удалить аккаунт и все данные?",description:"Это действие необратимо и удалит все ваши данные.",confirmText:"Удалить аккаунт",cancelText:"Отмена",variant:"danger",confirmDisabled:C.trim().length===0,onConfirm:G,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm text-gray-300",children:["Для подтверждения введите ваш e-mail: ",e.jsx("span",{className:"font-semibold",children:t==null?void 0:t.email})]}),e.jsx("input",{type:"email",value:C,onChange:f=>{v(f.target.value),h&&y(null)},placeholder:(t==null?void 0:t.email)||"Введите ваш e-mail",className:"mt-1 block w-full px-3 py-2 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500",style:{background:"#18181b",color:"#fafafa",border:"1px solid #3f3f46"}}),h&&e.jsx("p",{className:"text-xs text-red-400",children:h})]})}),e.jsx(Ae,{isOpen:p.isCleanDataDialogOpen,onClose:()=>p.setIsCleanDataDialogOpen(!1),isLoadingWorkoutsForDeletion:p.isLoadingWorkoutsForDeletion,isLoadingTemplatesForDeletion:p.isLoadingTemplatesForDeletion,openDeleteWorkoutsDialog:p.openDeleteWorkoutsDialog,openDeleteTemplatesDialog:p.openDeleteTemplatesDialog}),e.jsx(Oe,{isOpen:p.isDeleteWorkoutsDialogOpen,onClose:p.closeDeleteWorkoutsDialog,workoutDateGroups:p.workoutDateGroups,selectedWorkoutDates:p.selectedWorkoutDates,isDeletingWorkouts:p.isDeletingWorkouts,areAllWorkoutDatesSelected:p.areAllWorkoutDatesSelected,toggleWorkoutDateSelection:p.toggleWorkoutDateSelection,selectAllWorkoutDates:p.selectAllWorkoutDates,clearWorkoutSelection:p.clearWorkoutSelection,handleDeleteSelectedWorkouts:p.handleDeleteSelectedWorkouts}),e.jsx(Ie,{isOpen:p.isDeleteTemplatesDialogOpen,onClose:p.closeDeleteTemplatesDialog,templatesForDeletion:p.templatesForDeletion,selectedTemplateIds:p.selectedTemplateIds,isDeletingTemplates:p.isDeletingTemplates,areAllTemplatesSelected:p.areAllTemplatesSelected,toggleTemplateSelection:p.toggleTemplateSelection,selectAllTemplates:p.selectAllTemplates,clearTemplateSelection:p.clearTemplateSelection,handleDeleteSelectedTemplates:p.handleDeleteSelectedTemplates}),e.jsx(he,{open:o.isImportSuccessOpen,onOpenChange:f=>{f||o.closeImportSuccessToast()},onClose:o.closeImportSuccessToast,message:o.importSuccessMessage||"Импорт тренировок завершён. Откройте календарь, чтобы посмотреть тренировки.",variant:o.toastVariant}),e.jsx(Re,{isOpen:g.isTemplatesImportDialogOpen,pendingTemplatesDuplicates:g.pendingTemplatesDuplicates,isImportingTemplates:g.isImportingTemplates,templatesImportAction:g.templatesImportAction,onClose:g.closeTemplatesImportDialog,handleImportTemplatesOnlyNew:g.handleImportTemplatesOnlyNew,handleImportTemplatesOverwrite:g.handleImportTemplatesOverwrite}),e.jsx(Pe,{isOpen:o.isWorkoutsImportDialogOpen,pendingWorkoutsImport:o.pendingWorkoutsImport,pendingWorkoutsFileName:o.pendingWorkoutsFileName,pendingWorkoutsNewDatesSummary:o.pendingWorkoutsNewDatesSummary,isImportingWorkouts:o.isImportingWorkouts,importAction:o.importAction,onClose:o.closeWorkoutsImportDialog,handleConfirmImportWorkoutsOnly:o.handleConfirmImportWorkoutsOnly,handleImportOnlyNewWorkouts:o.handleImportOnlyNewWorkouts,handleExportThenImportWorkouts:o.handleExportThenImportWorkouts}),e.jsx(Le,{isOpen:N.isWeightTrackerOpen,onClose:()=>N.setIsWeightTrackerOpen(!1),bodyWeights:N.bodyWeights,loadingWeights:N.loadingWeights,weightChartData:N.weightChartData,weightStats:N.weightStats,newWeight:N.newWeight,newWeightDate:N.newWeightDate,savingWeight:N.savingWeight,deletingWeightId:N.deletingWeightId,isDeleteWeightConfirmOpen:N.isDeleteWeightConfirmOpen,weightToDelete:N.weightToDelete,setNewWeight:N.setNewWeight,setNewWeightDate:N.setNewWeightDate,setIsDeleteWeightConfirmOpen:N.setIsDeleteWeightConfirmOpen,handleAddWeight:N.handleAddWeight,handleDeleteWeight:N.handleDeleteWeight,handleOpenDeleteWeightConfirm:N.handleOpenDeleteWeightConfirm})]})};export{Ge as default};
