import{u as Ne,s as F,g as ve,a as Te,j as e,W as Fe}from"./index-CdKHO-e-.js";import{r as a,d as Oe}from"./vendor-CITejod9.js";import{n as Q,p as He}from"./exercise-name-BJxyXXn3.js";import{u as ze}from"./use-header-scroll-7IJnuRE2.js";import{u as Ae}from"./use-scroll-restoration-DRBOG5hM.js";import{u as Be}from"./use-modal-scroll-lock-CmZrgGCz.js";import{u as ye}from"./usePageState-Qdkxdikz.js";import{R as Ye,L as Ge,C as qe,X as Qe,Y as Je,T as Ke,a as Ue}from"./charts-D-QCyllA.js";import"./supabase-vtL5VWMt.js";function Ve(){const{user:u}=Ne(),d=a.useRef(null),s=a.useRef(new Map),S=300*1e3,M=a.useRef(!1),C=a.useRef(void 0),[b,E]=ye({key:"progress-page:exercises",initialState:{loaded:!1,exercises:[]},ttl:600*1e3}),[O,h]=a.useState(()=>!b.loaded),[Z,L]=a.useState(null),[G,J]=a.useState(!1),[ae,k]=ye({key:"progress-page",initialState:{searchQuery:"",selectedExercise:null},ttl:1800*1e3}),{searchQuery:ee,selectedExercise:H}=ae,te=c=>{k(g=>({...g,searchQuery:c}))},z=c=>{k(g=>({...g,selectedExercise:c}))},A=a.useCallback(async()=>{if(!u)return[];if(d.current)return d.current;const{data:c,error:g}=await F.from("workouts").select("id").eq("user_id",u.id);if(g)throw g;const D=(c||[]).map(W=>W.id);return d.current=D,D},[u]),P=a.useCallback(async(c=!1)=>{if(u){c||h(!0);try{const g=await A();if(g.length===0){E({loaded:!0,exercises:[]});return}const{data:D,error:W}=await F.from("exercise_progress_view").select("workout_id, exercise_id, max_weight, workout_date").in("workout_id",g);if(W)throw W;const j=new Map;if((D||[]).forEach(v=>{const l=v.exercise_id,m=v.max_weight||0,x=v.workout_date;if(!l||m<=0)return;const w=j.get(l);if(w){const U=x&&(!w.lastSetDate||x>w.lastSetDate)?x:w.lastSetDate;j.set(l,{total:w.total+1,lastSetDate:U})}else j.set(l,{total:1,lastSetDate:x})}),j.size===0){E({loaded:!0,exercises:[]});return}const{data:B,error:I}=await F.from("workout_exercises").select("id, name").in("id",Array.from(j.keys()));if(I)throw I;const _=Q,T=new Map;(B||[]).forEach(v=>{const l=(v.name??"").trim();if(!l)return;const m=_(l),x=j.get(v.id);if(!x||x.total<=0)return;const w=T.get(m);if(w){const U=x.lastSetDate&&(!w.lastSetDate||x.lastSetDate>w.lastSetDate)?x.lastSetDate:w.lastSetDate;T.set(m,{name:w.name.length>=l.length?w.name:l,total:w.total+x.total,lastSetDate:U})}else T.set(m,{name:l,total:x.total,lastSetDate:x.lastSetDate})});const p=Array.from(T.values()).map(({name:v,total:l,lastSetDate:m})=>({name:v,totalSets:l,lastSetDate:m})).sort((v,l)=>v.name.localeCompare(l.name,"ru"));E({loaded:!0,exercises:p})}catch(g){console.error("Error fetching progress exercises:",g),c||(alert(ve().hooks.failedToLoadExercises),E({loaded:!0,exercises:[]}))}finally{c||h(!1)}}},[u,A,E]),K=a.useCallback(async c=>{if(!u||!c){L(null);return}const g=Q(c),D=s.current.get(g),W=Date.now();if(D&&W-D.ts<S){L(D.data);return}J(!0);try{const j=await A();if(j.length===0){L({exerciseName:c,dataPoints:[],totalSessions:0,maxWeight:0,minWeight:0}),s.current.set(g,{data:{exerciseName:c,dataPoints:[],totalSessions:0,maxWeight:0,minWeight:0},ts:Date.now()});return}const{data:B,error:I}=await F.from("workout_exercises").select("id, name, workout_id").in("workout_id",j);if(I)throw I;const _=new Set;if((B||[]).forEach(m=>{const x=(m.name??"").trim();x&&Q(x)===g&&_.add(m.id)}),_.size===0){L({exerciseName:c,dataPoints:[],totalSessions:0,maxWeight:0,minWeight:0});return}const{data:T,error:p}=await F.from("exercise_progress_view").select("workout_date, workout_name, workout_id, exercise_id, max_weight, reps_at_max_weight").in("workout_id",j).in("exercise_id",Array.from(_));if(p)throw p;const v=(T||[]).map(m=>({workout_date:m.workout_date,workout_name:m.workout_name,workout_id:m.workout_id,exercise_id:m.exercise_id,max_weight:m.max_weight,reps_at_max_weight:m.reps_at_max_weight})),l=He(c,v);L(l),s.current.set(g,{data:l,ts:Date.now()})}catch(j){console.error("Error loading progress data:",j),alert(ve().hooks.failedToLoadProgress),L(null)}finally{J(!1)}},[u,A,S]);return a.useEffect(()=>{u&&(M.current||(M.current=!0,P(b.loaded)))},[P,b.loaded,u]),a.useEffect(()=>{const c=u==null?void 0:u.id;if(C.current===void 0){C.current=c;return}C.current!==c&&(C.current=c,d.current=null,s.current.clear(),M.current=!1,E({loaded:!1,exercises:[]}),h(!0))},[u==null?void 0:u.id,E]),{exercises:b.exercises,loading:O,progressData:Z,loadingProgress:G,searchQuery:ee,selectedExercise:H,setSearchQuery:te,setSelectedExercise:z,loadProgress:K}}function Xe(u,d,s,S){const M=Math.abs(u),C=M%10,b=M%100;return b>=11&&b<=19?S:C===1?d:C>=2&&C<=4?s:S}const ke=F,Ze=({active:u,payload:d})=>{if(!u||!(d!=null&&d[0]))return null;const s=d[0].payload;return e.jsxs("div",{className:"glass card-dark p-3 rounded-lg shadow-lg border border-white/20",children:[e.jsx("p",{className:"text-sm text-gray-300 mb-1",children:s.workoutName}),e.jsxs("p",{className:"text-base font-bold text-white",children:[s.weight," kg × ",s.reps||"?"]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(s.date).toLocaleDateString()})]})},ct=()=>{var fe,pe;const u=Oe(),{user:d}=Ne(),{t:s,language:S}=Te(),{exercises:M,loading:C,progressData:b,loadingProgress:E,searchQuery:O,selectedExercise:h,setSearchQuery:Z,setSelectedExercise:L,loadProgress:G}=Ve(),J=a.useRef(null),ae=ze(),[k,ee]=a.useState("all"),[H,te]=a.useState(null),[z,A]=a.useState(null),[P,K]=a.useState(!1),[c,g]=a.useState(!1),[D,W]=a.useState(!1),j=a.useRef(null),B=a.useRef(null),I=a.useRef(null),[_,T]=a.useState(()=>{try{return localStorage.getItem("progress:exerciseSort")||"lastAdded"}catch{return"lastAdded"}}),[p,v]=a.useState(()=>{try{return localStorage.getItem("progress:activeTab")||"exercises"}catch{return"exercises"}}),[l,m]=a.useState(3),[x,w]=a.useState([]),[U,ie]=a.useState(!1),[le,oe]=a.useState(!1),[$,ce]=a.useState(()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`}),q="progress:cardioCache",se=1800*1e3,de=a.useRef(!1);Be(le);const Se=a.useCallback(()=>h?`scroll:progress-page:detail:${Q(h||"")}`:"scroll:progress-page:list",[h]),De=t=>{L(t),G(t)},Ce=t=>{u(`/workout/${t.date}`,{state:{focusExerciseId:t.exerciseId}})},_e=()=>{h?(L(null),G(null)):u("/profile")};Ae({key:Se(),enabled:!C&&(!h||!E&&!!b)}),a.useEffect(()=>{try{const t="progress:lastSelectedExercise";h?localStorage.setItem(t,h):localStorage.removeItem(t)}catch{}},[h]),a.useEffect(()=>{if(!h)try{const t=localStorage.getItem("progress:lastSelectedExercise");t&&L(t)}catch{}},[]),a.useEffect(()=>{h&&G(h)},[h,G]),a.useEffect(()=>{ee("all"),te(null),A(null)},[h]),a.useEffect(()=>{const t=r=>{j.current&&!j.current.contains(r.target)&&K(!1),B.current&&!B.current.contains(r.target)&&g(!1),I.current&&!I.current.contains(r.target)&&W(!1)};if(P||c||D)return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[P,c,D]),a.useEffect(()=>{try{localStorage.setItem("progress:exerciseSort",_)}catch{}},[_]),a.useEffect(()=>{try{localStorage.setItem("progress:activeTab",p)}catch{}},[p]),a.useEffect(()=>{if(!d)return;let t=!1;return(async()=>{var o;try{const{data:n,error:i}=await ke.from("user_settings").select("cardio_weekly_goal").eq("user_id",d.id).limit(1);if(i){console.error("Error loading cardio goal:",i);return}!t&&n&&n.length>0&&typeof((o=n[0])==null?void 0:o.cardio_weekly_goal)=="number"&&m(n[0].cardio_weekly_goal)}catch(n){console.error("Error loading cardio goal:",n)}finally{t||(de.current=!0)}})(),()=>{t=!0}},[d]),a.useEffect(()=>{if(!d||!de.current)return;(async()=>{try{const{error:r}=await ke.from("user_settings").upsert({user_id:d.id,cardio_weekly_goal:l},{onConflict:"user_id"});r&&console.error("Error saving cardio goal:",r)}catch(r){console.error("Error saving cardio goal:",r)}})()},[l,d]),a.useEffect(()=>{if(p!=="cardio"||!d)return;const t=()=>{try{const i=localStorage.getItem(q);if(!i)return null;const N=JSON.parse(i);return Date.now()-(N.timestamp||0)>se?null:N.data||null}catch{return null}},r=i=>{try{localStorage.setItem(q,JSON.stringify({data:i,timestamp:Date.now()}))}catch{}},o=async(i=!1)=>{i||ie(!0);try{const{data:N,error:f}=await F.from("workouts").select("workout_date").eq("user_id",d.id).eq("is_cardio",!0).order("workout_date",{ascending:!1});if(f)throw f;const X=N||[];w(X),r(X)}catch(N){console.error("Error fetching cardio workouts:",N)}finally{i||ie(!1)}},n=t();if(n){w(n),o(!0);return}o(!1)},[p,d,q,se]),a.useEffect(()=>{const t=()=>{if(document.visibilityState!=="visible"||p!=="cardio"||!d)return;const r=localStorage.getItem(q);let o=!0;if(r)try{const n=JSON.parse(r);o=Date.now()-(n.timestamp||0)>se}catch{o=!0}o&&(async()=>{try{const{data:n,error:i}=await F.from("workouts").select("workout_date").eq("user_id",d.id).eq("is_cardio",!0).order("workout_date",{ascending:!1});!i&&n&&(w(n),localStorage.setItem(q,JSON.stringify({data:n,timestamp:Date.now()})))}catch{}})()};return document.addEventListener("visibilitychange",t),()=>document.removeEventListener("visibilitychange",t)},[p,d,q,se]);const ue=a.useMemo(()=>{if(!$)return[];const[t,r]=$.split("-").map(Number),o=new Date(t,r-1,1),n=new Date(t,r,0);o.setHours(0,0,0,0),n.setHours(23,59,59,999);const i=new Date;i.setHours(0,0,0,0);const N=[];let f=new Date(o);const X=f.getDay(),Ie=X===0?-6:1-X;for(f.setDate(f.getDate()+Ie);f<=n||f.getMonth()===r-1||f.getMonth()===r-2&&f.getDate()>20;){const Y=new Date(f),R=new Date(f);if(Y.setHours(0,0,0,0),R.setDate(R.getDate()+6),R.setHours(23,59,59,999),R>=o&&Y<=n){const $e=x.filter(Pe=>{const[we,be,je]=Pe.workout_date.split("-").map(Number);if(!we||!be||!je)return!1;const ne=new Date(we,be-1,je);return ne.setHours(12,0,0,0),ne>=Y&&ne<=R}).length,Re=i>=Y&&i<=R;N.push({weekStart:Y.toISOString().slice(0,10),weekEnd:R.toISOString().slice(0,10),weekLabel:`${Y.getDate()}.${String(Y.getMonth()+1).padStart(2,"0")} - ${R.getDate()}.${String(R.getMonth()+1).padStart(2,"0")}`,count:$e,goal:l,isCurrentWeek:Re})}if(f.setDate(f.getDate()+7),f>n&&f.getMonth()!==r-1)break}return N},[$,x,l]),re=a.useMemo(()=>{const t={},r=s.cardio.monthsShort;return x.forEach(o=>{const n=new Date(o.workout_date),i=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`;t[i]||(t[i]={month:i,year:n.getFullYear(),count:0,monthLabel:`${r[n.getMonth()]} ${n.getFullYear()}`}),t[i].count++}),Object.values(t).sort((o,n)=>n.month.localeCompare(o.month))},[x]),he=a.useMemo(()=>{const t=[],r=s.cardio.months,o=new Date;for(let n=0;n<12;n++){const i=new Date(o.getFullYear(),o.getMonth()-n,1),N=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`;t.push({value:N,label:`${r[i.getMonth()]} ${i.getFullYear()}`})}return t},[]),Me=a.useMemo(()=>{var t;return $&&((t=re.find(r=>r.month===$))==null?void 0:t.count)||0},[$,re]),xe=[{id:"all",label:s.progress.period.all},{id:"3m",label:s.progress.period.threeMonths},{id:"6m",label:s.progress.period.sixMonths},{id:"1y",label:s.progress.period.oneYear},{id:"custom",label:s.progress.period.custom}],Ee=((fe=xe.find(t=>t.id===k))==null?void 0:fe.label)||"Выбрать",y=a.useMemo(()=>{if(!b)return[];const t=b.dataPoints;if(k==="all")return t;const r=new Date;if(k==="3m"||k==="6m"||k==="1y"){const o=new Date(r);return k==="3m"?o.setMonth(o.getMonth()-3):k==="6m"?o.setMonth(o.getMonth()-6):o.setFullYear(o.getFullYear()-1),t.filter(n=>new Date(n.date)>=o)}if(k==="custom"){if(!H&&!z)return t;const o=H?new Date(H):null,n=z?new Date(z):null;return t.filter(i=>{const N=new Date(i.date);if(o&&N<o)return!1;if(n){const f=new Date(n);if(f.setHours(23,59,59,999),N>f)return!1}return!0})}return t},[b,k,H,z]),Le=Math.max((y.length||0)*56,320),V=a.useMemo(()=>{if(!b||y.length===0)return null;const t=y.map(i=>i.weight),r=y.length,o=Math.max(...t),n=Math.min(...t);return{totalSessions:r,maxWeight:o,minWeight:n}},[b,y]),We=a.useMemo(()=>{if(!y||y.length<=1)return"—";const t=y[0].weight,r=y[y.length-1].weight;if(t<=0)return"—";const o=(r-t)/t*100;return`${o>0?"+":""}${o.toFixed(1)}%`},[y]),me=a.useMemo(()=>{const t=[...M];switch(_){case"lastAdded":return t.sort((r,o)=>!r.lastSetDate&&!o.lastSetDate?r.name.localeCompare(o.name,"ru"):r.lastSetDate?o.lastSetDate?o.lastSetDate.localeCompare(r.lastSetDate):-1:1);case"mostFrequent":return t.sort((r,o)=>o.totalSets!==r.totalSets?o.totalSets-r.totalSets:r.name.localeCompare(o.name,"ru"));case"alphabetical":default:return t.sort((r,o)=>r.name.localeCompare(o.name,"ru"))}},[M,_]),ge=O.trim()?me.filter(t=>Q(t.name).includes(Q(O))):me;return C&&p==="exercises"?e.jsx(Fe,{message:s.progress.loading}):e.jsxs("div",{className:"p-4 max-w-4xl mx-auto pb-4",children:[e.jsxs("div",{className:`mb-6 glass card-dark p-4 flex items-center gap-4 header-container ${ae?"scrolling":""}`,children:[e.jsx("button",{onClick:_e,className:"shrink-0 inline-flex items-center justify-center p-2 rounded-full border border-transparent text-white bg-transparent transition-colors focus:outline-hidden active:outline-hidden back-button-plain","aria-label":s.common.back,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h1",{className:"flex-1 text-xl font-bold text-center",children:p==="exercises"?h||s.progress.title:s.progress.cardio}),p==="cardio"&&e.jsx("button",{onClick:()=>oe(!0),className:"shrink-0 inline-flex items-center justify-center w-8 h-8 rounded-full text-white bg-white/10 hover:bg-white/20 transition-colors","aria-label":S==="ru"?"Информация о кардио":"Cardio info",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),!h&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>v("exercises"),className:`flex-1 py-2.5 px-4 rounded-xl font-medium transition-all ${p==="exercises"?"bg-blue-500/30 text-white border border-blue-400/40":"bg-white/5 text-gray-400 border border-white/10 hover:bg-white/10"}`,children:s.progress.exercises}),e.jsx("button",{onClick:()=>v("cardio"),className:`flex-1 py-2.5 px-4 rounded-xl font-medium transition-all ${p==="cardio"?"bg-green-500/30 text-white border border-green-400/40":"bg-white/5 text-gray-400 border border-white/10 hover:bg-white/10"}`,children:s.progress.cardio})]}),!h&&p==="exercises"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1 glass card-dark rounded-full px-4 py-3 search-container",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-5 w-5 text-gray-400",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-4.35-4.35m0 0A7.5 7.5 0 103.5 10.5a7.5 7.5 0 0013.15 6.15z"})}),e.jsx("input",{ref:J,type:"text",value:O,onChange:t=>Z(t.target.value),placeholder:s.progress.search,"aria-label":s.progress.search,className:"flex-1 bg-transparent border-0 outline-hidden ring-0 focus:outline-hidden focus:ring-0 appearance-none text-white placeholder-white/60 text-base shadow-none search-input"}),e.jsx("button",{type:"button",onClick:()=>{var t;Z(""),(t=J.current)==null||t.focus()},"aria-label":s.common.clear,"aria-hidden":!O,className:`shrink-0 w-7 h-7 grid place-items-center rounded-full text-gray-400 hover:text-gray-200 hover:bg-white/10 transition ${O?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6l12 12M18 6L6 18"})})})]})}),e.jsxs("div",{ref:I,className:"relative flex items-center",children:[e.jsx("button",{type:"button",onClick:()=>W(!D),className:"w-11 h-11 grid place-items-center rounded-full bg-transparent hover:bg-white/10 active:bg-white/10 transition-colors leading-none","aria-label":s.progress.sort.label,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-7 w-7 text-gray-400 block",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"})})}),D&&e.jsx("div",{className:"absolute top-full right-0 mt-2 w-56 rounded-lg shadow-lg border border-white/10 z-50 progress-dropdown-menu",children:[{id:"alphabetical",label:s.progress.sort.alphabetical},{id:"lastAdded",label:s.progress.sort.lastAdded},{id:"mostFrequent",label:s.progress.sort.mostFrequent}].map(t=>e.jsx("button",{onClick:()=>{T(t.id),W(!1)},className:`w-full text-left px-4 py-2.5 text-sm transition-colors border-b border-white/5 last:border-0 ${_===t.id?"bg-blue-500/20 text-blue-400":"text-gray-200 hover:bg-white/10"}`,children:t.label},t.id))})]})]}),M.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:s.progress.noData}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:s.progress.noDataHint})]}):ge.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:s.progress.notFound}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:s.progress.notFoundHint})]}):ge.map(t=>e.jsx("button",{onClick:()=>De(t.name),className:"w-full glass card-dark p-4 rounded-lg hover:bg-white/5 transition-colors text-left",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[s.progress.totalSets,t.totalSets]})]}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},t.name))]}),p==="cardio"&&!h&&e.jsx("div",{className:"space-y-4",children:U?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center",style:{background:"transparent"},children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"relative w-12 h-12",children:e.jsx("div",{className:"absolute inset-0 border-4 border-transparent border-t-green-500 border-r-green-500 rounded-full animate-spin"})}),e.jsx("p",{className:"text-white text-center",children:s.cardio.loading})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.cardio.weeklyGoal}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>m(Math.max(1,l-1)),className:"w-8 h-8 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors flex items-center justify-center",disabled:l<=1,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),e.jsx("span",{className:"text-2xl font-bold text-green-400 w-8 text-center",children:l}),e.jsx("button",{onClick:()=>m(Math.min(7,l+1)),className:"w-8 h-8 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors flex items-center justify-center",disabled:l>=7,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}),e.jsx("p",{className:"text-sm text-gray-400",children:s.cardio.workoutsPerWeek.replace("{count}",String(l))})]}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:s.cardio.monthlyStats}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-center mb-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-white/5",children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:Me}),e.jsx("p",{className:"text-xs text-gray-400",children:s.cardio.thisMonth})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-white/5",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:x.length}),e.jsx("p",{className:"text-xs text-gray-400",children:s.cardio.totalCardio})]})]}),re.length>0&&e.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:re.map(t=>e.jsxs("div",{onClick:()=>ce(t.month),className:`flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors ${t.month===$?"bg-green-500/20 border border-green-500/30":"bg-white/5 hover:bg-white/10"}`,children:[e.jsx("span",{className:"text-sm text-gray-300",children:t.monthLabel}),e.jsx("span",{className:"text-lg font-bold text-white",children:t.count})]},t.month))})]}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.cardio.weeklyProgress}),e.jsxs("div",{ref:B,className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>g(!c),className:"flex items-center justify-between gap-2 bg-white/10 border border-white/20 rounded-lg px-3 py-1.5 text-sm text-white hover:bg-white/15 transition-colors min-w-[160px] progress-dropdown-btn",children:[e.jsx("span",{children:((pe=he.find(t=>t.value===$))==null?void 0:pe.label)||s.cardio.selectMonth}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 text-gray-400 transition-transform ${c?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),c&&e.jsx("div",{className:"absolute top-full right-0 mt-1 w-full min-w-[160px] max-h-60 overflow-y-auto rounded-lg shadow-lg border border-white/10 z-50 progress-dropdown-menu",children:he.map(t=>e.jsx("button",{onClick:()=>{ce(t.value),g(!1)},className:`w-full text-left px-4 py-2.5 text-sm transition-colors border-b border-white/5 last:border-0 ${$===t.value?"bg-green-500/20 text-green-400":"text-gray-200 hover:bg-white/10"}`,children:t.label},t.value))})]})]}),e.jsx("div",{className:"space-y-3",children:ue.length===0?e.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:s.cardio.noDataForMonth}):ue.map((t,r)=>{const o=Math.min(t.count/t.goal*100,100),n=t.count>=t.goal;return e.jsxs("div",{className:`p-3 rounded-lg ${t.isCurrentWeek?"bg-green-500/10 border border-green-500/30":"bg-white/5"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:`text-sm ${t.isCurrentWeek?"text-green-300 font-medium":"text-gray-300"}`,children:[t.weekLabel,t.isCurrentWeek&&` (${S==="ru"?"текущая":"current"})`]}),e.jsxs("span",{className:`text-sm font-bold ${n?"text-green-400":"text-gray-400"}`,children:[t.count," / ",t.goal]})]}),e.jsx("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-500 rounded-full ${n?"bg-linear-to-r from-green-500 to-green-400":"bg-linear-to-r from-blue-500 to-blue-400"}`,style:{width:`${o}%`}})}),!n&&t.isCurrentWeek&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[S==="ru"?"Осталось":"Remaining",": ",t.goal-t.count," ",S==="ru"?Xe(t.goal-t.count,"тренировка","тренировки","тренировок"):t.goal-t.count===1?"workout":"workouts"]})]},r)})})]})]})}),le&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onClick:()=>oe(!1),children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-xs"}),e.jsxs("div",{className:"relative glass card-dark p-5 rounded-2xl max-w-md w-full max-h-[80vh]",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>oe(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 transition-colors flex items-center justify-center","aria-label":s.common.close,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-xl font-bold text-white pr-10",children:s.cardio.aboutCardio}),e.jsxs("div",{className:"mt-4 space-y-4 text-sm text-gray-300 max-h-[60vh] overflow-y-auto pr-1",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:s.cardio.whatIsCardio}),e.jsx("p",{children:s.cardio.whatIsCardioDesc})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:s.cardio.howOften}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.cardio.howOftenItems.map((t,r)=>e.jsx("li",{children:t},r))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:s.cardio.targetHeartRate}),e.jsx("p",{children:s.cardio.targetHeartRateDesc})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:s.cardio.cardioTypes}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.cardio.cardioTypesItems.map((t,r)=>e.jsxs("li",{children:[e.jsx("b",{children:t.name})," — ",t.desc]},r))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:s.cardio.benefits}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.cardio.benefitsItems.map((t,r)=>e.jsx("li",{children:t},r))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:s.cardio.whenToDo}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.cardio.whenToDoItems.map((t,r)=>e.jsx("li",{children:t},r))})]}),e.jsxs("div",{className:"cardio-warning p-3 rounded-lg bg-yellow-500/10 border border-yellow-500/30",children:[e.jsxs("h3",{className:"cardio-warning-title text-yellow-400 font-semibold mb-2",children:["⚠️ ",s.cardio.warning]}),e.jsx("p",{className:"cardio-warning-text text-yellow-200/80",children:s.cardio.warningText})]})]})]})]}),h&&e.jsx("div",{className:"space-y-4",children:E?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"relative w-12 h-12",children:e.jsx("div",{className:"absolute inset-0 border-4 border-transparent border-t-blue-500 border-r-blue-500 rounded-full animate-spin"})}),e.jsx("p",{className:"text-white text-center",children:s.progress.loading})]})}):b&&b.dataPoints.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"glass card-dark p-4 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:(V==null?void 0:V.totalSessions)??0}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.progress.stats.sessions})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:V?`${V.maxWeight} ${s.common.kg}`:"—"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.progress.stats.maxWeight})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:We}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.progress.stats.growth})]})]})}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsxs("div",{className:"flex flex-col gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:S==="ru"?"Динамика веса":"Weight progress"}),e.jsxs("div",{ref:j,className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>K(!P),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-white/5 border border-white/15 text-xs text-gray-200 hover:bg-white/10 hover:border-white/25 transition-colors progress-dropdown-btn",children:[e.jsx("span",{className:"hidden sm:inline text-gray-400",children:S==="ru"?"Период:":"Period:"}),e.jsx("span",{className:"font-medium",children:Ee}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-3 w-3 transition-transform ${P?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})]}),P&&e.jsx("div",{className:"absolute top-full right-0 mt-1 w-48 rounded-lg shadow-lg border border-white/10 z-50 overflow-hidden progress-dropdown-menu",children:xe.map(t=>e.jsx("button",{type:"button",onClick:()=>{ee(t.id),K(!1)},className:`w-full text-left px-3 py-2 text-xs transition-colors ${k===t.id?"bg-white/15 text-white font-medium":"text-gray-300 hover:bg-white/8"}`,children:t.label},t.id))})]})]}),k==="custom"&&e.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 text-xs text-gray-300 flex-wrap text-center",children:[e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"с"}),e.jsx("input",{type:"date",value:H??"",onChange:t=>te(t.target.value||null),className:"bg-transparent border border-white/20 rounded px-2 py-1 text-xs text-white focus:outline-hidden focus:ring-0 focus:border-blue-400/80"})]}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"по"}),e.jsx("input",{type:"date",value:z??"",onChange:t=>A(t.target.value||null),className:"bg-transparent border border-white/20 rounded px-2 py-1 text-xs text-white focus:outline-hidden focus:ring-0 focus:border-blue-400/80"})]})]})]}),y.length===0?e.jsx("div",{className:"pt-6 pb-3 text-sm text-gray-400 text-center",children:S==="ru"?"Нет данных за выбранный период":"No data for selected period"}):e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 pb-2",children:e.jsx("div",{style:{minWidth:`${Le}px`},children:e.jsx(Ye,{width:"100%",height:300,children:e.jsxs(Ge,{data:y,margin:{top:24,right:10,left:0,bottom:5},children:[e.jsx(qe,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),e.jsx(Qe,{dataKey:"displayDate",stroke:"rgba(255,255,255,0.5)",style:{fontSize:"12px"}}),e.jsx(Je,{stroke:"rgba(255,255,255,0.5)",style:{fontSize:"12px"},label:{value:`${s.exercise.weight}`,angle:-90,position:"insideLeft",fill:"rgba(255,255,255,0.7)",dx:8}}),e.jsx(Ke,{content:e.jsx(Ze,{})}),e.jsx(Ue,{type:"monotone",dataKey:"weight",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",r:4},activeDot:{r:6}})]})})})})]}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:s.progress.history}),y.length===0?e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.progress.noData}):e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:y.slice().reverse().map((t,r)=>e.jsxs("div",{onClick:()=>Ce(t),className:"flex items-center justify-between p-3 rounded-lg bg-white/5 hover:bg-white/10 transition-colors cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:new Date(t.date).toLocaleDateString("ru")}),e.jsx("p",{className:"text-sm text-gray-400",children:t.workoutName})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-bold text-white",children:[t.weight," ",s.common.kg]}),e.jsxs("p",{className:"text-sm text-gray-400",children:[t.reps||"?"," ",s.exercise.reps.toLowerCase()]})]})]},r))})]})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-400",children:s.progress.noData})})})]})};export{ct as default};
