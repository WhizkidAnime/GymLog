import{u as we,s as T,g as ge,a as Le,j as e,W as We}from"./index-CLP7Nca7.js";import{r,e as $e}from"./vendor-BVca5W6X.js";import{n as q,p as Ie}from"./exercise-name-BJxyXXn3.js";import{u as Re}from"./use-header-scroll-Cg2zr4na.js";import{u as Pe}from"./use-scroll-restoration-CZtb4aM8.js";import{u as Te}from"./use-modal-scroll-lock-DlG-D3y9.js";import{u as fe}from"./usePageState-6XNG0ilq.js";import{R as Oe,L as Fe,C as He,X as Ye,Y as ze,T as Be,a as Ge}from"./charts-33RH-A39.js";import"./supabase-CWpvgLJU.js";function Ae(){const{user:h}=we(),d=r.useRef(null),s=r.useRef(new Map),N=300*1e3,M=r.useRef(!1),_=r.useRef(void 0),[b,W]=fe({key:"progress-page:exercises",initialState:{loaded:!1,exercises:[]},ttl:600*1e3}),[O,u]=r.useState(()=>!b.loaded),[V,E]=r.useState(null),[B,Q]=r.useState(!1),[se,j]=fe({key:"progress-page",initialState:{searchQuery:"",selectedExercise:null},ttl:1800*1e3}),{searchQuery:X,selectedExercise:F}=se,Z=l=>{j(x=>({...x,searchQuery:l}))},H=l=>{j(x=>({...x,selectedExercise:l}))},Y=r.useCallback(async()=>{if(!h)return[];if(d.current)return d.current;const{data:l,error:x}=await T.from("workouts").select("id").eq("user_id",h.id);if(x)throw x;const S=(l||[]).map(L=>L.id);return d.current=S,S},[h]),R=r.useCallback(async(l=!1)=>{if(h){l||u(!0);try{const x=await Y();if(x.length===0){W({loaded:!0,exercises:[]});return}const{data:S,error:L}=await T.from("exercise_progress_view").select("workout_id, exercise_id, max_weight").in("workout_id",x);if(L)throw L;const c=new Map;if((S||[]).forEach(v=>{const g=v.exercise_id,f=v.max_weight||0;if(!g||f<=0)return;const D=c.get(g)||0;c.set(g,D+1)}),c.size===0){W({loaded:!0,exercises:[]});return}const{data:G,error:p}=await T.from("workout_exercises").select("id, name").in("id",Array.from(c.keys()));if(p)throw p;const $=q,C=new Map;(G||[]).forEach(v=>{const g=(v.name??"").trim();if(!g)return;const f=$(g),D=c.get(v.id)||0;if(D<=0)return;const y=C.get(f);y?C.set(f,{name:y.name.length>=g.length?y.name:g,total:y.total+D}):C.set(f,{name:g,total:D})});const P=Array.from(C.values()).map(({name:v,total:g})=>({name:v,totalSets:g})).sort((v,g)=>v.name.localeCompare(g.name,"ru"));W({loaded:!0,exercises:P})}catch(x){console.error("Error fetching progress exercises:",x),l||(alert(ge().hooks.failedToLoadExercises),W({loaded:!0,exercises:[]}))}finally{l||u(!1)}}},[h,Y,W]),J=r.useCallback(async l=>{if(!h||!l){E(null);return}const x=q(l),S=s.current.get(x),L=Date.now();if(S&&L-S.ts<N){E(S.data);return}Q(!0);try{const c=await Y();if(c.length===0){E({exerciseName:l,dataPoints:[],totalSessions:0,maxWeight:0,minWeight:0}),s.current.set(x,{data:{exerciseName:l,dataPoints:[],totalSessions:0,maxWeight:0,minWeight:0},ts:Date.now()});return}const{data:G,error:p}=await T.from("workout_exercises").select("id, name, workout_id").in("workout_id",c);if(p)throw p;const $=new Set;if((G||[]).forEach(f=>{const D=(f.name??"").trim();D&&q(D)===x&&$.add(f.id)}),$.size===0){E({exerciseName:l,dataPoints:[],totalSessions:0,maxWeight:0,minWeight:0});return}const{data:C,error:P}=await T.from("exercise_progress_view").select("workout_date, workout_name, workout_id, exercise_id, max_weight, reps_at_max_weight").in("workout_id",c).in("exercise_id",Array.from($));if(P)throw P;const v=(C||[]).map(f=>({workout_date:f.workout_date,workout_name:f.workout_name,workout_id:f.workout_id,exercise_id:f.exercise_id,max_weight:f.max_weight,reps_at_max_weight:f.reps_at_max_weight})),g=Ie(l,v);E(g),s.current.set(x,{data:g,ts:Date.now()})}catch(c){console.error("Error loading progress data:",c),alert(ge().hooks.failedToLoadProgress),E(null)}finally{Q(!1)}},[h,Y,N]);return r.useEffect(()=>{h&&(M.current||(M.current=!0,R(b.loaded)))},[R,b.loaded,h]),r.useEffect(()=>{const l=h==null?void 0:h.id;if(_.current===void 0){_.current=l;return}_.current!==l&&(_.current=l,d.current=null,s.current.clear(),M.current=!1,W({loaded:!1,exercises:[]}),u(!0))},[h==null?void 0:h.id,W]),{exercises:b.exercises,loading:O,progressData:V,loadingProgress:B,searchQuery:X,selectedExercise:F,setSearchQuery:Z,setSelectedExercise:H,loadProgress:J}}function qe(h,d,s,N){const M=Math.abs(h),_=M%10,b=M%100;return b>=11&&b<=19?N:_===1?d:_>=2&&_<=4?s:N}const pe=T,Qe=({active:h,payload:d})=>{if(!h||!(d!=null&&d[0]))return null;const s=d[0].payload;return e.jsxs("div",{className:"glass card-dark p-3 rounded-lg shadow-lg border border-white/20",children:[e.jsx("p",{className:"text-sm text-gray-300 mb-1",children:s.workoutName}),e.jsxs("p",{className:"text-base font-bold text-white",children:[s.weight," kg × ",s.reps||"?"]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(s.date).toLocaleDateString()})]})},rt=()=>{var de,he;const h=$e(),{user:d}=we(),{t:s,language:N}=Le(),{exercises:M,loading:_,progressData:b,loadingProgress:W,searchQuery:O,selectedExercise:u,setSearchQuery:V,setSelectedExercise:E,loadProgress:B}=Ae(),Q=r.useRef(null),se=Re(),[j,X]=r.useState("all"),[F,Z]=r.useState(null),[H,Y]=r.useState(null),[R,J]=r.useState(!1),[l,x]=r.useState(!1),S=r.useRef(null),L=r.useRef(null),[c,G]=r.useState(()=>{try{return localStorage.getItem("progress:activeTab")||"exercises"}catch{return"exercises"}}),[p,$]=r.useState(3),[C,P]=r.useState([]),[v,g]=r.useState(!1),[f,D]=r.useState(!1),[y,oe]=r.useState(()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`}),A="progress:cardioCache",ee=1800*1e3,ae=r.useRef(!1);Te(f);const be=r.useCallback(()=>u?`scroll:progress-page:detail:${q(u||"")}`:"scroll:progress-page:list",[u]),je=t=>{E(t),B(t)},ve=t=>{h(`/workout/${t.date}`,{state:{focusExerciseId:t.exerciseId}})},ye=()=>{u?(E(null),B(null)):h("/profile")};Pe({key:be(),enabled:!_&&(!u||!W&&!!b)}),r.useEffect(()=>{try{const t="progress:lastSelectedExercise";u?localStorage.setItem(t,u):localStorage.removeItem(t)}catch{}},[u]),r.useEffect(()=>{if(!u)try{const t=localStorage.getItem("progress:lastSelectedExercise");t&&E(t)}catch{}},[]),r.useEffect(()=>{u&&B(u)},[u,B]),r.useEffect(()=>{X("all"),Z(null),Y(null)},[u]),r.useEffect(()=>{const t=a=>{S.current&&!S.current.contains(a.target)&&J(!1),L.current&&!L.current.contains(a.target)&&x(!1)};if(R||l)return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[R,l]),r.useEffect(()=>{try{localStorage.setItem("progress:activeTab",c)}catch{}},[c]),r.useEffect(()=>{if(!d)return;let t=!1;return(async()=>{var n;try{const{data:o,error:i}=await pe.from("user_settings").select("cardio_weekly_goal").eq("user_id",d.id).limit(1);if(i){console.error("Error loading cardio goal:",i);return}!t&&o&&o.length>0&&typeof((n=o[0])==null?void 0:n.cardio_weekly_goal)=="number"&&$(o[0].cardio_weekly_goal)}catch(o){console.error("Error loading cardio goal:",o)}finally{t||(ae.current=!0)}})(),()=>{t=!0}},[d]),r.useEffect(()=>{if(!d||!ae.current)return;(async()=>{try{const{error:a}=await pe.from("user_settings").upsert({user_id:d.id,cardio_weekly_goal:p},{onConflict:"user_id"});a&&console.error("Error saving cardio goal:",a)}catch(a){console.error("Error saving cardio goal:",a)}})()},[p,d]),r.useEffect(()=>{if(c!=="cardio"||!d)return;const t=()=>{try{const i=localStorage.getItem(A);if(!i)return null;const k=JSON.parse(i);return Date.now()-(k.timestamp||0)>ee?null:k.data||null}catch{return null}},a=i=>{try{localStorage.setItem(A,JSON.stringify({data:i,timestamp:Date.now()}))}catch{}},n=async(i=!1)=>{i||g(!0);try{const{data:k,error:m}=await T.from("workouts").select("workout_date").eq("user_id",d.id).eq("is_cardio",!0).order("workout_date",{ascending:!1});if(m)throw m;const U=k||[];P(U),a(U)}catch(k){console.error("Error fetching cardio workouts:",k)}finally{i||g(!1)}},o=t();if(o){P(o),n(!0);return}n(!1)},[c,d,A,ee]),r.useEffect(()=>{const t=()=>{if(document.visibilityState!=="visible"||c!=="cardio"||!d)return;const a=localStorage.getItem(A);let n=!0;if(a)try{const o=JSON.parse(a);n=Date.now()-(o.timestamp||0)>ee}catch{n=!0}n&&(async()=>{try{const{data:o,error:i}=await T.from("workouts").select("workout_date").eq("user_id",d.id).eq("is_cardio",!0).order("workout_date",{ascending:!1});!i&&o&&(P(o),localStorage.setItem(A,JSON.stringify({data:o,timestamp:Date.now()})))}catch{}})()};return document.addEventListener("visibilitychange",t),()=>document.removeEventListener("visibilitychange",t)},[c,d,A,ee]);const ne=r.useMemo(()=>{if(!y)return[];const[t,a]=y.split("-").map(Number),n=new Date(t,a-1,1),o=new Date(t,a,0);n.setHours(0,0,0,0),o.setHours(23,59,59,999);const i=new Date;i.setHours(0,0,0,0);const k=[];let m=new Date(n);const U=m.getDay(),De=U===0?-6:1-U;for(m.setDate(m.getDate()+De);m<=o||m.getMonth()===a-1||m.getMonth()===a-2&&m.getDate()>20;){const z=new Date(m),I=new Date(m);if(z.setHours(0,0,0,0),I.setDate(I.getDate()+6),I.setHours(23,59,59,999),I>=n&&z<=o){const _e=C.filter(Ee=>{const[ue,xe,me]=Ee.workout_date.split("-").map(Number);if(!ue||!xe||!me)return!1;const re=new Date(ue,xe-1,me);return re.setHours(12,0,0,0),re>=z&&re<=I}).length,Me=i>=z&&i<=I;k.push({weekStart:z.toISOString().slice(0,10),weekEnd:I.toISOString().slice(0,10),weekLabel:`${z.getDate()}.${String(z.getMonth()+1).padStart(2,"0")} - ${I.getDate()}.${String(I.getMonth()+1).padStart(2,"0")}`,count:_e,goal:p,isCurrentWeek:Me})}if(m.setDate(m.getDate()+7),m>o&&m.getMonth()!==a-1)break}return k},[y,C,p]),te=r.useMemo(()=>{const t={},a=s.cardio.monthsShort;return C.forEach(n=>{const o=new Date(n.workout_date),i=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`;t[i]||(t[i]={month:i,year:o.getFullYear(),count:0,monthLabel:`${a[o.getMonth()]} ${o.getFullYear()}`}),t[i].count++}),Object.values(t).sort((n,o)=>o.month.localeCompare(n.month))},[C]),ie=r.useMemo(()=>{const t=[],a=s.cardio.months,n=new Date;for(let o=0;o<12;o++){const i=new Date(n.getFullYear(),n.getMonth()-o,1),k=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`;t.push({value:k,label:`${a[i.getMonth()]} ${i.getFullYear()}`})}return t},[]),ke=r.useMemo(()=>{var t;return y&&((t=te.find(a=>a.month===y))==null?void 0:t.count)||0},[y,te]),le=[{id:"all",label:s.progress.period.all},{id:"3m",label:s.progress.period.threeMonths},{id:"6m",label:s.progress.period.sixMonths},{id:"1y",label:s.progress.period.oneYear},{id:"custom",label:s.progress.period.custom}],Ne=((de=le.find(t=>t.id===j))==null?void 0:de.label)||"Выбрать",w=r.useMemo(()=>{if(!b)return[];const t=b.dataPoints;if(j==="all")return t;const a=new Date;if(j==="3m"||j==="6m"||j==="1y"){const n=new Date(a);return j==="3m"?n.setMonth(n.getMonth()-3):j==="6m"?n.setMonth(n.getMonth()-6):n.setFullYear(n.getFullYear()-1),t.filter(o=>new Date(o.date)>=n)}if(j==="custom"){if(!F&&!H)return t;const n=F?new Date(F):null,o=H?new Date(H):null;return t.filter(i=>{const k=new Date(i.date);if(n&&k<n)return!1;if(o){const m=new Date(o);if(m.setHours(23,59,59,999),k>m)return!1}return!0})}return t},[b,j,F,H]),Ce=Math.max((w.length||0)*56,320),K=r.useMemo(()=>{if(!b||w.length===0)return null;const t=w.map(i=>i.weight),a=w.length,n=Math.max(...t),o=Math.min(...t);return{totalSessions:a,maxWeight:n,minWeight:o}},[b,w]),Se=r.useMemo(()=>{if(!w||w.length<=1)return"—";const t=w[0].weight,a=w[w.length-1].weight;if(t<=0)return"—";const n=(a-t)/t*100;return`${n>0?"+":""}${n.toFixed(1)}%`},[w]),ce=O.trim()?M.filter(t=>q(t.name).includes(q(O))):M;return _&&c==="exercises"?e.jsx(We,{message:s.progress.loading}):e.jsxs("div",{className:"p-4 max-w-4xl mx-auto pt-safe pb-4",children:[e.jsxs("div",{className:`mb-6 glass card-dark p-4 flex items-center gap-4 header-container ${se?"scrolling":""}`,children:[e.jsx("button",{onClick:ye,className:"shrink-0 inline-flex items-center justify-center p-2 rounded-full border border-transparent text-white bg-transparent transition-colors focus:outline-none active:outline-none back-button-plain","aria-label":s.common.back,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h1",{className:"flex-1 text-xl font-bold text-center",children:c==="exercises"?u||s.progress.title:s.progress.cardio}),c==="cardio"&&e.jsx("button",{onClick:()=>D(!0),className:"shrink-0 inline-flex items-center justify-center w-8 h-8 rounded-full text-white bg-white/10 hover:bg-white/20 transition-colors","aria-label":N==="ru"?"Информация о кардио":"Cardio info",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),!u&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>G("exercises"),className:`flex-1 py-2.5 px-4 rounded-xl font-medium transition-all ${c==="exercises"?"bg-blue-500/30 text-white border border-blue-400/40":"bg-white/5 text-gray-400 border border-white/10 hover:bg-white/10"}`,children:s.progress.exercises}),e.jsx("button",{onClick:()=>G("cardio"),className:`flex-1 py-2.5 px-4 rounded-xl font-medium transition-all ${c==="cardio"?"bg-green-500/30 text-white border border-green-400/40":"bg-white/5 text-gray-400 border border-white/10 hover:bg-white/10"}`,children:s.progress.cardio})]}),!u&&c==="exercises"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"glass card-dark rounded-full px-4 py-3 search-container",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-5 w-5 text-gray-400",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-4.35-4.35m0 0A7.5 7.5 0 103.5 10.5a7.5 7.5 0 0013.15 6.15z"})}),e.jsx("input",{ref:Q,type:"text",value:O,onChange:t=>V(t.target.value),placeholder:s.progress.search,"aria-label":s.progress.search,className:"flex-1 bg-transparent border-0 outline-none ring-0 focus:outline-none focus:ring-0 appearance-none text-white placeholder-white/60 text-base shadow-none search-input"}),e.jsx("button",{type:"button",onClick:()=>{var t;V(""),(t=Q.current)==null||t.focus()},"aria-label":s.common.clear,"aria-hidden":!O,className:`shrink-0 w-7 h-7 grid place-items-center rounded-full text-gray-400 hover:text-gray-200 hover:bg-white/10 transition ${O?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6l12 12M18 6L6 18"})})})]})}),M.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:s.progress.noData}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:s.progress.noDataHint})]}):ce.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:s.progress.notFound}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:s.progress.notFoundHint})]}):ce.map(t=>e.jsx("button",{onClick:()=>je(t.name),className:"w-full glass card-dark p-4 rounded-lg hover:bg-white/5 transition-colors text-left",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[s.progress.totalSets,t.totalSets]})]}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},t.name))]}),c==="cardio"&&!u&&e.jsx("div",{className:"space-y-4",children:v?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center",style:{background:"transparent"},children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"relative w-12 h-12",children:e.jsx("div",{className:"absolute inset-0 border-4 border-transparent border-t-green-500 border-r-green-500 rounded-full animate-spin"})}),e.jsx("p",{className:"text-white text-center",children:s.cardio.loading})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.cardio.weeklyGoal}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>$(Math.max(1,p-1)),className:"w-8 h-8 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors flex items-center justify-center",disabled:p<=1,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),e.jsx("span",{className:"text-2xl font-bold text-green-400 w-8 text-center",children:p}),e.jsx("button",{onClick:()=>$(Math.min(7,p+1)),className:"w-8 h-8 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors flex items-center justify-center",disabled:p>=7,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}),e.jsx("p",{className:"text-sm text-gray-400",children:s.cardio.workoutsPerWeek.replace("{count}",String(p))})]}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:s.cardio.monthlyStats}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-center mb-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-white/5",children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:ke}),e.jsx("p",{className:"text-xs text-gray-400",children:s.cardio.thisMonth})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-white/5",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:C.length}),e.jsx("p",{className:"text-xs text-gray-400",children:s.cardio.totalCardio})]})]}),te.length>0&&e.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:te.map(t=>e.jsxs("div",{onClick:()=>oe(t.month),className:`flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors ${t.month===y?"bg-green-500/20 border border-green-500/30":"bg-white/5 hover:bg-white/10"}`,children:[e.jsx("span",{className:"text-sm text-gray-300",children:t.monthLabel}),e.jsx("span",{className:"text-lg font-bold text-white",children:t.count})]},t.month))})]}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.cardio.weeklyProgress}),e.jsxs("div",{ref:L,className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>x(!l),className:"flex items-center justify-between gap-2 bg-white/10 border border-white/20 rounded-lg px-3 py-1.5 text-sm text-white hover:bg-white/15 transition-colors min-w-[160px] progress-dropdown-btn",children:[e.jsx("span",{children:((he=ie.find(t=>t.value===y))==null?void 0:he.label)||s.cardio.selectMonth}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 text-gray-400 transition-transform ${l?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),l&&e.jsx("div",{className:"absolute top-full right-0 mt-1 w-full min-w-[160px] max-h-60 overflow-y-auto rounded-lg shadow-lg border border-white/10 z-50 progress-dropdown-menu",children:ie.map(t=>e.jsx("button",{onClick:()=>{oe(t.value),x(!1)},className:`w-full text-left px-4 py-2.5 text-sm transition-colors border-b border-white/5 last:border-0 ${y===t.value?"bg-green-500/20 text-green-400":"text-gray-200 hover:bg-white/10"}`,children:t.label},t.value))})]})]}),e.jsx("div",{className:"space-y-3",children:ne.length===0?e.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:s.cardio.noDataForMonth}):ne.map((t,a)=>{const n=Math.min(t.count/t.goal*100,100),o=t.count>=t.goal;return e.jsxs("div",{className:`p-3 rounded-lg ${t.isCurrentWeek?"bg-green-500/10 border border-green-500/30":"bg-white/5"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:`text-sm ${t.isCurrentWeek?"text-green-300 font-medium":"text-gray-300"}`,children:[t.weekLabel,t.isCurrentWeek&&` (${N==="ru"?"текущая":"current"})`]}),e.jsxs("span",{className:`text-sm font-bold ${o?"text-green-400":"text-gray-400"}`,children:[t.count," / ",t.goal]})]}),e.jsx("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-500 rounded-full ${o?"bg-gradient-to-r from-green-500 to-green-400":"bg-gradient-to-r from-blue-500 to-blue-400"}`,style:{width:`${n}%`}})}),!o&&t.isCurrentWeek&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[N==="ru"?"Осталось":"Remaining",": ",t.goal-t.count," ",N==="ru"?qe(t.goal-t.count,"тренировка","тренировки","тренировок"):t.goal-t.count===1?"workout":"workouts"]})]},a)})})]})]})}),f&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onClick:()=>D(!1),children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),e.jsxs("div",{className:"relative glass card-dark p-5 rounded-2xl max-w-md w-full max-h-[80vh]",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>D(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 transition-colors flex items-center justify-center","aria-label":s.common.close,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-xl font-bold text-white pr-10",children:s.cardio.aboutCardio}),e.jsxs("div",{className:"mt-4 space-y-4 text-sm text-gray-300 max-h-[60vh] overflow-y-auto pr-1",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:s.cardio.whatIsCardio}),e.jsx("p",{children:s.cardio.whatIsCardioDesc})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:s.cardio.howOften}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.cardio.howOftenItems.map((t,a)=>e.jsx("li",{children:t},a))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:s.cardio.targetHeartRate}),e.jsx("p",{children:s.cardio.targetHeartRateDesc})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:s.cardio.cardioTypes}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.cardio.cardioTypesItems.map((t,a)=>e.jsxs("li",{children:[e.jsx("b",{children:t.name})," — ",t.desc]},a))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:s.cardio.benefits}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.cardio.benefitsItems.map((t,a)=>e.jsx("li",{children:t},a))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:s.cardio.whenToDo}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.cardio.whenToDoItems.map((t,a)=>e.jsx("li",{children:t},a))})]}),e.jsxs("div",{className:"cardio-warning p-3 rounded-lg bg-yellow-500/10 border border-yellow-500/30",children:[e.jsxs("h3",{className:"cardio-warning-title text-yellow-400 font-semibold mb-2",children:["⚠️ ",s.cardio.warning]}),e.jsx("p",{className:"cardio-warning-text text-yellow-200/80",children:s.cardio.warningText})]})]})]})]}),u&&e.jsx("div",{className:"space-y-4",children:v?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center",style:{background:"transparent"},children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"relative w-12 h-12",children:e.jsx("div",{className:"absolute inset-0 border-4 border-transparent border-t-green-500 border-r-green-500 rounded-full animate-spin"})}),e.jsx("p",{className:"text-white text-center",children:s.cardio.loading})]})}):C.length===0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"glass card-dark p-4 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:(K==null?void 0:K.totalSessions)??0}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.progress.stats.sessions})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:K?`${K.maxWeight} ${s.common.kg}`:"—"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.progress.stats.maxWeight})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:Se}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.progress.stats.growth})]})]})}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsxs("div",{className:"flex flex-col gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:N==="ru"?"Динамика веса":"Weight progress"}),e.jsxs("div",{ref:S,className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>J(!R),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-white/5 border border-white/15 text-xs text-gray-200 hover:bg-white/10 hover:border-white/25 transition-colors progress-dropdown-btn",children:[e.jsx("span",{className:"hidden sm:inline text-gray-400",children:N==="ru"?"Период:":"Period:"}),e.jsx("span",{className:"font-medium",children:Ne}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-3 w-3 transition-transform ${R?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})]}),R&&e.jsx("div",{className:"absolute top-full right-0 mt-1 w-48 rounded-lg shadow-lg border border-white/10 z-50 overflow-hidden progress-dropdown-menu",children:le.map(t=>e.jsx("button",{type:"button",onClick:()=>{X(t.id),J(!1)},className:`w-full text-left px-3 py-2 text-xs transition-colors ${j===t.id?"bg-white/15 text-white font-medium":"text-gray-300 hover:bg-white/8"}`,children:t.label},t.id))})]})]}),j==="custom"&&e.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 text-xs text-gray-300 flex-wrap text-center",children:[e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"с"}),e.jsx("input",{type:"date",value:F??"",onChange:t=>Z(t.target.value||null),className:"bg-transparent border border-white/20 rounded px-2 py-1 text-xs text-white focus:outline-none focus:ring-0 focus:border-blue-400/80"})]}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"по"}),e.jsx("input",{type:"date",value:H??"",onChange:t=>Y(t.target.value||null),className:"bg-transparent border border-white/20 rounded px-2 py-1 text-xs text-white focus:outline-none focus:ring-0 focus:border-blue-400/80"})]})]})]}),w.length===0?e.jsx("div",{className:"pt-6 pb-3 text-sm text-gray-400 text-center",children:N==="ru"?"Нет данных за выбранный период":"No data for selected period"}):e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 pb-2",children:e.jsx("div",{style:{minWidth:`${Ce}px`},children:e.jsx(Oe,{width:"100%",height:300,children:e.jsxs(Fe,{data:w,margin:{top:24,right:10,left:0,bottom:5},children:[e.jsx(He,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),e.jsx(Ye,{dataKey:"displayDate",stroke:"rgba(255,255,255,0.5)",style:{fontSize:"12px"}}),e.jsx(ze,{stroke:"rgba(255,255,255,0.5)",style:{fontSize:"12px"},label:{value:`${s.exercise.weight}`,angle:-90,position:"insideLeft",fill:"rgba(255,255,255,0.7)",dx:8}}),e.jsx(Be,{content:e.jsx(Qe,{})}),e.jsx(Ge,{type:"monotone",dataKey:"weight",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",r:4},activeDot:{r:6}})]})})})})]}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:s.progress.history}),w.length===0?e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.progress.noData}):e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:w.slice().reverse().map((t,a)=>e.jsxs("div",{onClick:()=>ve(t),className:"flex items-center justify-between p-3 rounded-lg bg-white/5 hover:bg-white/10 transition-colors cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:new Date(t.date).toLocaleDateString("ru")}),e.jsx("p",{className:"text-sm text-gray-400",children:t.workoutName})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-bold text-white",children:[t.weight," ",s.common.kg]}),e.jsxs("p",{className:"text-sm text-gray-400",children:[t.reps||"?"," ",s.exercise.reps.toLowerCase()]})]})]},a))})]})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-400",children:s.progress.noData})})})]})};export{rt as default};
