import{u as ue,s as $,j as e}from"./index-B8MLy5R8.js";import{r as s,e as Ce}from"./vendor-BVca5W6X.js";import{n as Y,p as _e}from"./exercise-name-BJxyXXn3.js";import{u as Me}from"./use-header-scroll-Cg2zr4na.js";import{u as De}from"./use-scroll-restoration-CZtb4aM8.js";import{u as Ee}from"./use-modal-scroll-lock-DlG-D3y9.js";import{W as Le}from"./workout-loading-overlay-BMMIPtLN.js";import{u as We}from"./usePageState-6XNG0ilq.js";import{R as $e,L as Ie,C as Pe,X as Fe,Y as Re,T as Be,a as Oe}from"./charts-33RH-A39.js";import"./supabase-CWpvgLJU.js";function ze(){const{user:w}=ue(),[d,u]=s.useState([]),[I,b]=s.useState(!0),[L,f]=s.useState(null),[l,H]=s.useState(!1),[G,P]=We({key:"progress-page",initialState:{searchQuery:"",selectedExercise:null},ttl:1800*1e3}),{searchQuery:A,selectedExercise:X}=G,j=c=>{P(v=>({...v,searchQuery:c}))},Q=c=>{P(v=>({...v,selectedExercise:c}))},W=s.useCallback(async()=>{if(w){b(!0);try{const{data:c,error:v}=await $.from("workouts").select("id").eq("user_id",w.id);if(v)throw v;const N=(c||[]).map(x=>x.id);if(N.length===0){u([]);return}const{data:M,error:k}=await $.from("exercise_progress_view").select("workout_id, exercise_id, max_weight").in("workout_id",N);if(k)throw k;const y=new Map;if((M||[]).forEach(x=>{const o=x.exercise_id,_=x.max_weight||0;if(!o||_<=0)return;const R=y.get(o)||0;y.set(o,R+1)}),y.size===0){u([]);return}const{data:F,error:S}=await $.from("workout_exercises").select("id, name").in("id",Array.from(y.keys()));if(S)throw S;const m=Y,C=new Map;(F||[]).forEach(x=>{const o=(x.name??"").trim();if(!o)return;const _=m(o),R=y.get(x.id)||0;if(R<=0)return;const B=C.get(_);B?C.set(_,{name:B.name.length>=o.length?B.name:o,total:B.total+R}):C.set(_,{name:o,total:R})});const p=Array.from(C.values()).map(({name:x,total:o})=>({name:x,totalSets:o})).sort((x,o)=>x.name.localeCompare(o.name,"ru"));u(p)}catch(c){console.error("Error fetching progress exercises:",c),alert("Не удалось загрузить список упражнений"),u([])}finally{b(!1)}}},[w]),q=s.useCallback(async c=>{if(!w||!c){f(null);return}H(!0);try{const{data:v,error:N}=await $.from("workouts").select("id").eq("user_id",w.id);if(N)throw N;const M=(v||[]).map(o=>o.id);if(M.length===0){f({exerciseName:c,dataPoints:[],totalSessions:0,maxWeight:0,minWeight:0});return}const{data:k,error:y}=await $.from("workout_exercises").select("id, name, workout_id").in("workout_id",M);if(y)throw y;const F=Y(c),S=new Set;if((k||[]).forEach(o=>{const _=(o.name??"").trim();_&&Y(_)===F&&S.add(o.id)}),S.size===0){f({exerciseName:c,dataPoints:[],totalSessions:0,maxWeight:0,minWeight:0});return}const{data:m,error:C}=await $.from("exercise_progress_view").select("workout_date, workout_name, workout_id, exercise_id, max_weight, reps_at_max_weight").in("workout_id",M).in("exercise_id",Array.from(S));if(C)throw C;const p=(m||[]).map(o=>({workout_date:o.workout_date,workout_name:o.workout_name,workout_id:o.workout_id,exercise_id:o.exercise_id,max_weight:o.max_weight,reps_at_max_weight:o.reps_at_max_weight})),x=_e(c,p);f(x)}catch(v){console.error("Error loading progress data:",v),alert("Не удалось загрузить данные прогресса"),f(null)}finally{H(!1)}},[w]);return s.useEffect(()=>{W()},[W]),{exercises:d,loading:I,progressData:L,loadingProgress:l,searchQuery:A,selectedExercise:X,setSearchQuery:j,setSelectedExercise:Q,loadProgress:q}}function U(w,d,u,I){const b=Math.abs(w),L=b%10,f=b%100;return f>=11&&f<=19?I:L===1?d:L>=2&&L<=4?u:I}const he=$,Te=({active:w,payload:d})=>{if(!w||!(d!=null&&d[0]))return null;const u=d[0].payload;return e.jsxs("div",{className:"glass card-dark p-3 rounded-lg shadow-lg border border-white/20",children:[e.jsx("p",{className:"text-sm text-gray-300 mb-1",children:u.workoutName}),e.jsxs("p",{className:"text-base font-bold text-white",children:[u.weight," кг × ",u.reps||"?"]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(u.date).toLocaleDateString("ru")})]})},Ue=()=>{var oe,le;const w=Ce(),{user:d}=ue(),{exercises:u,loading:I,progressData:b,loadingProgress:L,searchQuery:f,selectedExercise:l,setSearchQuery:H,setSelectedExercise:G,loadProgress:P}=ze(),A=s.useRef(null),X=Me(),[j,Q]=s.useState("all"),[W,q]=s.useState(null),[c,v]=s.useState(null),[N,M]=s.useState(!1),[k,y]=s.useState(!1),F=s.useRef(null),S=s.useRef(null),[m,C]=s.useState(()=>{try{return localStorage.getItem("progress:activeTab")||"exercises"}catch{return"exercises"}}),[p,x]=s.useState(3),[o,_]=s.useState([]),[R,B]=s.useState(!1),[Z,V]=s.useState(!1),[D,ee]=s.useState(()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`}),te=s.useRef(!1);Ee(Z);const me=s.useCallback(()=>l?`scroll:progress-page:detail:${Y(l||"")}`:"scroll:progress-page:list",[l]),ge=t=>{G(t),P(t)},fe=t=>{w(`/workout/${t.date}`,{state:{focusExerciseId:t.exerciseId}})},pe=()=>{l?(G(null),P(null)):w("/profile")};De({key:me(),enabled:!I&&(!l||!L&&!!b)}),s.useEffect(()=>{try{const t="progress:lastSelectedExercise";l?localStorage.setItem(t,l):localStorage.removeItem(t)}catch{}},[l]),s.useEffect(()=>{if(!l)try{const t=localStorage.getItem("progress:lastSelectedExercise");t&&G(t)}catch{}},[]),s.useEffect(()=>{l&&P(l)},[l,P]),s.useEffect(()=>{Q("all"),q(null),v(null)},[l]),s.useEffect(()=>{const t=a=>{F.current&&!F.current.contains(a.target)&&M(!1),S.current&&!S.current.contains(a.target)&&y(!1)};if(N||k)return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[N,k]),s.useEffect(()=>{try{localStorage.setItem("progress:activeTab",m)}catch{}},[m]),s.useEffect(()=>{if(!d)return;let t=!1;return(async()=>{var n;try{const{data:r,error:i}=await he.from("user_settings").select("cardio_weekly_goal").eq("user_id",d.id).limit(1);if(i){console.error("Error loading cardio goal:",i);return}!t&&r&&r.length>0&&typeof((n=r[0])==null?void 0:n.cardio_weekly_goal)=="number"&&x(r[0].cardio_weekly_goal)}catch(r){console.error("Error loading cardio goal:",r)}finally{t||(te.current=!0)}})(),()=>{t=!0}},[d]),s.useEffect(()=>{if(!d||!te.current)return;(async()=>{try{const{error:a}=await he.from("user_settings").upsert({user_id:d.id,cardio_weekly_goal:p},{onConflict:"user_id"});a&&console.error("Error saving cardio goal:",a)}catch(a){console.error("Error saving cardio goal:",a)}})()},[p,d]),s.useEffect(()=>{if(m!=="cardio"||!d)return;(async()=>{B(!0);try{const{data:a,error:n}=await $.from("workouts").select("workout_date").eq("user_id",d.id).eq("is_cardio",!0).order("workout_date",{ascending:!1});if(n)throw n;_(a||[])}catch(a){console.error("Error fetching cardio workouts:",a)}finally{B(!1)}})()},[m,d]);const se=s.useMemo(()=>{if(!D)return[];const[t,a]=D.split("-").map(Number),n=new Date(t,a-1,1),r=new Date(t,a,0);n.setHours(0,0,0,0),r.setHours(23,59,59,999);const i=new Date;i.setHours(0,0,0,0);const z=[];let h=new Date(n);const ie=h.getDay(),ye=ie===0?-6:1-ie;for(h.setDate(h.getDate()+ye);h<=r||h.getMonth()===a-1||h.getMonth()===a-2&&h.getDate()>20;){const T=new Date(h),E=new Date(h);if(T.setHours(0,0,0,0),E.setDate(E.getDate()+6),E.setHours(23,59,59,999),E>=n&&T<=r){const Ne=o.filter(Se=>{const[ce,de,xe]=Se.workout_date.split("-").map(Number);if(!ce||!de||!xe)return!1;const J=new Date(ce,de-1,xe);return J.setHours(12,0,0,0),J>=T&&J<=E}).length,ke=i>=T&&i<=E;z.push({weekStart:T.toISOString().slice(0,10),weekEnd:E.toISOString().slice(0,10),weekLabel:`${T.getDate()}.${String(T.getMonth()+1).padStart(2,"0")} - ${E.getDate()}.${String(E.getMonth()+1).padStart(2,"0")}`,count:Ne,goal:p,isCurrentWeek:ke})}if(h.setDate(h.getDate()+7),h>r&&h.getMonth()!==a-1)break}return z},[D,o,p]),K=s.useMemo(()=>{const t={},a=["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"];return o.forEach(n=>{const r=new Date(n.workout_date),i=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`;t[i]||(t[i]={month:i,year:r.getFullYear(),count:0,monthLabel:`${a[r.getMonth()]} ${r.getFullYear()}`}),t[i].count++}),Object.values(t).sort((n,r)=>r.month.localeCompare(n.month))},[o]),re=s.useMemo(()=>{const t=[],a=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],n=new Date;for(let r=0;r<12;r++){const i=new Date(n.getFullYear(),n.getMonth()-r,1),z=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`;t.push({value:z,label:`${a[i.getMonth()]} ${i.getFullYear()}`})}return t},[]),we=s.useMemo(()=>{var t;return D&&((t=K.find(a=>a.month===D))==null?void 0:t.count)||0},[D,K]),ae=[{id:"all",label:"Все данные"},{id:"3m",label:"Последние 3 мес"},{id:"6m",label:"Последние 6 мес"},{id:"1y",label:"Последний год"},{id:"custom",label:"Произвольный период"}],be=((oe=ae.find(t=>t.id===j))==null?void 0:oe.label)||"Выбрать",g=s.useMemo(()=>{if(!b)return[];const t=b.dataPoints;if(j==="all")return t;const a=new Date;if(j==="3m"||j==="6m"||j==="1y"){const n=new Date(a);return j==="3m"?n.setMonth(n.getMonth()-3):j==="6m"?n.setMonth(n.getMonth()-6):n.setFullYear(n.getFullYear()-1),t.filter(r=>new Date(r.date)>=n)}if(j==="custom"){if(!W&&!c)return t;const n=W?new Date(W):null,r=c?new Date(c):null;return t.filter(i=>{const z=new Date(i.date);if(n&&z<n)return!1;if(r){const h=new Date(r);if(h.setHours(23,59,59,999),z>h)return!1}return!0})}return t},[b,j,W,c]),je=Math.max((g.length||0)*56,320),O=s.useMemo(()=>{if(!b||g.length===0)return null;const t=g.map(i=>i.weight),a=g.length,n=Math.max(...t),r=Math.min(...t);return{totalSessions:a,maxWeight:n,minWeight:r}},[b,g]),ve=s.useMemo(()=>{if(!g||g.length<=1)return"—";const t=g[0].weight,a=g[g.length-1].weight;if(t<=0)return"—";const n=(a-t)/t*100;return`${n>0?"+":""}${n.toFixed(1)}%`},[g]),ne=f.trim()?u.filter(t=>Y(t.name).includes(Y(f))):u;return I&&m==="exercises"?e.jsx(Le,{message:"Загрузка упражнений..."}):e.jsxs("div",{className:"p-4 max-w-4xl mx-auto pt-safe pb-4",children:[e.jsxs("div",{className:`mb-6 glass card-dark p-4 flex items-center gap-4 header-container ${X?"scrolling":""}`,children:[e.jsx("button",{onClick:pe,className:"shrink-0 inline-flex items-center justify-center p-2 rounded-full border border-transparent text-white bg-transparent transition-colors focus:outline-none active:outline-none back-button-plain","aria-label":"Назад",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h1",{className:"flex-1 text-xl font-bold text-center",children:m==="exercises"?l||"Прогресс":"Кардио"}),m==="cardio"&&e.jsx("button",{onClick:()=>V(!0),className:"shrink-0 inline-flex items-center justify-center w-8 h-8 rounded-full text-white bg-white/10 hover:bg-white/20 transition-colors","aria-label":"Информация о кардио",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),!l&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>C("exercises"),className:`flex-1 py-2.5 px-4 rounded-xl font-medium transition-all ${m==="exercises"?"bg-blue-500/30 text-white border border-blue-400/40":"bg-white/5 text-gray-400 border border-white/10 hover:bg-white/10"}`,children:"Упражнения"}),e.jsx("button",{onClick:()=>C("cardio"),className:`flex-1 py-2.5 px-4 rounded-xl font-medium transition-all ${m==="cardio"?"bg-green-500/30 text-white border border-green-400/40":"bg-white/5 text-gray-400 border border-white/10 hover:bg-white/10"}`,children:"Кардио"})]}),!l&&m==="exercises"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"glass card-dark rounded-full px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-5 w-5 text-gray-400",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-4.35-4.35m0 0A7.5 7.5 0 103.5 10.5a7.5 7.5 0 0013.15 6.15z"})}),e.jsx("input",{ref:A,type:"text",value:f,onChange:t=>H(t.target.value),placeholder:"Поиск","aria-label":"Поиск упражнений",className:"flex-1 bg-transparent border-0 outline-none ring-0 focus:outline-none focus:ring-0 appearance-none text-white placeholder-gray-500 text-base shadow-none",style:{background:"transparent",backgroundColor:"transparent",border:0,boxShadow:"none",outline:"none"}}),e.jsx("button",{type:"button",onClick:()=>{var t;H(""),(t=A.current)==null||t.focus()},"aria-label":"Очистить","aria-hidden":!f,className:`shrink-0 w-7 h-7 grid place-items-center rounded-full text-gray-400 hover:text-gray-200 hover:bg-white/10 transition ${f?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6l12 12M18 6L6 18"})})})]})}),u.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Нет данных для отображения"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Выполните несколько тренировок с записанным весом"})]}):ne.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Упражнения не найдены"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Попробуйте изменить запрос"})]}):ne.map(t=>e.jsx("button",{onClick:()=>ge(t.name),className:"w-full glass card-dark p-4 rounded-lg hover:bg-white/5 transition-colors text-left",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Выполнено подходов: ",t.totalSets]})]}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},t.name))]}),m==="cardio"&&!l&&e.jsx("div",{className:"space-y-4",children:R?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"relative w-12 h-12",children:e.jsx("div",{className:"absolute inset-0 border-4 border-transparent border-t-green-500 border-r-green-500 rounded-full animate-spin"})}),e.jsx("p",{className:"text-white text-center",children:"Загрузка данных..."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Цель на неделю"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>x(Math.max(1,p-1)),className:"w-8 h-8 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors flex items-center justify-center",disabled:p<=1,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),e.jsx("span",{className:"text-2xl font-bold text-green-400 w-8 text-center",children:p}),e.jsx("button",{onClick:()=>x(Math.min(7,p+1)),className:"w-8 h-8 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors flex items-center justify-center",disabled:p>=7,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}),e.jsxs("p",{className:"text-sm text-gray-400",children:[U(p,"тренировка","тренировки","тренировок")," в неделю"]})]}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Статистика по месяцам"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-center mb-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-white/5",children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:we}),e.jsx("p",{className:"text-xs text-gray-400",children:"В этом месяце"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-white/5",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:o.length}),e.jsx("p",{className:"text-xs text-gray-400",children:"Всего кардио"})]})]}),K.length>0&&e.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:K.map(t=>e.jsxs("div",{onClick:()=>ee(t.month),className:`flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors ${t.month===D?"bg-green-500/20 border border-green-500/30":"bg-white/5 hover:bg-white/10"}`,children:[e.jsx("span",{className:"text-sm text-gray-300",children:t.monthLabel}),e.jsx("span",{className:"text-lg font-bold text-white",children:t.count})]},t.month))})]}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Прогресс по неделям"}),e.jsxs("div",{ref:S,className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>y(!k),className:"flex items-center justify-between gap-2 bg-white/10 border border-white/20 rounded-lg px-3 py-1.5 text-sm text-white hover:bg-white/15 transition-colors min-w-[160px]",children:[e.jsx("span",{children:((le=re.find(t=>t.value===D))==null?void 0:le.label)||"Выберите месяц"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 text-gray-400 transition-transform ${k?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),k&&e.jsx("div",{className:"absolute top-full right-0 mt-1 w-full min-w-[160px] max-h-60 overflow-y-auto rounded-lg shadow-lg border border-white/10 z-50",style:{background:"rgba(24,24,27,0.95)",backdropFilter:"saturate(160%) blur(36px)",WebkitBackdropFilter:"saturate(160%) blur(24px)"},children:re.map(t=>e.jsx("button",{onClick:()=>{ee(t.value),y(!1)},className:`w-full text-left px-4 py-2.5 text-sm transition-colors border-b border-white/5 last:border-0 ${D===t.value?"bg-green-500/20 text-green-400":"text-gray-200 hover:bg-white/10"}`,children:t.label},t.value))})]})]}),e.jsx("div",{className:"space-y-3",children:se.length===0?e.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"Нет данных за этот месяц"}):se.map((t,a)=>{const n=Math.min(t.count/t.goal*100,100),r=t.count>=t.goal;return e.jsxs("div",{className:`p-3 rounded-lg ${t.isCurrentWeek?"bg-green-500/10 border border-green-500/30":"bg-white/5"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:`text-sm ${t.isCurrentWeek?"text-green-300 font-medium":"text-gray-300"}`,children:[t.weekLabel,t.isCurrentWeek&&" (текущая)"]}),e.jsxs("span",{className:`text-sm font-bold ${r?"text-green-400":"text-gray-400"}`,children:[t.count," / ",t.goal]})]}),e.jsx("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-500 rounded-full ${r?"bg-gradient-to-r from-green-500 to-green-400":"bg-gradient-to-r from-blue-500 to-blue-400"}`,style:{width:`${n}%`}})}),!r&&t.isCurrentWeek&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Осталось: ",t.goal-t.count," ",U(t.goal-t.count,"тренировка","тренировки","тренировок")]})]},a)})})]})]})}),Z&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onClick:()=>V(!1),children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),e.jsxs("div",{className:"relative glass card-dark p-5 rounded-2xl max-w-md w-full max-h-[80vh]",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>V(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 transition-colors flex items-center justify-center","aria-label":"Закрыть",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-xl font-bold text-white pr-10",children:"О кардио тренировках"}),e.jsxs("div",{className:"mt-4 space-y-4 text-sm text-gray-300 max-h-[60vh] overflow-y-auto pr-1",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:"Что такое кардио?"}),e.jsx("p",{children:"Аэробные нагрузки, укрепляющие сердечно-сосудистую систему и улучшающие выносливость."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:"Сколько делать?"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"2-3 раза в неделю — минимум для здоровья"}),e.jsx("li",{children:"3-5 раз — оптимально для похудения"}),e.jsx("li",{children:"20-40 минут за сессию"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:"Целевой пульс"}),e.jsx("p",{children:"130-140 уд/мин — зона жиросжигания. Вы должны мочь говорить, но с усилием."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:"Виды кардио"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("b",{children:"Stair Master"})," — имитация подъёма по лестнице"]}),e.jsxs("li",{children:[e.jsx("b",{children:"Эллипсоид"})," — щадящая нагрузка на суставы"]}),e.jsxs("li",{children:[e.jsx("b",{children:"Велотренажёр"})," — подходит для начинающих"]}),e.jsxs("li",{children:[e.jsx("b",{children:"Беговая дорожка"})," — быстрая ходьба или бег"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:"Плюсы"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Укрепляет сердце и сосуды"}),e.jsx("li",{children:"Ускоряет метаболизм"}),e.jsx("li",{children:"Снижает уровень стресса"}),e.jsx("li",{children:"Улучшает качество сна"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:"Когда делать?"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"После силовой тренировки (20-30 мин)"}),e.jsx("li",{children:"В отдельный день (40-60 мин)"}),e.jsx("li",{children:"Утром натощак — для продвинутых"})]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-yellow-500/10 border border-yellow-500/30",children:[e.jsx("h3",{className:"text-yellow-400 font-semibold mb-2",children:"⚠️ Предупреждение"}),e.jsx("p",{className:"text-yellow-200/80",children:"При проблемах с сердцем, суставами или давлением — проконсультируйтесь с врачом перед началом кардио тренировок."})]})]})]})]}),l&&e.jsx("div",{className:"space-y-4",children:L?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"relative w-12 h-12",children:e.jsx("div",{className:"absolute inset-0 border-4 border-transparent border-t-blue-500 border-r-blue-500 rounded-full animate-spin"})}),e.jsx("p",{className:"text-white text-center",children:"Загрузка данных..."})]})}):b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"glass card-dark p-4 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:O?O.totalSessions:0}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:U((O==null?void 0:O.totalSessions)??0,"Тренировка","Тренировки","Тренировок")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:O?`${O.maxWeight} кг`:"—"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Максимум"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:ve}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Прирост"})]})]})}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsxs("div",{className:"flex flex-col gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Динамика веса"}),e.jsxs("div",{ref:F,className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>M(!N),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-white/5 border border-white/15 text-xs text-gray-200 hover:bg-white/10 hover:border-white/25 transition-colors",children:[e.jsx("span",{className:"hidden sm:inline text-gray-400",children:"Период:"}),e.jsx("span",{className:"font-medium",children:be}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-3 w-3 transition-transform ${N?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})]}),N&&e.jsx("div",{className:"absolute top-full right-0 mt-1 w-48 rounded-lg shadow-lg border border-white/10 z-50 overflow-hidden",style:{background:"rgba(24,24,27,0.95)",backdropFilter:"saturate(160%) blur(36px)",WebkitBackdropFilter:"saturate(160%) blur(24px)"},children:ae.map(t=>e.jsx("button",{type:"button",onClick:()=>{Q(t.id),M(!1)},className:`w-full text-left px-3 py-2 text-xs transition-colors ${j===t.id?"bg-white/15 text-white font-medium":"text-gray-300 hover:bg-white/8"}`,children:t.label},t.id))})]})]}),j==="custom"&&e.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 text-xs text-gray-300 flex-wrap text-center",children:[e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"с"}),e.jsx("input",{type:"date",value:W??"",onChange:t=>q(t.target.value||null),className:"bg-transparent border border-white/20 rounded px-2 py-1 text-xs text-white focus:outline-none focus:ring-0 focus:border-blue-400/80"})]}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"по"}),e.jsx("input",{type:"date",value:c??"",onChange:t=>v(t.target.value||null),className:"bg-transparent border border-white/20 rounded px-2 py-1 text-xs text-white focus:outline-none focus:ring-0 focus:border-blue-400/80"})]})]})]}),g.length===0?e.jsx("div",{className:"pt-6 pb-3 text-sm text-gray-400 text-center",children:"Нет данных за выбранный период"}):e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 pb-2",children:e.jsx("div",{style:{minWidth:`${je}px`},children:e.jsx($e,{width:"100%",height:300,children:e.jsxs(Ie,{data:g,margin:{top:24,right:10,left:0,bottom:5},children:[e.jsx(Pe,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),e.jsx(Fe,{dataKey:"displayDate",stroke:"rgba(255,255,255,0.5)",style:{fontSize:"12px"}}),e.jsx(Re,{stroke:"rgba(255,255,255,0.5)",style:{fontSize:"12px"},label:{value:"Вес (кг)",angle:-90,position:"insideLeft",fill:"rgba(255,255,255,0.7)",dx:8}}),e.jsx(Be,{content:e.jsx(Te,{})}),e.jsx(Oe,{type:"monotone",dataKey:"weight",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",r:4},activeDot:{r:6}})]})})})})]}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"История"}),g.length===0?e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Нет тренировок за выбранный период"}):e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:g.slice().reverse().map((t,a)=>e.jsxs("div",{onClick:()=>fe(t),className:"flex items-center justify-between p-3 rounded-lg bg-white/5 hover:bg-white/10 transition-colors cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:new Date(t.date).toLocaleDateString("ru")}),e.jsx("p",{className:"text-sm text-gray-400",children:t.workoutName})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-bold text-white",children:[t.weight," кг"]}),e.jsxs("p",{className:"text-sm text-gray-400",children:[t.reps||"?"," повторов"]})]})]},a))})]})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-400",children:"Нет данных для отображения"})})})]})};export{Ue as default};
