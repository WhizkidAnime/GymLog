import{u as ge,s as O,j as e,W as De}from"./index-CD3TDb9H.js";import{r,e as Me}from"./vendor-BVca5W6X.js";import{n as A,p as Ee}from"./exercise-name-BJxyXXn3.js";import{u as Le}from"./use-header-scroll-Cg2zr4na.js";import{u as We}from"./use-scroll-restoration-CZtb4aM8.js";import{u as $e}from"./use-modal-scroll-lock-DlG-D3y9.js";import{u as Ie}from"./usePageState-6XNG0ilq.js";import{R as Pe,L as Re,C as Oe,X as Fe,Y as Te,T as ze,a as Be}from"./charts-33RH-A39.js";import"./supabase-CWpvgLJU.js";function Ye(){const{user:m}=ge(),i=r.useRef(null),p=r.useRef(new Map),I=300*1e3,[S,D]=r.useState([]),[M,c]=r.useState(!0),[K,E]=r.useState(null),[Y,q]=r.useState(!1),[ee,j]=Ie({key:"progress-page",initialState:{searchQuery:"",selectedExercise:null},ttl:1800*1e3}),{searchQuery:V,selectedExercise:F}=ee,X=l=>{j(g=>({...g,searchQuery:l}))},T=l=>{j(g=>({...g,selectedExercise:l}))},H=r.useCallback(async()=>{if(!m)return[];if(i.current)return i.current;const{data:l,error:g}=await O.from("workouts").select("id").eq("user_id",m.id);if(g)throw g;const y=(l||[]).map(N=>N.id);return i.current=y,y},[m]),P=r.useCallback(async()=>{if(m){c(!0);try{const l=await H();if(l.length===0){D([]);return}const{data:g,error:y}=await O.from("exercise_progress_view").select("workout_id, exercise_id, max_weight").in("workout_id",l);if(y)throw y;const N=new Map;if((g||[]).forEach(f=>{const x=f.exercise_id,C=f.max_weight||0;if(!x||C<=0)return;const u=N.get(x)||0;N.set(x,u+1)}),N.size===0){D([]);return}const{data:d,error:z}=await O.from("workout_exercises").select("id, name").in("id",Array.from(N.keys()));if(z)throw z;const w=A,k=new Map;(d||[]).forEach(f=>{const x=(f.name??"").trim();if(!x)return;const C=w(x),u=N.get(f.id)||0;if(u<=0)return;const _=k.get(C);_?k.set(C,{name:_.name.length>=x.length?_.name:x,total:_.total+u}):k.set(C,{name:x,total:u})});const L=Array.from(k.values()).map(({name:f,total:x})=>({name:f,totalSets:x})).sort((f,x)=>f.name.localeCompare(x.name,"ru"));D(L)}catch(l){console.error("Error fetching progress exercises:",l),alert("Не удалось загрузить список упражнений"),D([])}finally{c(!1)}}},[m]),Q=r.useCallback(async l=>{if(!m||!l){E(null);return}const g=A(l),y=p.current.get(g),N=Date.now();if(y&&N-y.ts<I){E(y.data);return}q(!0);try{const d=await H();if(d.length===0){E({exerciseName:l,dataPoints:[],totalSessions:0,maxWeight:0,minWeight:0}),p.current.set(g,{data:{exerciseName:l,dataPoints:[],totalSessions:0,maxWeight:0,minWeight:0},ts:Date.now()});return}const{data:z,error:w}=await O.from("workout_exercises").select("id, name, workout_id").in("workout_id",d);if(w)throw w;const k=new Set;if((z||[]).forEach(u=>{const _=(u.name??"").trim();_&&A(_)===g&&k.add(u.id)}),k.size===0){E({exerciseName:l,dataPoints:[],totalSessions:0,maxWeight:0,minWeight:0});return}const{data:L,error:f}=await O.from("exercise_progress_view").select("workout_date, workout_name, workout_id, exercise_id, max_weight, reps_at_max_weight").in("workout_id",d).in("exercise_id",Array.from(k));if(f)throw f;const x=(L||[]).map(u=>({workout_date:u.workout_date,workout_name:u.workout_name,workout_id:u.workout_id,exercise_id:u.exercise_id,max_weight:u.max_weight,reps_at_max_weight:u.reps_at_max_weight})),C=Ee(l,x);E(C),p.current.set(g,{data:C,ts:Date.now()})}catch(d){console.error("Error loading progress data:",d),alert("Не удалось загрузить данные прогресса"),E(null)}finally{q(!1)}},[m,H,I]);return r.useEffect(()=>{P()},[P]),r.useEffect(()=>{i.current=null,p.current.clear()},[m==null?void 0:m.id]),{exercises:S,loading:M,progressData:K,loadingProgress:Y,searchQuery:V,selectedExercise:F,setSearchQuery:X,setSelectedExercise:T,loadProgress:Q}}function se(m,i,p,I){const S=Math.abs(m),D=S%10,M=S%100;return M>=11&&M<=19?I:D===1?i:D>=2&&D<=4?p:I}const me=O,He=({active:m,payload:i})=>{if(!m||!(i!=null&&i[0]))return null;const p=i[0].payload;return e.jsxs("div",{className:"glass card-dark p-3 rounded-lg shadow-lg border border-white/20",children:[e.jsx("p",{className:"text-sm text-gray-300 mb-1",children:p.workoutName}),e.jsxs("p",{className:"text-base font-bold text-white",children:[p.weight," кг × ",p.reps||"?"]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(p.date).toLocaleDateString("ru")})]})},Ze=()=>{var ce,de;const m=Me(),{user:i}=ge(),{exercises:p,loading:I,progressData:S,loadingProgress:D,searchQuery:M,selectedExercise:c,setSearchQuery:K,setSelectedExercise:E,loadProgress:Y}=Ye(),q=r.useRef(null),ee=Le(),[j,V]=r.useState("all"),[F,X]=r.useState(null),[T,H]=r.useState(null),[P,Q]=r.useState(!1),[l,g]=r.useState(!1),y=r.useRef(null),N=r.useRef(null),[d,z]=r.useState(()=>{try{return localStorage.getItem("progress:activeTab")||"exercises"}catch{return"exercises"}}),[w,k]=r.useState(3),[L,f]=r.useState([]),[x,C]=r.useState(!1),[u,_]=r.useState(!1),[W,re]=r.useState(()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`}),G="progress:cardioCache",U=1800*1e3,ne=r.useRef(!1);$e(u);const fe=r.useCallback(()=>c?`scroll:progress-page:detail:${A(c||"")}`:"scroll:progress-page:list",[c]),pe=t=>{E(t),Y(t)},we=t=>{m(`/workout/${t.date}`,{state:{focusExerciseId:t.exerciseId}})},be=()=>{c?(E(null),Y(null)):m("/profile")};We({key:fe(),enabled:!I&&(!c||!D&&!!S)}),r.useEffect(()=>{try{const t="progress:lastSelectedExercise";c?localStorage.setItem(t,c):localStorage.removeItem(t)}catch{}},[c]),r.useEffect(()=>{if(!c)try{const t=localStorage.getItem("progress:lastSelectedExercise");t&&E(t)}catch{}},[]),r.useEffect(()=>{c&&Y(c)},[c,Y]),r.useEffect(()=>{V("all"),X(null),H(null)},[c]),r.useEffect(()=>{const t=a=>{y.current&&!y.current.contains(a.target)&&Q(!1),N.current&&!N.current.contains(a.target)&&g(!1)};if(P||l)return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[P,l]),r.useEffect(()=>{try{localStorage.setItem("progress:activeTab",d)}catch{}},[d]),r.useEffect(()=>{if(!i)return;let t=!1;return(async()=>{var n;try{const{data:s,error:o}=await me.from("user_settings").select("cardio_weekly_goal").eq("user_id",i.id).limit(1);if(o){console.error("Error loading cardio goal:",o);return}!t&&s&&s.length>0&&typeof((n=s[0])==null?void 0:n.cardio_weekly_goal)=="number"&&k(s[0].cardio_weekly_goal)}catch(s){console.error("Error loading cardio goal:",s)}finally{t||(ne.current=!0)}})(),()=>{t=!0}},[i]),r.useEffect(()=>{if(!i||!ne.current)return;(async()=>{try{const{error:a}=await me.from("user_settings").upsert({user_id:i.id,cardio_weekly_goal:w},{onConflict:"user_id"});a&&console.error("Error saving cardio goal:",a)}catch(a){console.error("Error saving cardio goal:",a)}})()},[w,i]),r.useEffect(()=>{if(d!=="cardio"||!i)return;const t=()=>{try{const o=localStorage.getItem(G);if(!o)return null;const v=JSON.parse(o);return Date.now()-(v.timestamp||0)>U?null:v.data||null}catch{return null}},a=o=>{try{localStorage.setItem(G,JSON.stringify({data:o,timestamp:Date.now()}))}catch{}},n=async(o=!1)=>{o||C(!0);try{const{data:v,error:h}=await O.from("workouts").select("workout_date").eq("user_id",i.id).eq("is_cardio",!0).order("workout_date",{ascending:!1});if(h)throw h;const J=v||[];f(J),a(J)}catch(v){console.error("Error fetching cardio workouts:",v)}finally{o||C(!1)}},s=t();if(s){f(s),n(!0);return}n(!1)},[d,i,G,U]),r.useEffect(()=>{const t=()=>{if(document.visibilityState!=="visible"||d!=="cardio"||!i)return;const a=localStorage.getItem(G);let n=!0;if(a)try{const s=JSON.parse(a);n=Date.now()-(s.timestamp||0)>U}catch{n=!0}n&&(async()=>{try{const{data:s,error:o}=await O.from("workouts").select("workout_date").eq("user_id",i.id).eq("is_cardio",!0).order("workout_date",{ascending:!1});!o&&s&&(f(s),localStorage.setItem(G,JSON.stringify({data:s,timestamp:Date.now()})))}catch{}})()};return document.addEventListener("visibilitychange",t),()=>document.removeEventListener("visibilitychange",t)},[d,i,G,U]);const ae=r.useMemo(()=>{if(!W)return[];const[t,a]=W.split("-").map(Number),n=new Date(t,a-1,1),s=new Date(t,a,0);n.setHours(0,0,0,0),s.setHours(23,59,59,999);const o=new Date;o.setHours(0,0,0,0);const v=[];let h=new Date(n);const J=h.getDay(),ke=J===0?-6:1-J;for(h.setDate(h.getDate()+ke);h<=s||h.getMonth()===a-1||h.getMonth()===a-2&&h.getDate()>20;){const B=new Date(h),$=new Date(h);if(B.setHours(0,0,0,0),$.setDate($.getDate()+6),$.setHours(23,59,59,999),$>=n&&B<=s){const Se=L.filter(_e=>{const[he,xe,ue]=_e.workout_date.split("-").map(Number);if(!he||!xe||!ue)return!1;const te=new Date(he,xe-1,ue);return te.setHours(12,0,0,0),te>=B&&te<=$}).length,Ce=o>=B&&o<=$;v.push({weekStart:B.toISOString().slice(0,10),weekEnd:$.toISOString().slice(0,10),weekLabel:`${B.getDate()}.${String(B.getMonth()+1).padStart(2,"0")} - ${$.getDate()}.${String($.getMonth()+1).padStart(2,"0")}`,count:Se,goal:w,isCurrentWeek:Ce})}if(h.setDate(h.getDate()+7),h>s&&h.getMonth()!==a-1)break}return v},[W,L,w]),Z=r.useMemo(()=>{const t={},a=["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"];return L.forEach(n=>{const s=new Date(n.workout_date),o=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`;t[o]||(t[o]={month:o,year:s.getFullYear(),count:0,monthLabel:`${a[s.getMonth()]} ${s.getFullYear()}`}),t[o].count++}),Object.values(t).sort((n,s)=>s.month.localeCompare(n.month))},[L]),oe=r.useMemo(()=>{const t=[],a=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],n=new Date;for(let s=0;s<12;s++){const o=new Date(n.getFullYear(),n.getMonth()-s,1),v=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`;t.push({value:v,label:`${a[o.getMonth()]} ${o.getFullYear()}`})}return t},[]),je=r.useMemo(()=>{var t;return W&&((t=Z.find(a=>a.month===W))==null?void 0:t.count)||0},[W,Z]),ie=[{id:"all",label:"Все данные"},{id:"3m",label:"Последние 3 мес"},{id:"6m",label:"Последние 6 мес"},{id:"1y",label:"Последний год"},{id:"custom",label:"Произвольный период"}],ve=((ce=ie.find(t=>t.id===j))==null?void 0:ce.label)||"Выбрать",b=r.useMemo(()=>{if(!S)return[];const t=S.dataPoints;if(j==="all")return t;const a=new Date;if(j==="3m"||j==="6m"||j==="1y"){const n=new Date(a);return j==="3m"?n.setMonth(n.getMonth()-3):j==="6m"?n.setMonth(n.getMonth()-6):n.setFullYear(n.getFullYear()-1),t.filter(s=>new Date(s.date)>=n)}if(j==="custom"){if(!F&&!T)return t;const n=F?new Date(F):null,s=T?new Date(T):null;return t.filter(o=>{const v=new Date(o.date);if(n&&v<n)return!1;if(s){const h=new Date(s);if(h.setHours(23,59,59,999),v>h)return!1}return!0})}return t},[S,j,F,T]),ye=Math.max((b.length||0)*56,320),R=r.useMemo(()=>{if(!S||b.length===0)return null;const t=b.map(o=>o.weight),a=b.length,n=Math.max(...t),s=Math.min(...t);return{totalSessions:a,maxWeight:n,minWeight:s}},[S,b]),Ne=r.useMemo(()=>{if(!b||b.length<=1)return"—";const t=b[0].weight,a=b[b.length-1].weight;if(t<=0)return"—";const n=(a-t)/t*100;return`${n>0?"+":""}${n.toFixed(1)}%`},[b]),le=M.trim()?p.filter(t=>A(t.name).includes(A(M))):p;return I&&d==="exercises"?e.jsx(De,{message:"Загрузка упражнений..."}):e.jsxs("div",{className:"p-4 max-w-4xl mx-auto pt-safe pb-4",children:[e.jsxs("div",{className:`mb-6 glass card-dark p-4 flex items-center gap-4 header-container ${ee?"scrolling":""}`,children:[e.jsx("button",{onClick:be,className:"shrink-0 inline-flex items-center justify-center p-2 rounded-full border border-transparent text-white bg-transparent transition-colors focus:outline-none active:outline-none back-button-plain","aria-label":"Назад",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h1",{className:"flex-1 text-xl font-bold text-center",children:d==="exercises"?c||"Прогресс":"Кардио"}),d==="cardio"&&e.jsx("button",{onClick:()=>_(!0),className:"shrink-0 inline-flex items-center justify-center w-8 h-8 rounded-full text-white bg-white/10 hover:bg-white/20 transition-colors","aria-label":"Информация о кардио",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),!c&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>z("exercises"),className:`flex-1 py-2.5 px-4 rounded-xl font-medium transition-all ${d==="exercises"?"bg-blue-500/30 text-white border border-blue-400/40":"bg-white/5 text-gray-400 border border-white/10 hover:bg-white/10"}`,children:"Упражнения"}),e.jsx("button",{onClick:()=>z("cardio"),className:`flex-1 py-2.5 px-4 rounded-xl font-medium transition-all ${d==="cardio"?"bg-green-500/30 text-white border border-green-400/40":"bg-white/5 text-gray-400 border border-white/10 hover:bg-white/10"}`,children:"Кардио"})]}),!c&&d==="exercises"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"glass card-dark rounded-full px-4 py-3 search-container",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-5 w-5 text-gray-400",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-4.35-4.35m0 0A7.5 7.5 0 103.5 10.5a7.5 7.5 0 0013.15 6.15z"})}),e.jsx("input",{ref:q,type:"text",value:M,onChange:t=>K(t.target.value),placeholder:"Поиск","aria-label":"Поиск упражнений",className:"flex-1 bg-transparent border-0 outline-none ring-0 focus:outline-none focus:ring-0 appearance-none text-white placeholder-white/60 text-base shadow-none search-input"}),e.jsx("button",{type:"button",onClick:()=>{var t;K(""),(t=q.current)==null||t.focus()},"aria-label":"Очистить","aria-hidden":!M,className:`shrink-0 w-7 h-7 grid place-items-center rounded-full text-gray-400 hover:text-gray-200 hover:bg-white/10 transition ${M?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-4 w-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6l12 12M18 6L6 18"})})})]})}),p.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Нет данных для отображения"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Выполните несколько тренировок с записанным весом"})]}):le.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Упражнения не найдены"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Попробуйте изменить запрос"})]}):le.map(t=>e.jsx("button",{onClick:()=>pe(t.name),className:"w-full glass card-dark p-4 rounded-lg hover:bg-white/5 transition-colors text-left",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Выполнено подходов: ",t.totalSets]})]}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},t.name))]}),d==="cardio"&&!c&&e.jsx("div",{className:"space-y-4",children:x?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center",style:{background:"transparent"},children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"relative w-12 h-12",children:e.jsx("div",{className:"absolute inset-0 border-4 border-transparent border-t-green-500 border-r-green-500 rounded-full animate-spin"})}),e.jsx("p",{className:"text-white text-center",children:"Загрузка кардио..."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Цель на неделю"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>k(Math.max(1,w-1)),className:"w-8 h-8 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors flex items-center justify-center",disabled:w<=1,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),e.jsx("span",{className:"text-2xl font-bold text-green-400 w-8 text-center",children:w}),e.jsx("button",{onClick:()=>k(Math.min(7,w+1)),className:"w-8 h-8 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors flex items-center justify-center",disabled:w>=7,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}),e.jsxs("p",{className:"text-sm text-gray-400",children:[se(w,"тренировка","тренировки","тренировок")," в неделю"]})]}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Статистика по месяцам"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-center mb-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-white/5",children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:je}),e.jsx("p",{className:"text-xs text-gray-400",children:"В этом месяце"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-white/5",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:L.length}),e.jsx("p",{className:"text-xs text-gray-400",children:"Всего кардио"})]})]}),Z.length>0&&e.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:Z.map(t=>e.jsxs("div",{onClick:()=>re(t.month),className:`flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors ${t.month===W?"bg-green-500/20 border border-green-500/30":"bg-white/5 hover:bg-white/10"}`,children:[e.jsx("span",{className:"text-sm text-gray-300",children:t.monthLabel}),e.jsx("span",{className:"text-lg font-bold text-white",children:t.count})]},t.month))})]}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Прогресс по неделям"}),e.jsxs("div",{ref:N,className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>g(!l),className:"flex items-center justify-between gap-2 bg-white/10 border border-white/20 rounded-lg px-3 py-1.5 text-sm text-white hover:bg-white/15 transition-colors min-w-[160px] progress-dropdown-btn",children:[e.jsx("span",{children:((de=oe.find(t=>t.value===W))==null?void 0:de.label)||"Выберите месяц"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 text-gray-400 transition-transform ${l?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),l&&e.jsx("div",{className:"absolute top-full right-0 mt-1 w-full min-w-[160px] max-h-60 overflow-y-auto rounded-lg shadow-lg border border-white/10 z-50 progress-dropdown-menu",children:oe.map(t=>e.jsx("button",{onClick:()=>{re(t.value),g(!1)},className:`w-full text-left px-4 py-2.5 text-sm transition-colors border-b border-white/5 last:border-0 ${W===t.value?"bg-green-500/20 text-green-400":"text-gray-200 hover:bg-white/10"}`,children:t.label},t.value))})]})]}),e.jsx("div",{className:"space-y-3",children:ae.length===0?e.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"Нет данных за этот месяц"}):ae.map((t,a)=>{const n=Math.min(t.count/t.goal*100,100),s=t.count>=t.goal;return e.jsxs("div",{className:`p-3 rounded-lg ${t.isCurrentWeek?"bg-green-500/10 border border-green-500/30":"bg-white/5"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:`text-sm ${t.isCurrentWeek?"text-green-300 font-medium":"text-gray-300"}`,children:[t.weekLabel,t.isCurrentWeek&&" (текущая)"]}),e.jsxs("span",{className:`text-sm font-bold ${s?"text-green-400":"text-gray-400"}`,children:[t.count," / ",t.goal]})]}),e.jsx("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-500 rounded-full ${s?"bg-gradient-to-r from-green-500 to-green-400":"bg-gradient-to-r from-blue-500 to-blue-400"}`,style:{width:`${n}%`}})}),!s&&t.isCurrentWeek&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Осталось: ",t.goal-t.count," ",se(t.goal-t.count,"тренировка","тренировки","тренировок")]})]},a)})})]})]})}),u&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onClick:()=>_(!1),children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),e.jsxs("div",{className:"relative glass card-dark p-5 rounded-2xl max-w-md w-full max-h-[80vh]",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>_(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 transition-colors flex items-center justify-center","aria-label":"Закрыть",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-xl font-bold text-white pr-10",children:"О кардио тренировках"}),e.jsxs("div",{className:"mt-4 space-y-4 text-sm text-gray-300 max-h-[60vh] overflow-y-auto pr-1",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:"Что такое кардио?"}),e.jsx("p",{children:"Аэробные нагрузки, укрепляющие сердечно-сосудистую систему и улучшающие выносливость."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:"Сколько делать?"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"2-3 раза в неделю — минимум для здоровья"}),e.jsx("li",{children:"3-5 раз — оптимально для похудения"}),e.jsx("li",{children:"20-40 минут за сессию"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:"Целевой пульс"}),e.jsx("p",{children:"130-140 уд/мин — зона жиросжигания. Вы должны мочь говорить, но с усилием."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:"Виды кардио"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("b",{children:"Stair Master"})," — имитация подъёма по лестнице"]}),e.jsxs("li",{children:[e.jsx("b",{children:"Эллипсоид"})," — щадящая нагрузка на суставы"]}),e.jsxs("li",{children:[e.jsx("b",{children:"Велотренажёр"})," — подходит для начинающих"]}),e.jsxs("li",{children:[e.jsx("b",{children:"Беговая дорожка"})," — быстрая ходьба или бег"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:"Плюсы"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Укрепляет сердце и сосуды"}),e.jsx("li",{children:"Ускоряет метаболизм"}),e.jsx("li",{children:"Снижает уровень стресса"}),e.jsx("li",{children:"Улучшает качество сна"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-green-400 font-semibold mb-2",children:"Когда делать?"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"После силовой тренировки (20-30 мин)"}),e.jsx("li",{children:"В отдельный день (40-60 мин)"}),e.jsx("li",{children:"Утром натощак — для продвинутых"})]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-yellow-500/10 border border-yellow-500/30",children:[e.jsx("h3",{className:"text-yellow-400 font-semibold mb-2",children:"⚠️ Предупреждение"}),e.jsx("p",{className:"text-yellow-200/80",children:"При проблемах с сердцем, суставами или давлением — проконсультируйтесь с врачом перед началом кардио тренировок."})]})]})]})]}),c&&e.jsx("div",{className:"space-y-4",children:x?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center",style:{background:"transparent"},children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"relative w-12 h-12",children:e.jsx("div",{className:"absolute inset-0 border-4 border-transparent border-t-green-500 border-r-green-500 rounded-full animate-spin"})}),e.jsx("p",{className:"text-white text-center",children:"Загрузка кардио..."})]})}):L.length===0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"glass card-dark p-4 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:(R==null?void 0:R.totalSessions)??0}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:se((R==null?void 0:R.totalSessions)??0,"Тренировка","Тренировки","Тренировок")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:R?`${R.maxWeight} кг`:"—"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Максимум"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:Ne}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Прирост"})]})]})}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsxs("div",{className:"flex flex-col gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Динамика веса"}),e.jsxs("div",{ref:y,className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>Q(!P),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-white/5 border border-white/15 text-xs text-gray-200 hover:bg-white/10 hover:border-white/25 transition-colors progress-dropdown-btn",children:[e.jsx("span",{className:"hidden sm:inline text-gray-400",children:"Период:"}),e.jsx("span",{className:"font-medium",children:ve}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-3 w-3 transition-transform ${P?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})]}),P&&e.jsx("div",{className:"absolute top-full right-0 mt-1 w-48 rounded-lg shadow-lg border border-white/10 z-50 overflow-hidden progress-dropdown-menu",children:ie.map(t=>e.jsx("button",{type:"button",onClick:()=>{V(t.id),Q(!1)},className:`w-full text-left px-3 py-2 text-xs transition-colors ${j===t.id?"bg-white/15 text-white font-medium":"text-gray-300 hover:bg-white/8"}`,children:t.label},t.id))})]})]}),j==="custom"&&e.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 text-xs text-gray-300 flex-wrap text-center",children:[e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"с"}),e.jsx("input",{type:"date",value:F??"",onChange:t=>X(t.target.value||null),className:"bg-transparent border border-white/20 rounded px-2 py-1 text-xs text-white focus:outline-none focus:ring-0 focus:border-blue-400/80"})]}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"по"}),e.jsx("input",{type:"date",value:T??"",onChange:t=>H(t.target.value||null),className:"bg-transparent border border-white/20 rounded px-2 py-1 text-xs text-white focus:outline-none focus:ring-0 focus:border-blue-400/80"})]})]})]}),b.length===0?e.jsx("div",{className:"pt-6 pb-3 text-sm text-gray-400 text-center",children:"Нет данных за выбранный период"}):e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 pb-2",children:e.jsx("div",{style:{minWidth:`${ye}px`},children:e.jsx(Pe,{width:"100%",height:300,children:e.jsxs(Re,{data:b,margin:{top:24,right:10,left:0,bottom:5},children:[e.jsx(Oe,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),e.jsx(Fe,{dataKey:"displayDate",stroke:"rgba(255,255,255,0.5)",style:{fontSize:"12px"}}),e.jsx(Te,{stroke:"rgba(255,255,255,0.5)",style:{fontSize:"12px"},label:{value:"Вес (кг)",angle:-90,position:"insideLeft",fill:"rgba(255,255,255,0.7)",dx:8}}),e.jsx(ze,{content:e.jsx(He,{})}),e.jsx(Be,{type:"monotone",dataKey:"weight",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",r:4},activeDot:{r:6}})]})})})})]}),e.jsxs("div",{className:"glass card-dark p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"История"}),b.length===0?e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Нет тренировок за выбранный период"}):e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:b.slice().reverse().map((t,a)=>e.jsxs("div",{onClick:()=>we(t),className:"flex items-center justify-between p-3 rounded-lg bg-white/5 hover:bg-white/10 transition-colors cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:new Date(t.date).toLocaleDateString("ru")}),e.jsx("p",{className:"text-sm text-gray-400",children:t.workoutName})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-bold text-white",children:[t.weight," кг"]}),e.jsxs("p",{className:"text-sm text-gray-400",children:[t.reps||"?"," повторов"]})]})]},a))})]})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-400",children:"Нет данных для отображения"})})})]})};export{Ze as default};
