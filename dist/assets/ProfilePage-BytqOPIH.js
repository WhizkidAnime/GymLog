import{s as ne,g as h,j as e,a as re,u as je}from"./index-CLP7Nca7.js";import{r as s,c as Ne,e as ve}from"./vendor-BVca5W6X.js";import{C as ge}from"./confirm-dialog-4Kqi95RT.js";import{T as De}from"./template-saved-dialog-CgXVQ97b.js";import{u as Ce}from"./usePageState-6XNG0ilq.js";import{u as We}from"./use-profile-settings-_EsJTNvx.js";import{R as Te,L as _e,C as Se,X as Ee,Y as Ae,a as Ie}from"./charts-33RH-A39.js";import"./supabase-CWpvgLJU.js";import"./use-modal-scroll-lock-DlG-D3y9.js";async function Oe(){const t=ne,{error:l}=await t.rpc("delete_user_account");if(l)throw l}const ue="body-weights-data",Le=600*1e3;function Me({userId:t}){const l=ne,r=s.useRef(!1),[o,n]=s.useState(!1),[u,g]=Ce({key:t?`${ue}-${t}`:ue,initialState:[],ttl:Le}),[c,C]=s.useState(u),[N,p]=s.useState(!1),[f,T]=s.useState(""),[B,d]=s.useState(()=>{const w=new Date,i=String(w.getDate()).padStart(2,"0"),v=String(w.getMonth()+1).padStart(2,"0"),A=w.getFullYear();return`${i}.${v}.${A}`}),[L,y]=s.useState(!1),[E,O]=s.useState(null),[J,_]=s.useState(!1),[K,P]=s.useState(null);s.useEffect(()=>{u.length>0&&c.length===0&&(C(u),r.current=!0)},[]);const Q=s.useCallback(async(w=!1)=>{if(t){if(!w&&r.current&&u.length>0){C(u);return}if(!w&&u.length>0){C(u),r.current=!0;return}p(!0);try{const{data:i,error:v}=await l.from("user_body_weights").select("*").eq("user_id",t).order("recorded_at",{ascending:!1}).limit(100);if(v)throw v;const A=i||[];C(A),g(A),r.current=!0}catch(i){console.error("Error loading body weights:",i)}finally{p(!1)}}},[t,l,u,g]),$=s.useCallback(w=>{const i=w.match(/^(\d{1,2})\.(\d{1,2})\.(\d{4})$/);if(!i)return null;const[,v,A,m]=i,b=parseInt(v,10),j=parseInt(A,10),W=parseInt(m,10);if(j<1||j>12||b<1||b>31||W<1900||W>2100)return null;const X=new Date(W,j,0).getDate();if(b>X)return null;const V=new Date(W,j-1,b),k=new Date;if(k.setHours(23,59,59,999),V>k)return null;const a=String(b).padStart(2,"0"),M=String(j).padStart(2,"0");return`${W}-${M}-${a}`},[]),S=s.useCallback(()=>{const w=new Date,i=String(w.getDate()).padStart(2,"0"),v=String(w.getMonth()+1).padStart(2,"0"),A=w.getFullYear();return`${i}.${v}.${A}`},[]),x=s.useCallback(async()=>{if(!t||!f||L)return;const w=parseFloat(f.replace(",","."));if(isNaN(w)||w<=0||w>500){alert(h().hooks.enterValidWeight);return}const i=$(B);if(!i){alert(h().hooks.enterValidDate);return}y(!0);try{const{data:v,error:A}=await l.from("user_body_weights").upsert({user_id:t,weight:w,recorded_at:i},{onConflict:"user_id,recorded_at"}).select().single();if(A)throw A;const m=(()=>{const b=c.filter(j=>j.recorded_at!==i);return[v,...b].sort((j,W)=>new Date(W.recorded_at).getTime()-new Date(j.recorded_at).getTime())})();C(m),g(m),T(""),d(S())}catch(v){console.error("Error saving weight:",v),alert(h().hooks.failedToSaveWeight)}finally{y(!1)}},[t,f,B,L,l,$,S,c,g]),H=s.useCallback(async w=>{if(!(!t||E)){O(w);try{const{error:i}=await l.from("user_body_weights").delete().eq("id",w);if(i)throw i;const v=c.filter(A=>A.id!==w);C(v),g(v),_(!1),P(null)}catch(i){console.error("Error deleting weight:",i),alert(h().hooks.failedToDeleteWeight)}finally{O(null)}}},[t,E,l,c,g]),R=s.useCallback(w=>{P(w),_(!0)},[]),Y=s.useMemo(()=>[...c].sort((w,i)=>new Date(w.recorded_at).getTime()-new Date(i.recorded_at).getTime()).slice(-30).map(w=>({date:new Date(w.recorded_at).toLocaleDateString("ru",{day:"numeric",month:"short"}),weight:Number(w.weight),fullDate:w.recorded_at})),[c]),G=s.useMemo(()=>{if(c.length===0)return null;const w=c.map(b=>Number(b.weight)),i=w[0],v=Math.min(...w),A=Math.max(...w),m=c.length>1?i-w[w.length-1]:0;return{current:i,min:v,max:A,change:m}},[c]);return{isWeightTrackerOpen:o,bodyWeights:c,loadingWeights:N,newWeight:f,newWeightDate:B,savingWeight:L,deletingWeightId:E,isDeleteWeightConfirmOpen:J,weightToDelete:K,weightChartData:Y,weightStats:G,setIsWeightTrackerOpen:n,setNewWeight:T,setNewWeightDate:d,setIsDeleteWeightConfirmOpen:_,loadBodyWeights:Q,handleAddWeight:x,handleDeleteWeight:H,handleOpenDeleteWeightConfirm:R}}const $e=["upper","lower","push","pull","legs","arms","shoulders","chest","back","core","cardio","full"];function pe(t){if(typeof t!="string")return null;const l=t.trim();return $e.includes(l)?l:null}function fe(t){if(typeof t=="number")return Number.isFinite(t)?t:null;if(typeof t=="string"){const l=t.trim();if(l.length===0)return null;const r=Number(l.replace(",","."));return Number.isFinite(r)?r:null}return null}function te(t){const l=fe(t);if(l===null)return null;const r=Math.trunc(l);return r!==l?null:r}function me(t){if(typeof t!="string")return null;const l=t.trim();return l.length>0?l:null}function Fe({userId:t,userEmail:l}){const r=ne,[o,n]=s.useState(!1),[u,g]=s.useState(!1),[c,C]=s.useState(!1),[N,p]=s.useState(null),[f,T]=s.useState(null),[B,d]=s.useState([]),[L,y]=s.useState([]),[E,O]=s.useState("none"),[J,_]=s.useState(!1),[K,P]=s.useState(null),[Q,$]=s.useState("success"),S=s.useRef(null),x=s.useCallback(async m=>{if(!t)return;const b=Array.isArray(m.workouts)?m.workouts:[];if(b.length===0){$("error"),P(h().hooks.noWorkoutsToImport),_(!0);return}const{data:j,error:W}=await r.from("workouts").select("id, workout_date").eq("user_id",t);if(W)throw W;const X=new Set;b.forEach(a=>{const M=typeof a.date=="string"&&a.date?a.date:typeof a.workout_date=="string"&&a.workout_date?a.workout_date:"";M&&X.add(M)});const k=(j||[]).filter(a=>X.has(a.workout_date)).map(a=>a.id);if(k.length>0){const{data:a,error:M}=await r.from("workout_exercises").select("id, workout_id").in("workout_id",k);if(M)throw M;const U=(a||[]).map(I=>I.id);if(U.length>0){const{error:I}=await r.from("workout_sets").delete().in("workout_exercise_id",U);if(I)throw I}if(k.length>0){const{error:I}=await r.from("workout_exercises").delete().in("workout_id",k);if(I)throw I;const{error:z}=await r.from("workouts").delete().in("id",k);if(z)throw z}}for(const a of b){const M=typeof a.name=="string"&&a.name.trim().length>0?a.name.trim():h().hooks.importedWorkout,U=typeof a.date=="string"&&a.date?a.date:typeof a.workout_date=="string"&&a.workout_date?a.workout_date:new Date().toISOString().slice(0,10),I=typeof a.isCardio=="boolean"?a.isCardio:typeof a.is_cardio=="boolean"?a.is_cardio:!1,z=me(a.notes)??me(a.workoutNotes)??null,{data:ee,error:le}=await r.from("workouts").insert({user_id:t,name:M,icon:pe(a.icon),workout_date:U,is_cardio:I,template_id:null,notes:z}).select().single();if(le||!ee)throw le||new Error(h().hooks.failedToCreateWorkout);const F=Array.isArray(a.exercises)?a.exercises:[];if(F.length===0)continue;const Z=F.map((D,se)=>({workout_id:ee.id,name:typeof D.name=="string"?D.name:"",position:te(D.position)??se+1,reps:typeof D.reps=="string"?D.reps:typeof D.reps=="number"?String(D.reps):"",rest_seconds:typeof D.restSeconds=="number"?D.restSeconds:typeof D.restSeconds=="string"?te(D.restSeconds)??150:typeof D.rest_seconds=="number"?D.rest_seconds:typeof D.rest_seconds=="string"?te(D.rest_seconds)??150:150,sets:typeof D.setsPlanned=="number"?D.setsPlanned:typeof D.setsPlanned=="string"?te(D.setsPlanned)??1:typeof D.sets=="number"?D.sets:typeof D.sets=="string"?te(D.sets)??1:Array.isArray(D.sets)?D.sets.length:Array.isArray(D.workout_sets)?D.workout_sets.length:Array.isArray(D.workoutSets)?D.workoutSets.length:1})),{data:ae,error:de}=await r.from("workout_exercises").insert(Z).select();if(de||!ae)throw de||new Error(h().hooks.failedToCreateExercises);const ce=[],xe=[...F].sort((D,se)=>{const oe=typeof D.position=="number"?D.position:0,ie=typeof se.position=="number"?se.position:0;return oe-ie}),we=[...ae].sort((D,se)=>{const oe=typeof D.position=="number"?D.position:0,ie=typeof se.position=="number"?se.position:0;return oe-ie});if(xe.forEach((D,se)=>{const oe=we[se];if(!oe)return;(Array.isArray(D.sets)?D.sets:Array.isArray(D.workout_sets)?D.workout_sets:Array.isArray(D.workoutSets)?D.workoutSets:[]).forEach(q=>{const be=te(q.index)??te(q.set_index)??te(q.setIndex)??1,ke=typeof q.isDropset=="boolean"?q.isDropset:typeof q.is_dropset=="boolean"?q.is_dropset:!1,ye=te(q.parentSetIndex)??te(q.parent_set_index)??null;ce.push({workout_exercise_id:oe.id,set_index:be,weight:fe(q.weight),reps:q.reps==null?null:String(q.reps),is_done:typeof q.isDone=="boolean"?q.isDone:typeof q.is_done=="boolean"?q.is_done:!1,is_dropset:ke,parent_set_index:ye,updated_at:typeof q.updatedAt=="string"&&q.updatedAt?q.updatedAt:typeof q.updated_at=="string"&&q.updated_at?q.updated_at:new Date().toISOString()})})}),ce.length>0){const{error:D}=await r.from("workout_sets").insert(ce);if(D)throw D}}},[t,r]),H=s.useCallback(async()=>{if(t){n(!0);try{const{data:m,error:b}=await r.from("workouts").select(`
          id,
          name,
          icon,
          workout_date,
          is_cardio,
          template_id,
          notes,
          workout_exercises (
            id,
            name,
            position,
            reps,
            rest_seconds,
            sets,
            workout_sets (
              id,
              set_index,
              weight,
              reps,
              is_done,
              is_dropset,
              parent_set_index,
              updated_at
            )
          )
        `).eq("user_id",t).order("workout_date",{ascending:!1});if(b){console.error("Error exporting workouts:",b),alert(h().hooks.failedToLoadWorkouts);return}const j=(m||[]).map(U=>({id:U.id,name:U.name,icon:pe(U.icon),date:U.workout_date,isCardio:!!U.is_cardio,templateId:U.template_id,notes:U.notes??null,exercises:(U.workout_exercises||[]).map(I=>({id:I.id,name:I.name,position:I.position,reps:I.reps,restSeconds:I.rest_seconds,setsPlanned:I.sets,sets:(I.workout_sets||[]).map(z=>({id:z.id,index:z.set_index,weight:z.weight,reps:z.reps,isDone:z.is_done,isDropset:!!z.is_dropset,parentSetIndex:z.parent_set_index??null,updatedAt:z.updated_at}))}))})),W={schemaVersion:2,exportedAt:new Date().toISOString(),user:{id:t,email:l},workouts:j},X=JSON.stringify(W,null,2),V=new Blob([X],{type:"application/json;charset=utf-8;"}),k=URL.createObjectURL(V),a=document.createElement("a"),M=new Date().toISOString().slice(0,10);a.href=k,a.download=`gymlog-workouts-${M}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(k)}catch(m){console.error("Unexpected error while exporting workouts:",m),alert(h().hooks.unexpectedExportError)}finally{n(!1)}}},[t,l,r]),R=s.useCallback(()=>{!t||u||S.current&&(S.current.value="",S.current.click())},[t,u]),Y=s.useCallback(async m=>{const b=m.target.files&&m.target.files[0];if(b)try{d([]),y([]);const j=await b.text();let W;try{W=JSON.parse(j)}catch{$("error"),P(h().hooks.invalidJsonFile),_(!0);return}if(!W||!Array.isArray(W.workouts)){$("error"),P(h().hooks.notGymLogExport),_(!0);return}if(!t)return;const X=Array.isArray(W.workouts)?W.workouts:[],V=new Set;X.forEach(F=>{const Z=typeof F.date=="string"&&F.date?F.date:typeof F.workout_date=="string"&&F.workout_date?F.workout_date:"";Z&&V.add(Z)});const{data:k,error:a}=await r.from("workouts").select("workout_date").eq("user_id",t);if(a){console.error("Error checking existing workouts before import:",a),$("error"),P(h().hooks.failedToCheckExisting),_(!0);return}const M=new Set((k||[]).map(F=>F.workout_date)),U=M.size>0,I=new Map;X.forEach(F=>{const Z=typeof F.date=="string"&&F.date?F.date:typeof F.workout_date=="string"&&F.workout_date?F.workout_date:"";Z&&I.set(Z,(I.get(Z)||0)+1)});const z=[],ee=[];V.forEach(F=>{M.has(F)?z.push(F):ee.push(F)});const le=z.length>0;if(!U||!le){$("success"),g(!0);try{await x(W),P(h().hooks.importComplete),_(!0)}catch(F){console.error("Error importing workouts:",F),alert(h().hooks.failedToImport+((F==null?void 0:F.message)||String(F)))}finally{g(!1)}return}if(ee.length===0){$("error"),P(h().hooks.allWorkoutsExist),_(!0);return}if(p(W),T(b.name),ee.length>0){const F=ee.map(Z=>({date:Z,count:I.get(Z)||0})).sort((Z,ae)=>ae.date.localeCompare(Z.date));d(ee),y(F)}else d([]),y([]);C(!0)}catch(j){console.error("Error reading workouts import file:",j),alert(h().hooks.failedToReadFile)}finally{m.target.value=""}},[t,r,x]),G=s.useCallback(async()=>{if(N){O("import"),g(!0);try{await x(N),p(null),T(null),d([]),y([]),C(!1),$("success"),P(h().hooks.importComplete),_(!0)}catch(m){console.error("Error importing workouts:",m),alert(h().hooks.failedToImport+((m==null?void 0:m.message)||String(m)))}finally{g(!1),O("none")}}},[N,x]),w=s.useCallback(async()=>{if(!N)return;const m=Array.isArray(N.workouts)?N.workouts:[];if(m.length===0){$("error"),P(h().hooks.noWorkoutsToImport),_(!0);return}const b=new Set(B);if(b.size===0){$("error"),P(h().hooks.noNewWorkoutsInFile),_(!0);return}const j=m.filter(W=>{const X=typeof W.date=="string"&&W.date?W.date:typeof W.workout_date=="string"&&W.workout_date?W.workout_date:"";return!!X&&b.has(X)});if(j.length===0){$("error"),P(h().hooks.failedToDetermineNew),_(!0);return}O("onlyNew"),g(!0);try{await x({workouts:j}),p(null),T(null),d([]),y([]),C(!1),$("success"),P(h().hooks.newWorkoutsImportComplete),_(!0)}catch(W){console.error("Error importing only new workouts:",W),$("error"),P(h().hooks.failedToImportNew),_(!0)}finally{g(!1),O("none")}},[N,B,x]),i=s.useCallback(async()=>{if(N){O("exportThenImport"),g(!0);try{await H(),await x(N),p(null),T(null),C(!1),$("success"),P(h().hooks.exportThenImportComplete),_(!0)}catch(m){console.error("Error exporting and importing workouts:",m),$("error"),P(h().hooks.failedExportThenImport),_(!0)}finally{g(!1),O("none")}}},[N,H,x]),v=s.useCallback(()=>{C(!1),p(null),T(null),d([]),y([])},[]),A=s.useCallback(()=>{_(!1),P(null)},[]);return{isExporting:o,isImportingWorkouts:u,isWorkoutsImportDialogOpen:c,pendingWorkoutsImport:N,pendingWorkoutsFileName:f,pendingWorkoutsNewDates:B,pendingWorkoutsNewDatesSummary:L,importAction:E,isImportSuccessOpen:J,importSuccessMessage:K,toastVariant:Q,workoutsFileInputRef:S,handleExportWorkouts:H,handleStartImportWorkouts:R,handleWorkoutsFileChange:Y,handleConfirmImportWorkoutsOnly:G,handleImportOnlyNewWorkouts:w,handleExportThenImportWorkouts:i,closeWorkoutsImportDialog:v,closeImportSuccessToast:A,setIsImportSuccessOpen:_,setImportSuccessMessage:P,setToastVariant:$}}const Pe=["upper","lower","push","pull","legs","arms","shoulders","chest","back","core","cardio","full"];function he(t){if(typeof t!="string")return null;const l=t.trim();return Pe.includes(l)?l:null}function Re({userId:t,userEmail:l,setToastVariant:r,setImportSuccessMessage:o,setIsImportSuccessOpen:n}){const u=ne,[g,c]=s.useState(!1),[C,N]=s.useState(!1),[p,f]=s.useState(!1),[T,B]=s.useState([]),[d,L]=s.useState([]),[y,E]=s.useState("none"),O=s.useRef(null),J=s.useCallback(async x=>{if(!t)return;const H=Array.isArray(x.templates)?x.templates:[];if(H.length===0){r("error"),o(h().hooks.noTemplatesToImport),n(!0);return}for(const R of H){const Y=typeof R.name=="string"&&R.name.trim().length>0?R.name.trim():h().hooks.importedTemplate,{data:G,error:w}=await u.from("workout_templates").insert({user_id:t,name:Y,icon:he(R.icon)}).select().single();if(w||!G)throw w||new Error(h().hooks.failedToCreateTemplate);const i=Array.isArray(R.exercises)?R.exercises:[];if(i.length===0)continue;const v=i.map((m,b)=>({template_id:G.id,name:typeof m.name=="string"?m.name:"",sets:typeof m.sets=="number"?m.sets:1,reps:typeof m.reps=="string"?m.reps:"",rest_seconds:typeof m.restSeconds=="number"?m.restSeconds:typeof m.rest_seconds=="number"?m.rest_seconds:150,position:typeof m.position=="number"?m.position:b+1})),{error:A}=await u.from("template_exercises").insert(v);if(A)throw A}},[t,u,r,o,n]),_=s.useCallback(async()=>{if(t){c(!0);try{const{data:x,error:H}=await u.from("workout_templates").select(`
          id,
          name,
          icon,
          created_at,
          template_exercises (
            id,
            name,
            sets,
            reps,
            rest_seconds,
            position
          )
        `).eq("user_id",t).order("created_at",{ascending:!1});if(H){console.error("Error exporting templates:",H),alert(h().hooks.failedToLoadTemplates);return}const R=(x||[]).map(m=>({id:m.id,name:m.name,icon:he(m.icon),createdAt:m.created_at,exercises:(m.template_exercises||[]).map(b=>({id:b.id,name:b.name,sets:b.sets,reps:b.reps,restSeconds:b.rest_seconds,position:b.position}))})),Y={exportedAt:new Date().toISOString(),user:{id:t,email:l},templates:R},G=JSON.stringify(Y,null,2),w=new Blob([G],{type:"application/json;charset=utf-8;"}),i=URL.createObjectURL(w),v=document.createElement("a"),A=new Date().toISOString().slice(0,10);v.href=i,v.download=`gymlog-templates-${A}.json`,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(i)}catch(x){console.error("Unexpected error while exporting templates:",x),alert(h().hooks.unexpectedTemplatesExportError)}finally{c(!1)}}},[t,l,u]),K=s.useCallback(()=>{!t||C||O.current&&(O.current.value="",O.current.click())},[t,C]),P=s.useCallback(async x=>{const H=x.target.files&&x.target.files[0];if(H)try{const R=await H.text();let Y;try{Y=JSON.parse(R)}catch{r("error"),o(h().hooks.invalidJsonFile),n(!0);return}if(!Y||!Array.isArray(Y.templates)){r("error"),o(h().hooks.notGymLogTemplatesExport),n(!0);return}if(!t)return;const G=Array.isArray(Y.templates)?Y.templates:[];if(G.length===0){r("error"),o(h().hooks.noTemplatesToImport),n(!0);return}const{data:w,error:i}=await u.from("workout_templates").select("id, name").eq("user_id",t);if(i){console.error("Error checking existing templates before import:",i),r("error"),o(h().hooks.failedToCheckExistingTemplates),n(!0);return}const v=j=>typeof j=="string"?j.trim().toLowerCase():"",A=new Map;(w||[]).forEach(j=>{const W=v(j.name);W&&(A.has(W)||A.set(W,{id:j.id,name:j.name||""}))});const m=[],b=[];if(G.forEach(j=>{const W=v(j==null?void 0:j.name);if(!W||!A.has(W))m.push(j);else{const X=A.get(W);b.push({existingId:X.id,existingName:X.name||"",template:j})}}),m.length===0&&b.length>0){r("error"),o(h().hooks.allTemplatesExist),n(!0);return}if(b.length===0){N(!0);try{await J({templates:G}),r("success"),o(h().hooks.templatesImportComplete),n(!0)}catch(j){console.error("Error importing templates:",j),r("error"),o(h().hooks.failedToImportTemplates),n(!0)}finally{N(!1)}return}B(m),L(b),f(!0)}catch(R){console.error("Error importing templates:",R),r("error"),o(h().hooks.failedToImportTemplates),n(!0)}finally{N(!1),x.target.value=""}},[t,u,J,r,o,n]),Q=s.useCallback(async()=>{if(T.length===0){f(!1),L([]),B([]),r("error"),o(h().hooks.allTemplatesExist),n(!0);return}E("onlyNew"),N(!0);try{await J({templates:T}),B([]),L([]),f(!1),r("success"),o(h().hooks.newTemplatesImportComplete),n(!0)}catch(x){console.error("Error importing only new templates:",x),r("error"),o(h().hooks.failedToImportNewTemplates),n(!0)}finally{N(!1),E("none")}},[T,J,r,o,n]),$=s.useCallback(async()=>{if(d.length===0&&T.length===0){f(!1);return}E("overwrite"),N(!0);try{const x=Array.from(new Set(d.map(R=>R.existingId)));if(x.length>0){const{error:R}=await u.from("template_exercises").delete().in("template_id",x);if(R)throw R;const{error:Y}=await u.from("workout_templates").delete().in("id",x);if(Y)throw Y}const H=[...T,...d.map(R=>R.template)];await J({templates:H}),B([]),L([]),f(!1),r("success"),o(h().hooks.templatesOverwriteComplete),n(!0)}catch(x){console.error("Error overwriting templates:",x),alert(h().hooks.failedToOverwriteTemplates+((x==null?void 0:x.message)||String(x)))}finally{N(!1),E("none")}},[d,T,u,J,r,o,n]),S=s.useCallback(()=>{f(!1),B([]),L([])},[]);return{isExportingTemplates:g,handleExportTemplates:_,isImportingTemplates:C,isTemplatesImportDialogOpen:p,pendingTemplatesNew:T,pendingTemplatesDuplicates:d,templatesImportAction:y,templatesFileInputRef:O,handleStartImportTemplates:K,handleTemplatesFileChange:P,handleImportTemplatesOnlyNew:Q,handleImportTemplatesOverwrite:$,closeTemplatesImportDialog:S}}function Be({userId:t,setToastVariant:l,setImportSuccessMessage:r,setIsImportSuccessOpen:o}){const n=ne,[u,g]=s.useState(!1),[c,C]=s.useState(!1),[N,p]=s.useState(!1),[f,T]=s.useState([]),[B,d]=s.useState([]),[L,y]=s.useState(!1),[E,O]=s.useState(!1),[J,_]=s.useState(!1),[K,P]=s.useState([]),[Q,$]=s.useState([]),[S,x]=s.useState(!1),H=f.length>0&&B.length===f.length,R=K.length>0&&Q.length===K.length,Y=s.useCallback(async()=>{if(!(!t||N)){p(!0),d([]);try{const{data:k,error:a}=await n.from("workouts").select("id, workout_date").eq("user_id",t).order("workout_date",{ascending:!1});if(a){console.error("Error loading workouts for deletion:",a),alert(h().hooks.failedToLoadWorkoutsForDeletion);return}const M=new Map;(k||[]).forEach(I=>{const z=I.workout_date,ee=I.id;!z||!ee||(M.has(z)||M.set(z,[]),M.get(z).push(ee))});const U=Array.from(M.entries()).map(([I,z])=>({date:I,workoutIds:z,count:z.length})).sort((I,z)=>z.date.localeCompare(I.date));if(U.length===0){l("error"),r(h().hooks.noWorkoutsToDelete),o(!0);return}T(U),g(!1),C(!0)}catch(k){console.error("Unexpected error while loading workouts for deletion:",k),alert(h().hooks.errorLoadingWorkoutsForDeletion)}finally{p(!1)}}},[t,N,n,l,r,o]),G=s.useCallback(async()=>{if(!(!t||J)){_(!0),$([]);try{const{data:k,error:a}=await n.from("workout_templates").select("id, name").eq("user_id",t).order("created_at",{ascending:!1});if(a){console.error("Error loading templates for deletion:",a),alert(h().hooks.failedToLoadTemplatesForDeletion);return}const M=(k||[]).map(U=>({id:U.id,name:U.name||h().hooks.noName}));if(M.length===0){l("error"),r(h().hooks.noTemplatesToDelete),o(!0);return}P(M),g(!1),O(!0)}catch(k){console.error("Unexpected error while loading templates for deletion:",k),alert(h().hooks.errorLoadingTemplatesForDeletion)}finally{_(!1)}}},[t,J,n,l,r,o]),w=s.useCallback(k=>{d(a=>a.includes(k)?a.filter(M=>M!==k):[...a,k])},[]),i=s.useCallback(()=>{if(f.length===0)return;const k=B.length===f.length;d(k?[]:f.map(a=>a.date))},[f,B.length]),v=s.useCallback(()=>{d([])},[]),A=s.useCallback(k=>{$(a=>a.includes(k)?a.filter(M=>M!==k):[...a,k])},[]),m=s.useCallback(()=>{if(K.length===0)return;const k=Q.length===K.length;$(k?[]:K.map(a=>a.id))},[K,Q.length]),b=s.useCallback(()=>{$([])},[]),j=s.useCallback(async()=>{if(!t||B.length===0)return;const k=f.filter(a=>B.includes(a.date)).flatMap(a=>a.workoutIds);if(k.length!==0){y(!0);try{const{data:a,error:M}=await n.from("workout_exercises").select("id, workout_id").in("workout_id",k);if(M)throw M;const U=(a||[]).map(I=>I.id);if(U.length>0){const{error:I}=await n.from("workout_sets").delete().in("workout_exercise_id",U);if(I)throw I}if(k.length>0){const{error:I}=await n.from("workout_exercises").delete().in("workout_id",k);if(I)throw I;const{error:z}=await n.from("workouts").delete().in("id",k);if(z)throw z}C(!1),T([]),d([]),l("success"),r(h().hooks.workoutsDeletedSuccess),o(!0)}catch(a){console.error("Error deleting workouts:",a),l("error"),r(h().hooks.failedToDeleteWorkouts),o(!0)}finally{y(!1)}}},[t,B,f,n,l,r,o]),W=s.useCallback(async()=>{if(t&&Q.length!==0){x(!0);try{const k=Q;if(k.length>0){const{error:a}=await n.from("template_exercises").delete().in("template_id",k);if(a)throw a;const{error:M}=await n.from("workout_templates").delete().in("id",k);if(M)throw M}O(!1),P([]),$([]),l("success"),r(h().hooks.templatesDeletedSuccess),o(!0)}catch(k){console.error("Error deleting templates:",k),l("error"),r(h().hooks.failedToDeleteTemplates),o(!0)}finally{x(!1)}}},[t,Q,n,l,r,o]),X=s.useCallback(()=>{L||C(!1)},[L]),V=s.useCallback(()=>{S||O(!1)},[S]);return{isCleanDataDialogOpen:u,setIsCleanDataDialogOpen:g,isDeleteWorkoutsDialogOpen:c,isLoadingWorkoutsForDeletion:N,workoutDateGroups:f,selectedWorkoutDates:B,isDeletingWorkouts:L,areAllWorkoutDatesSelected:H,isDeleteTemplatesDialogOpen:E,isLoadingTemplatesForDeletion:J,templatesForDeletion:K,selectedTemplateIds:Q,isDeletingTemplates:S,areAllTemplatesSelected:R,openDeleteWorkoutsDialog:Y,toggleWorkoutDateSelection:w,selectAllWorkoutDates:i,clearWorkoutSelection:v,handleDeleteSelectedWorkouts:j,closeDeleteWorkoutsDialog:X,openDeleteTemplatesDialog:G,toggleTemplateSelection:A,selectAllTemplates:m,clearTemplateSelection:b,handleDeleteSelectedTemplates:W,closeDeleteTemplatesDialog:V}}function ze(t){if(!t||typeof t!="string")return t;const l=t.split("-");if(l.length===3){const[r,o,n]=l;if(r&&o&&n)return`${n}.${o}.${r}`}return t}function He(t,l){const r=t.replace(/[^0-9.]/g,""),o=r.split(".");let n=o[0]||"",u=o[1]||"",g=o[2]||"";n=n.slice(0,2),u=u.slice(0,2),g=g.slice(0,4);const c=r.length>l.replace(/[^0-9.]/g,"").length;return o.length===1&&n.length===2&&c?`${n}.`:o.length===2&&u.length===2&&c?`${n}.${u}.`:o.length===1?n:o.length===2?`${n}.${u}`:`${n}.${u}.${g}`}function Ue({isOpen:t,onClose:l,bodyWeights:r,loadingWeights:o,weightChartData:n,weightStats:u,newWeight:g,newWeightDate:c,savingWeight:C,deletingWeightId:N,isDeleteWeightConfirmOpen:p,weightToDelete:f,setNewWeight:T,setNewWeightDate:B,setIsDeleteWeightConfirmOpen:d,handleAddWeight:L,handleDeleteWeight:y,handleOpenDeleteWeightConfirm:E}){const[O,J]=s.useState(null),[_,K]=s.useState(0),P=7,Q=s.useRef(null),$=144,S=8;s.useEffect(()=>(t?(document.body.style.overflow="hidden",document.body.style.touchAction="none"):(document.body.style.overflow="",document.body.style.touchAction=""),()=>{document.body.style.overflow="",document.body.style.touchAction=""}),[t]),s.useEffect(()=>{K(0)},[r.length]);const x=s.useCallback((i,v)=>{var a;if((a=i==null?void 0:i.stopPropagation)==null||a.call(i),!v)return;const A=Q.current,m=i==null?void 0:i.currentTarget;if(!A||!m||typeof m.getBoundingClientRect!="function")return;const b=A.getBoundingClientRect(),j=m.getBoundingClientRect(),W=j.left+j.width/2-b.left,X=j.top+j.height/2-b.top,V=$/2,k=Math.max(V+S,Math.min(W,b.width-V-S));J({date:v.date,weight:v.weight,x:k,y:X})},[S,$]),H=s.useCallback(()=>{J(null)},[]),R=s.useCallback(i=>{const{cx:v,cy:A,payload:m,index:b}=i;return e.jsx("circle",{cx:v,cy:A,r:4,fill:"#3b82f6",stroke:"none",style:{cursor:"pointer"},onClick:j=>x(j,m)},`dot-${b}`)},[x]),Y=s.useCallback(i=>{const{cx:v,cy:A,payload:m,index:b}=i;return e.jsx("circle",{cx:v,cy:A,r:6,fill:"#60a5fa",stroke:"#fff",strokeWidth:2,style:{cursor:"pointer"},onClick:j=>x(j,m)},`active-dot-${b}`)},[x]),G=Math.ceil(r.length/P),w=r.slice(_*P,(_+1)*P);return t?Ne.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-start justify-center px-4",style:{paddingTop:"calc(env(safe-area-inset-top, 0px) + 16px)",paddingBottom:"calc(96px + env(safe-area-inset-bottom))"},onTouchMove:i=>i.stopPropagation(),children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:l,onTouchMove:i=>i.preventDefault()}),e.jsxs("div",{className:"relative glass card-dark p-5 rounded-2xl max-w-md w-full my-auto flex flex-col",style:{maxHeight:"calc(100dvh - env(safe-area-inset-top, 0px) - env(safe-area-inset-bottom) - 120px)"},onClick:i=>i.stopPropagation(),children:[e.jsx("button",{type:"button",onClick:l,className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 transition-colors flex items-center justify-center",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-xl font-semibold text-white pr-10",children:"Ð¢Ñ€ÐµÐºÐµÑ€ Ð²ÐµÑÐ° Ñ‚ÐµÐ»Ð°"}),e.jsxs("div",{className:"mt-4 space-y-4 overflow-y-auto custom-scrollbar pr-1 flex-1 min-h-0",children:[e.jsxs("div",{className:"space-y-3 p-3 rounded-lg bg-white/5 border border-white/10",children:[e.jsx("p",{className:"text-sm text-gray-300 font-medium",children:"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð·Ð°Ð¿Ð¸ÑÑŒ"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Ð’ÐµÑ (ÐºÐ³)"}),e.jsx("input",{type:"text",inputMode:"decimal",value:g,onChange:i=>{const v=i.target.value.replace(".",",");/^[0-9]*[,]?[0-9]*$/.test(v)&&T(v)},placeholder:"70,25",className:"w-full h-10 px-3 rounded-lg bg-white/10 border border-white/20 text-white text-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Ð”Ð°Ñ‚Ð°"}),e.jsx("input",{type:"text",inputMode:"numeric",value:c,onChange:i=>{const v=He(i.target.value,c);B(v)},placeholder:"8.12.2025",maxLength:10,className:"w-full h-10 px-3 rounded-lg bg-white/10 border border-white/20 text-white text-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"button",onClick:L,disabled:!g||!c||C,className:"btn-glass btn-glass-sm btn-glass-primary disabled:opacity-50",children:C?"...":"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ"})})]}),u&&e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-white/5 text-center",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹"}),e.jsxs("p",{className:"text-lg font-bold text-white",children:[u.current.toFixed(2).replace(".",",")," ÐºÐ³"]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-white/5 text-center",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"ÐœÐ¸Ð½"}),e.jsxs("p",{className:"text-lg font-bold text-green-400",children:[u.min.toFixed(2).replace(".",",")," ÐºÐ³"]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-white/5 text-center",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"ÐœÐ°ÐºÑ"}),e.jsxs("p",{className:"text-lg font-bold text-orange-400",children:[u.max.toFixed(2).replace(".",",")," ÐºÐ³"]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-white/5 text-center",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ"}),e.jsxs("p",{className:`text-lg font-bold ${u.change>0?"text-red-400":u.change<0?"text-green-400":"text-gray-400"}`,children:[u.change>0?"+":"",u.change.toFixed(2).replace(".",",")," ÐºÐ³"]})]})]}),n.length>1&&e.jsxs("div",{className:"relative",onClick:H,ref:Q,children:[e.jsx("div",{className:"overflow-x-auto pb-2",children:e.jsx("div",{style:{minWidth:`${Math.max(n.length*50,100)}px`,height:"192px"},children:e.jsx(Te,{width:"100%",height:"100%",children:e.jsxs(_e,{data:n,margin:{top:15,right:20,left:-20,bottom:5},children:[e.jsx(Se,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),e.jsx(Ee,{dataKey:"date",tick:{fill:"#9ca3af",fontSize:10},axisLine:{stroke:"rgba(255,255,255,0.2)"},tickLine:!1}),e.jsx(Ae,{domain:["dataMin - 2","dataMax + 2"],tick:{fill:"#9ca3af",fontSize:10},axisLine:{stroke:"rgba(255,255,255,0.2)"},tickLine:!1,tickFormatter:i=>Number(i).toFixed(2).replace(".",",")}),e.jsx(Ie,{type:"monotone",dataKey:"weight",stroke:"#3b82f6",strokeWidth:2,dot:R,activeDot:Y,isAnimationActive:!1})]})})})}),O&&e.jsxs("div",{className:"absolute pointer-events-none w-36 text-center",style:{left:`${O.x}px`,top:`${O.y}px`,transform:"translate(-50%, calc(-100% - 12px))",background:"rgba(255,255,255,0.98)",border:"1px solid rgba(0,0,0,0.08)",borderRadius:"8px",padding:"8px 12px",color:"#111827",boxShadow:"0 10px 30px rgba(0,0,0,0.12)",zIndex:20},children:[e.jsx("p",{className:"text-sm text-gray-600 truncate",children:O.date}),e.jsxs("p",{className:"text-sm font-medium truncate",children:[e.jsx("span",{className:"text-gray-500",children:"Ð’ÐµÑ : "}),e.jsxs("span",{className:"text-green-600",children:[O.weight.toFixed(2).replace(".",",")," ÐºÐ³"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-300 font-medium",children:["Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ (",r.length,")"]}),G>1&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>K(i=>Math.max(0,i-1)),disabled:_===0,className:"w-7 h-7 rounded-lg bg-white/10 hover:bg-white/20 disabled:opacity-30 disabled:hover:bg-white/10 transition-colors flex items-center justify-center",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),e.jsxs("span",{className:"text-xs text-gray-400 min-w-[40px] text-center",children:[_+1," / ",G]}),e.jsx("button",{type:"button",onClick:()=>K(i=>Math.min(G-1,i+1)),disabled:_>=G-1,className:"w-7 h-7 rounded-lg bg-white/10 hover:bg-white/20 disabled:opacity-30 disabled:hover:bg-white/10 transition-colors flex items-center justify-center",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})})]})]}),o?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"})}):r.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"ÐŸÐ¾ÐºÐ° Ð½ÐµÑ‚ Ð·Ð°Ð¿Ð¸ÑÐµÐ¹. Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ ÑÐ²Ð¾Ð¹ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð²ÐµÑ Ð²Ñ‹ÑˆÐµ."}):e.jsx("div",{className:"space-y-1",children:w.map(i=>e.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] items-center gap-3 px-3 py-2 rounded-lg bg-white/5 hover:bg-white/10 transition-colors",children:[e.jsxs("span",{className:"text-white font-medium tabular-nums",children:[Number(i.weight).toFixed(2).replace(".",",")," ÐºÐ³"]}),e.jsx("span",{className:"text-sm text-gray-400 tabular-nums text-right",children:ze(new Date(i.recorded_at).toISOString().slice(0,10))}),e.jsx("button",{type:"button",onClick:()=>E(i.id),disabled:N===i.id,className:"p-1 text-gray-500 hover:text-red-400 transition-colors disabled:opacity-50",children:N===i.id?e.jsx("span",{className:"w-4 h-4 border border-white/30 border-t-white rounded-full animate-spin inline-block"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},i.id))})]})]})]}),e.jsx(ge,{open:p,onOpenChange:d,title:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð·Ð°Ð¿Ð¸ÑÑŒ Ð¾ Ð²ÐµÑÐµ?",description:"Ð­Ñ‚Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð½ÐµÐ¾Ð±Ñ€Ð°Ñ‚Ð¸Ð¼Ð¾.",confirmText:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ",cancelText:"ÐžÑ‚Ð¼ÐµÐ½Ð°",variant:"danger",onConfirm:()=>{f&&y(f)}})]}),document.body):null}function Ye({isOpen:t,onClose:l,isLoadingWorkoutsForDeletion:r,isLoadingTemplatesForDeletion:o,openDeleteWorkoutsDialog:n,openDeleteTemplatesDialog:u}){const{t:g}=re();if(!t)return null;const c=r||o;return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>{c||l()}}),e.jsxs("div",{className:"relative w-full max-w-md glass card-dark rounded-xl shadow-xl p-5 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:g.cleanData.title}),e.jsx("p",{className:"text-sm text-gray-300",children:g.cleanData.description}),c&&e.jsx("p",{className:"text-xs text-gray-400",children:g.cleanData.loading}),e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[e.jsx("button",{type:"button",onClick:n,disabled:c,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary disabled:opacity-50",children:g.cleanData.deleteWorkouts}),e.jsx("button",{type:"button",onClick:u,disabled:c,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary disabled:opacity-50",children:g.cleanData.deleteTemplates}),e.jsx("button",{type:"button",onClick:()=>{c||l()},className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary bg-white/10 hover:bg-white/5",children:g.common.cancel})]})]})]})}function qe({isOpen:t,onClose:l,workoutDateGroups:r,selectedWorkoutDates:o,isDeletingWorkouts:n,areAllWorkoutDatesSelected:u,toggleWorkoutDateSelection:g,selectAllWorkoutDates:c,clearWorkoutSelection:C,handleDeleteSelectedWorkouts:N}){const{t:p}=re();return t?e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>{n||l()}}),e.jsxs("div",{className:"relative w-full max-w-md glass card-dark rounded-xl shadow-xl p-5 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:p.deleteWorkouts.title}),e.jsx("p",{className:"text-sm text-gray-300",children:p.deleteWorkouts.description}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-300",children:[e.jsxs("button",{type:"button",onClick:c,disabled:r.length===0||n,className:"inline-flex items-center gap-2 disabled:opacity-40",children:[e.jsx("div",{className:`w-4 h-4 rounded-md border flex items-center justify-center ${u?"bg-green-500 border-green-400":"border-white/40"}`,children:u&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-7.25 7.25a1 1 0 01-1.414 0l-3.25-3.25a1 1 0 111.414-1.414L8.5 11.836l6.543-6.543a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("span",{children:p.deleteWorkouts.selectAll})]}),e.jsx("button",{type:"button",onClick:C,disabled:o.length===0||n,className:"text-xs text-gray-400 hover:text-gray-200 disabled:opacity-40",children:p.deleteWorkouts.clearSelection})]}),e.jsxs("div",{className:"max-h-64 overflow-y-auto rounded-md bg-black/20 p-3 space-y-2",children:[r.map(f=>{const T=o.includes(f.date);return e.jsxs("button",{type:"button",onClick:()=>g(f.date),className:`w-full flex items-center justify-between px-3 py-2 rounded-md border text-left transition-colors ${T?"bg-white/10 border-green-400":"bg-transparent border-white/10 hover:bg-white/5"}`,children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:f.date}),e.jsx("div",{className:"text-xs text-gray-400",children:f.count===1?p.deleteWorkouts.workout:p.deleteWorkouts.workouts.replace("{count}",String(f.count))})]}),e.jsx("div",{className:`w-5 h-5 rounded-md border flex items-center justify-center ${T?"bg-green-500 border-green-400":"border-white/40"}`,children:T&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-7.25 7.25a1 1 0 01-1.414 0l-3.25-3.25a1 1 0 111.414-1.414L8.5 11.836l6.543-6.543a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},f.date)}),r.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:p.deleteWorkouts.noWorkouts})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[e.jsx("button",{type:"button",onClick:N,disabled:o.length===0||n,className:"btn-glass btn-glass-full btn-glass-md btn-glass-primary disabled:opacity-50",children:n?p.deleteWorkouts.deleting:p.deleteWorkouts.deleteSelected}),e.jsx("button",{type:"button",onClick:()=>{n||l()},className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:p.common.cancel})]})]})]}):null}function Ge({isOpen:t,onClose:l,templatesForDeletion:r,selectedTemplateIds:o,isDeletingTemplates:n,areAllTemplatesSelected:u,toggleTemplateSelection:g,selectAllTemplates:c,clearTemplateSelection:C,handleDeleteSelectedTemplates:N}){const{t:p}=re();return t?e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>{n||l()}}),e.jsxs("div",{className:"relative w-full max-w-md glass card-dark rounded-xl shadow-xl p-5 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:p.deleteTemplates.title}),e.jsx("p",{className:"text-sm text-gray-300",children:p.deleteTemplates.description}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-300",children:[e.jsxs("button",{type:"button",onClick:c,disabled:r.length===0||n,className:"inline-flex items-center gap-2 disabled:opacity-40",children:[e.jsx("div",{className:`w-4 h-4 rounded-md border flex items-center justify-center ${u?"bg-green-500 border-green-400":"border-white/40"}`,children:u&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-7.25 7.25a1 1 0 01-1.414 0l-3.25-3.25a1 1 0 111.414-1.414L8.5 11.836l6.543-6.543a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("span",{children:p.deleteWorkouts.selectAll})]}),e.jsx("button",{type:"button",onClick:C,disabled:o.length===0||n,className:"text-xs text-gray-400 hover:text-gray-200 disabled:opacity-40",children:p.deleteWorkouts.clearSelection})]}),e.jsxs("div",{className:"max-h-64 overflow-y-auto rounded-md bg-black/20 p-3 space-y-2",children:[r.map(f=>{const T=o.includes(f.id);return e.jsxs("button",{type:"button",onClick:()=>g(f.id),className:`w-full flex items-center justify-between px-3 py-2 rounded-md border text-left transition-colors ${T?"bg-white/10 border-green-400":"bg-transparent border-white/10 hover:bg-white/5"}`,children:[e.jsx("div",{className:"text-sm font-medium text-white",children:f.name}),e.jsx("div",{className:`w-5 h-5 rounded-md border flex items-center justify-center ${T?"bg-green-500 border-green-400":"border-white/40"}`,children:T&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-7.25 7.25a1 1 0 01-1.414 0l-3.25-3.25a1 1 0 111.414-1.414L8.5 11.836l6.543-6.543a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},f.id)}),r.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:p.deleteTemplates.noTemplates})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[e.jsx("button",{type:"button",onClick:N,disabled:o.length===0||n,className:"btn-glass btn-glass-full btn-glass-md btn-glass-primary disabled:opacity-50",children:n?p.deleteTemplates.deleting:p.deleteTemplates.deleteSelected}),e.jsx("button",{type:"button",onClick:()=>{n||l()},className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:p.common.cancel})]})]})]}):null}function Je({isImportingWorkouts:t,isImportingTemplates:l,handleStartImportWorkouts:r,handleStartImportTemplates:o,isExporting:n,isExportingTemplates:u,handleExportWorkouts:g,handleExportTemplates:c,isDeleting:C,startCleanDataFlow:N,startDeleteAccountFlow:p}){const[f,T]=s.useState(!1),B=s.useRef(null),{t:d}=re();return s.useEffect(()=>{const L=y=>{B.current&&!B.current.contains(y.target)&&T(!1)};if(f)return document.addEventListener("click",L),()=>document.removeEventListener("click",L)},[f]),e.jsxs("div",{className:"relative",ref:B,children:[e.jsx("button",{onClick:()=>T(!f),className:"p-2 text-white hover:text-gray-300 transition-colors","aria-label":d.profile.menu,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 8c1.1 0 2-1 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 1-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 1-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})})}),f&&e.jsxs("div",{className:"absolute right-0 mt-2 menu-popover space-y-0.5",children:[e.jsx("div",{className:"px-4 pt-2 pb-0 text-[11px] font-semibold uppercase tracking-wide text-gray-400 text-center whitespace-nowrap",children:d.profile.import}),e.jsx("button",{onClick:()=>{T(!1),r()},disabled:t,className:"w-full text-left px-4 py-1.5 text-sm text-white hover:bg-white/5 disabled:opacity-50 transition-colors rounded-lg",children:t?d.profile.importingWorkouts:d.profile.workouts}),e.jsx("button",{onClick:()=>{T(!1),o()},disabled:l,className:"w-full text-left px-4 py-1.5 text-sm text-white hover:bg-white/5 disabled:opacity-50 transition-colors rounded-lg",children:l?d.profile.importingTemplates:d.nav.templates}),e.jsx("div",{className:"px-4 pt-1 pb-0 text-[11px] font-semibold uppercase tracking-wide text-gray-400 text-center whitespace-nowrap",children:d.profile.export}),e.jsx("button",{onClick:async()=>{T(!1),await g()},disabled:n,className:"w-full text-left px-4 py-1.5 text-sm text-white hover:bg-white/5 disabled:opacity-50 transition-colors rounded-lg",children:n?d.profile.exportingWorkouts:d.profile.workouts}),e.jsx("button",{onClick:async()=>{T(!1),await c()},disabled:u,className:"w-full text-left px-4 py-1.5 text-sm text-white hover:bg-white/5 disabled:opacity-50 transition-colors rounded-lg",children:u?d.profile.exportingTemplates:d.nav.templates}),e.jsx("div",{className:"px-4 pt-1 pb-0 text-[11px] font-semibold uppercase tracking-wide text-gray-400 text-center whitespace-nowrap",children:d.profile.dataAndAccount}),e.jsx("button",{onClick:()=>{T(!1),N()},className:"w-full text-left px-4 py-1.5 text-sm text-white hover:bg-white/5 transition-colors rounded-lg",children:d.profile.cleanData}),e.jsx("button",{onClick:()=>{T(!1),p()},disabled:C,className:"w-full text-left px-4 py-1.5 text-sm text-red-400 hover:bg-red-500/10 disabled:opacity-50 transition-colors rounded-lg",children:C?d.profile.deletingAccount:d.profile.deleteAccount})]})]})}function Ke({isOpen:t,timerStepInput:l,setTimerStepInput:r,saveStatus:o,saveTimerStep:n,theme:u,handleThemeChange:g}){const{t:c,language:C,setLanguage:N}=re();return t?e.jsxs("div",{className:"glass card-dark rounded-lg p-4 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:c.settings.title}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm text-gray-300",children:c.settings.timerStep}),e.jsx("p",{className:"text-xs text-gray-500",children:c.settings.timerStepDesc}),e.jsxs("div",{className:"flex items-center justify-center gap-3 flex-wrap",children:[e.jsx("input",{type:"number",min:"1",max:"300",value:l,onChange:p=>r(p.target.value),className:"w-24 px-3 py-2 rounded-lg bg-white/10 border border-white/20 text-white text-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsxs("button",{type:"button",onClick:n,disabled:o==="saving",className:"btn-glass btn-glass-primary flex items-center justify-center gap-2 !py-2 !px-4 min-w-[104px]",children:[o==="saving"&&e.jsx("span",{"aria-label":c.settings.saving,className:"h-5 w-5 inline-block border-2 border-white/70 border-t-transparent rounded-full animate-spin"}),o==="success"&&e.jsx("svg",{"aria-label":c.settings.saved,xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),o==="idle"&&c.common.save]})]})]}),e.jsxs("div",{className:"border-t border-white/10 pt-4 space-y-2",children:[e.jsx("label",{className:"block text-sm text-gray-300",children:c.settings.language}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>N("ru"),className:`btn-glass ${C==="ru"?"btn-glass-primary":"btn-glass-secondary"} w-full !py-2 !px-3 font-medium transition-all duration-200 ease-out`,children:e.jsxs("span",{className:"flex items-center justify-center gap-2",children:["ðŸ‡·ðŸ‡º ",c.settings.languageRu]})}),e.jsx("button",{type:"button",onClick:()=>N("en"),className:`btn-glass ${C==="en"?"btn-glass-primary":"btn-glass-secondary"} w-full !py-2 !px-3 font-medium transition-all duration-200 ease-out`,children:e.jsxs("span",{className:"flex items-center justify-center gap-2",children:["ðŸ‡¬ðŸ‡§ ",c.settings.languageEn]})})]})]}),e.jsxs("div",{className:"border-t border-white/10 pt-4 space-y-2",children:[e.jsx("label",{className:"block text-sm text-gray-300",children:c.settings.theme}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>g("dark"),className:`btn-glass ${u==="dark"?"btn-glass-primary":"btn-glass-secondary"} w-full !py-2 !px-3 font-medium transition-all duration-200 ease-out`,children:e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),c.settings.themeDark]})}),e.jsx("button",{type:"button",onClick:()=>g("light"),className:`btn-glass ${u==="light"?"btn-glass-primary":"btn-glass-secondary"} w-full !py-2 !px-3 font-medium transition-all duration-200 ease-out`,children:e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),c.settings.themeLight]})}),e.jsx("button",{type:"button",onClick:()=>g("auto"),className:`btn-glass ${u==="auto"?"btn-glass-primary":"btn-glass-secondary"} w-full !py-2 !px-3 font-medium transition-all duration-200 ease-out`,children:e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),c.settings.themeAuto]})})]})]})]}):null}function Xe({isOpen:t,pendingTemplatesDuplicates:l,isImportingTemplates:r,templatesImportAction:o,onClose:n,handleImportTemplatesOnlyNew:u,handleImportTemplatesOverwrite:g}){const{t:c}=re();return t?e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>{r||n()}}),e.jsxs("div",{className:"relative w-full max-w-md glass card-dark rounded-xl shadow-xl p-5 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:c.templatesImport.title}),e.jsxs("div",{className:"text-sm text-gray-300 space-y-1",children:[e.jsx("p",{children:c.templatesImport.duplicatesFound}),e.jsxs("ul",{className:"list-disc list-inside text-xs text-gray-400 space-y-0.5",children:[e.jsx("li",{children:c.templatesImport.importOnlyNewHint}),e.jsx("li",{children:c.templatesImport.overwriteHint})]})]}),e.jsxs("div",{className:"max-h-48 overflow-y-auto rounded-md bg-black/20 p-3 space-y-2",children:[l.map((C,N)=>{var p;return e.jsxs("div",{className:"text-sm text-gray-200 border-b border-white/5 pb-1 last:border-0",children:[e.jsx("div",{className:"font-semibold",children:((p=C.template)==null?void 0:p.name)||c.templatesImport.noName}),e.jsx("div",{className:"text-xs text-gray-400",children:c.templatesImport.existsAs.replace("{name}",C.existingName||c.templatesImport.noName)})]},C.existingId+"-"+N)}),l.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:c.templatesImport.noDuplicates})]}),r?e.jsxs("div",{className:"mt-4 flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("p",{className:"text-sm text-gray-300",children:o==="overwrite"?c.templatesImport.overwriting:c.templatesImport.importingOnlyNew})]}):e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[e.jsx("button",{type:"button",onClick:u,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:c.templatesImport.importOnlyNew}),e.jsx("button",{type:"button",onClick:g,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:c.templatesImport.overwriteAndAdd}),e.jsx("button",{type:"button",onClick:n,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:c.common.cancel})]})]})]}):null}function Qe(t){if(!t||typeof t!="string")return t;const l=t.split("-");if(l.length===3){const[r,o,n]=l;if(r&&o&&n)return`${n}.${o}.${r}`}return t}function Ze({isOpen:t,pendingWorkoutsImport:l,pendingWorkoutsFileName:r,pendingWorkoutsNewDatesSummary:o,isImportingWorkouts:n,importAction:u,onClose:g,handleConfirmImportWorkoutsOnly:c,handleImportOnlyNewWorkouts:C,handleExportThenImportWorkouts:N}){const{t:p}=re();return!t||!l?null:e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>{n||g()}}),e.jsxs("div",{className:"relative w-full max-w-md glass card-dark rounded-xl shadow-xl p-5 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:p.workoutsImport.title}),e.jsx("p",{className:"text-sm text-gray-300",children:p.workoutsImport.description.replace("{fileName}",r||"file")}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-1",children:[e.jsx("p",{children:p.workoutsImport.warning}),e.jsxs("ul",{className:"list-disc list-inside text-xs text-gray-500 space-y-0.5",children:[e.jsx("li",{children:p.workoutsImport.importOnlyNewHint}),e.jsx("li",{children:p.workoutsImport.importOverwriteHint}),e.jsx("li",{children:p.workoutsImport.exportThenImportHint})]})]}),o.length>0&&e.jsxs("div",{className:"mt-2 rounded-md bg-black/20 p-3",children:[e.jsx("p",{className:"text-xs text-gray-300",children:p.workoutsImport.newWorkoutsTitle}),e.jsx("div",{className:"mt-1 space-y-1 max-h-32 overflow-y-auto text-center",children:o.map(f=>e.jsx("div",{className:"text-xs text-gray-200",children:e.jsx("span",{children:Qe(f.date)})},f.date))})]}),n?e.jsxs("div",{className:"mt-4 flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("p",{className:"text-sm text-gray-300",children:u==="exportThenImport"?p.workoutsImport.exportingAndImporting:u==="onlyNew"?p.workoutsImport.importingOnlyNew:p.workoutsImport.importingWorkouts})]}):e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[o.length>0&&e.jsx("button",{type:"button",onClick:C,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:p.workoutsImport.importOnlyNew}),e.jsx("button",{type:"button",onClick:c,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:p.workoutsImport.importOverwrite}),e.jsx("button",{type:"button",onClick:N,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary",children:p.workoutsImport.exportThenImport}),e.jsx("button",{type:"button",onClick:g,className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary bg-white/10 hover:bg-white/5",children:p.common.cancel})]})]})]})}const it=()=>{const{user:t,signOut:l}=je(),r=ve(),{t:o}=re(),[n,u]=s.useState(!1),[g,c]=s.useState(!1),[C,N]=s.useState(""),[p,f]=s.useState(null),[T,B]=s.useState(!1),d=Fe({userId:t==null?void 0:t.id,userEmail:t==null?void 0:t.email}),L=Re({userId:t==null?void 0:t.id,userEmail:t==null?void 0:t.email,setToastVariant:d.setToastVariant,setImportSuccessMessage:d.setImportSuccessMessage,setIsImportSuccessOpen:d.setIsImportSuccessOpen}),y=Be({userId:t==null?void 0:t.id,setToastVariant:d.setToastVariant,setImportSuccessMessage:d.setImportSuccessMessage,setIsImportSuccessOpen:d.setIsImportSuccessOpen}),E=Me({userId:t==null?void 0:t.id}),O=We();s.useEffect(()=>{E.isWeightTrackerOpen&&t&&E.loadBodyWeights()},[E.isWeightTrackerOpen,t]);const J=s.useMemo(()=>{var H;if(!t)return"";const S=(H=t.user_metadata)==null?void 0:H.nickname;if(typeof S=="string"&&S.trim().length>0)return S.trim();const x=t.email||"";return x.endsWith("@gymlog.app")?x.replace(/@gymlog\.app$/,""):x},[t]),_=s.useMemo(()=>{const S=(t==null?void 0:t.email)||"";if(!S||typeof S!="string")return null;const[x,H]=S.split("@");if(!x||!H)return null;const R=Math.max(1,Math.ceil(x.length/2)),Y=x.slice(0,R),G=x.slice(R);return{email:S,localPart:x,domain:H,visiblePart:Y,hiddenPart:G}},[t==null?void 0:t.email]),K=async()=>{try{await l(),r("/login",{replace:!0})}catch(S){console.error("Error logging out:",S)}},P=()=>{!t||!t.email||(N(""),f(null),c(!0))},Q=()=>{t&&y.setIsCleanDataDialogOpen(!0)},$=async()=>{if(!(!t||!t.email)){if(C.trim()!==t.email)throw f(o.profile.emailMismatch),new Error("EMAIL_MISMATCH");f(null),u(!0);try{await Oe(),alert(o.profile.accountDeleted),await l(),r("/login",{replace:!0})}catch(S){console.error("Error deleting account:",S),alert(`${o.profile.deleteAccountError}${S.message}`)}finally{u(!1)}}};return e.jsxs("div",{className:"p-4 space-y-4 max-w-lg mx-auto pt-safe relative profile-page",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:o.profile.title}),e.jsx(Je,{isImportingWorkouts:d.isImportingWorkouts,isImportingTemplates:L.isImportingTemplates,handleStartImportWorkouts:d.handleStartImportWorkouts,handleStartImportTemplates:L.handleStartImportTemplates,isExporting:d.isExporting,isExportingTemplates:L.isExportingTemplates,handleExportWorkouts:d.handleExportWorkouts,handleExportTemplates:L.handleExportTemplates,isDeleting:n,startCleanDataFlow:Q,startDeleteAccountFlow:P})]}),e.jsx("div",{className:"p-4 glass card-dark rounded-lg shadow",children:t&&e.jsxs("p",{className:"flex flex-wrap items-center gap-1",children:[e.jsx("span",{children:o.profile.loggedInAs}),_?e.jsxs("span",{className:"font-semibold",children:[_.visiblePart,_.hiddenPart&&e.jsx("button",{type:"button",onClick:()=>B(!0),className:"inline px-0 py-0 border-b border-dashed border-white/40 hover:border-white/80 transition-colors cursor-pointer select-none bg-transparent rounded-none align-baseline",children:T?e.jsx("span",{children:_.hiddenPart}):e.jsx("span",{children:"â€¢".repeat(Math.max(3,_.hiddenPart.length))})}),"@",_.domain]}):e.jsx("span",{className:"font-semibold",children:J})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>r("/progress"),className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),o.profile.viewProgress]}),e.jsxs("button",{onClick:()=>E.setIsWeightTrackerOpen(!0),className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"})}),o.profile.bodyWeightTracker]}),e.jsxs("button",{onClick:()=>O.setIsSettingsOpen(!O.isSettingsOpen),className:"btn-glass btn-glass-full btn-glass-md btn-glass-secondary flex items-center justify-center gap-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),o.profile.settings,e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 transition-transform ${O.isSettingsOpen?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),e.jsx("button",{onClick:K,className:"btn-glass btn-glass-logout btn-glass-full btn-glass-md",children:o.profile.logout})]}),e.jsx(Ke,{isOpen:O.isSettingsOpen,timerStepInput:O.timerStepInput,setTimerStepInput:O.setTimerStepInput,saveStatus:O.saveStatus,saveTimerStep:O.saveTimerStep,theme:O.theme,handleThemeChange:O.handleThemeChange}),e.jsx("input",{ref:d.workoutsFileInputRef,type:"file",accept:"application/json",className:"hidden",onChange:d.handleWorkoutsFileChange}),e.jsx("input",{ref:L.templatesFileInputRef,type:"file",accept:"application/json",className:"hidden",onChange:L.handleTemplatesFileChange}),e.jsx(ge,{open:g,onOpenChange:S=>{c(S),S||(N(""),f(null))},title:o.profile.deleteAccountConfirm,description:o.profile.deleteAccountDesc,confirmText:o.profile.deleteAccountBtn,cancelText:o.common.cancel,variant:"danger",confirmDisabled:C.trim().length===0,onConfirm:$,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm text-gray-300",children:[o.profile.emailConfirmation,e.jsx("span",{className:"font-semibold",children:t==null?void 0:t.email})]}),e.jsx("input",{type:"email",value:C,onChange:S=>{N(S.target.value),p&&f(null)},placeholder:(t==null?void 0:t.email)||o.profile.emailPlaceholder,className:"mt-1 block w-full px-3 py-2 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500",style:{background:"#18181b",color:"#fafafa",border:"1px solid #3f3f46"}}),p&&e.jsx("p",{className:"text-xs text-red-400",children:p})]})}),e.jsx(Ye,{isOpen:y.isCleanDataDialogOpen,onClose:()=>y.setIsCleanDataDialogOpen(!1),isLoadingWorkoutsForDeletion:y.isLoadingWorkoutsForDeletion,isLoadingTemplatesForDeletion:y.isLoadingTemplatesForDeletion,openDeleteWorkoutsDialog:y.openDeleteWorkoutsDialog,openDeleteTemplatesDialog:y.openDeleteTemplatesDialog}),e.jsx(qe,{isOpen:y.isDeleteWorkoutsDialogOpen,onClose:y.closeDeleteWorkoutsDialog,workoutDateGroups:y.workoutDateGroups,selectedWorkoutDates:y.selectedWorkoutDates,isDeletingWorkouts:y.isDeletingWorkouts,areAllWorkoutDatesSelected:y.areAllWorkoutDatesSelected,toggleWorkoutDateSelection:y.toggleWorkoutDateSelection,selectAllWorkoutDates:y.selectAllWorkoutDates,clearWorkoutSelection:y.clearWorkoutSelection,handleDeleteSelectedWorkouts:y.handleDeleteSelectedWorkouts}),e.jsx(Ge,{isOpen:y.isDeleteTemplatesDialogOpen,onClose:y.closeDeleteTemplatesDialog,templatesForDeletion:y.templatesForDeletion,selectedTemplateIds:y.selectedTemplateIds,isDeletingTemplates:y.isDeletingTemplates,areAllTemplatesSelected:y.areAllTemplatesSelected,toggleTemplateSelection:y.toggleTemplateSelection,selectAllTemplates:y.selectAllTemplates,clearTemplateSelection:y.clearTemplateSelection,handleDeleteSelectedTemplates:y.handleDeleteSelectedTemplates}),e.jsx(De,{open:d.isImportSuccessOpen,onOpenChange:S=>{S||d.closeImportSuccessToast()},onClose:d.closeImportSuccessToast,message:d.importSuccessMessage||"Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚ Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²Ð¾Ðº Ð·Ð°Ð²ÐµÑ€ÑˆÑ‘Ð½. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ ÐºÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÑŒ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÐ¸.",variant:d.toastVariant}),e.jsx(Xe,{isOpen:L.isTemplatesImportDialogOpen,pendingTemplatesDuplicates:L.pendingTemplatesDuplicates,isImportingTemplates:L.isImportingTemplates,templatesImportAction:L.templatesImportAction,onClose:L.closeTemplatesImportDialog,handleImportTemplatesOnlyNew:L.handleImportTemplatesOnlyNew,handleImportTemplatesOverwrite:L.handleImportTemplatesOverwrite}),e.jsx(Ze,{isOpen:d.isWorkoutsImportDialogOpen,pendingWorkoutsImport:d.pendingWorkoutsImport,pendingWorkoutsFileName:d.pendingWorkoutsFileName,pendingWorkoutsNewDatesSummary:d.pendingWorkoutsNewDatesSummary,isImportingWorkouts:d.isImportingWorkouts,importAction:d.importAction,onClose:d.closeWorkoutsImportDialog,handleConfirmImportWorkoutsOnly:d.handleConfirmImportWorkoutsOnly,handleImportOnlyNewWorkouts:d.handleImportOnlyNewWorkouts,handleExportThenImportWorkouts:d.handleExportThenImportWorkouts}),e.jsx(Ue,{isOpen:E.isWeightTrackerOpen,onClose:()=>E.setIsWeightTrackerOpen(!1),bodyWeights:E.bodyWeights,loadingWeights:E.loadingWeights,weightChartData:E.weightChartData,weightStats:E.weightStats,newWeight:E.newWeight,newWeightDate:E.newWeightDate,savingWeight:E.savingWeight,deletingWeightId:E.deletingWeightId,isDeleteWeightConfirmOpen:E.isDeleteWeightConfirmOpen,weightToDelete:E.weightToDelete,setNewWeight:E.setNewWeight,setNewWeightDate:E.setNewWeightDate,setIsDeleteWeightConfirmOpen:E.setIsDeleteWeightConfirmOpen,handleAddWeight:E.handleAddWeight,handleDeleteWeight:E.handleDeleteWeight,handleOpenDeleteWeightConfirm:E.handleOpenDeleteWeightConfirm})]})};export{it as default};
